<!DOCTYPE html>
<!-- saved from url=(0081)https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html -->
<html class="js flexbox flexboxlegacy no-touch websqldatabase indexeddb history csscolumns csstransforms localstorage sessionstorage applicationcache svg inlinesvg zoom gr__learning_oreilly_com" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#" itemscope="" itemtype="http://schema.org/Book http://schema.org/ItemPage" data-login-url="/accounts/login/" data-offline-url="/" data-url="/library/view/python-for-data/9781491957653/ch06.html" data-csrf-cookie="csrfsafari" data-highlight-privacy="" data-user-id="4081162" data-user-uuid="6dde68c3-375a-4008-9d0b-4795390365f4" data-username="viewv" data-account-type="B2B" data-activated-trial-date="12/20/2016" data-archive="9781491957653" data-publishers="O&#39;Reilly Media, Inc." data-htmlfile-name="ch06.html" data-epub-title="Python for Data Analysis, 2nd Edition" data-debug="0" data-testing="0" style="" data-blockbyte-bs-uid="103144"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="author" content="Safari Books Online"><meta name="format-detection" content="telephone=no"><meta http-equiv="cleartype" content="on"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="apple-itunes-app" content="app-id=881697395, app-argument=safaridetail://9781491957653"><meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, maximum-scale=1.0"><meta property="twitter:account_id" content="4503599627559754"><script src="./ep_files/nr-1118.min.js"></script><script async="" src="./ep_files/gtm.js"></script><script async="" src="./ep_files/analytics.js"></script><script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o||n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({1:[function(e,n,t){function r(){}function o(e,n,t){return function(){return i(e,[c.now()].concat(u(arguments)),n?null:this,t),n?void 0:this}}var i=e("handle"),a=e(3),u=e(4),f=e("ee").get("tracer"),c=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(e,n){s[n]=o(d+n,!0,"api")}),s.addPageAction=o(d+"addPageAction",!0),s.setCurrentRouteName=o(d+"routeName",!0),n.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,n){var t={},r=this,o="function"==typeof n;return i(l+"tracer",[c.now(),e,t],r),function(){if(f.emit((o?"":"no-")+"fn-start",[c.now(),r,o],t),o)try{return n.apply(this,arguments)}catch(e){throw f.emit("fn-err",[arguments,this,e],t),e}finally{f.emit("fn-end",[c.now()],t)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,n){m[n]=o(l+n)}),newrelic.noticeError=function(e,n){"string"==typeof e&&(e=new Error(e)),i("err",[e,c.now(),!1,n])}},{}],2:[function(e,n,t){function r(e,n){if(!o)return!1;if(e!==o)return!1;if(!n)return!0;if(!i)return!1;for(var t=i.split("."),r=n.split("."),a=0;a<r.length;a++)if(r[a]!==t[a])return!1;return!0}var o=null,i=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var u=navigator.userAgent,f=u.match(a);f&&u.indexOf("Chrome")===-1&&u.indexOf("Chromium")===-1&&(o="Safari",i=f[1])}n.exports={agent:o,version:i,match:r}},{}],3:[function(e,n,t){function r(e,n){var t=[],r="",i=0;for(r in e)o.call(e,r)&&(t[i]=n(r,e[r]),i+=1);return t}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],4:[function(e,n,t){function r(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(o<0?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=r},{}],5:[function(e,n,t){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,n,t){function r(){}function o(e){function n(e){return e&&e instanceof r?e:e?f(e,u,i):i()}function t(t,r,o,i){if(!d.aborted||i){e&&e(t,r,o);for(var a=n(o),u=v(t),f=u.length,c=0;c<f;c++)u[c].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function l(e,n){h[e]=v(e).concat(n)}function m(e,n){var t=h[e];if(t)for(var r=0;r<t.length;r++)t[r]===n&&t.splice(r,1)}function v(e){return h[e]||[]}function g(e){return p[e]=p[e]||o(t)}function w(e,n){c(e,function(e,t){n=n||"feature",y[t]=n,n in s||(s[n]=[])})}var h={},y={},b={on:l,addEventListener:l,removeEventListener:m,emit:t,get:g,listeners:v,context:n,buffer:w,abort:a,aborted:!1};return b}function i(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var u="nr@context",f=e("gos"),c=e(3),s={},p={},d=n.exports=o();d.backlog=s},{}],gos:[function(e,n,t){function r(e,n,t){if(o.call(e,n))return e[n];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(e,n,t){function r(e,n,t,r){o.buffer([e],r),o.emit(e,n,t)}var o=e("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(e,n,t){function r(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");n.exports=r},{}],loader:[function(e,n,t){function r(){if(!E++){var e=x.info=NREUM.info,n=l.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&n))return s.abort();c(y,function(n,t){e[n]||(e[n]=t)}),f("mark",["onload",a()+x.offset],null,"api");var t=l.createElement("script");t.src="https://"+e.agent,n.parentNode.insertBefore(t,n)}}function o(){"complete"===l.readyState&&i()}function i(){f("mark",["domContent",a()+x.offset],null,"api")}function a(){return O.exists&&performance.now?Math.round(performance.now()):(u=Math.max((new Date).getTime(),u))-x.offset}var u=(new Date).getTime(),f=e("handle"),c=e(3),s=e("ee"),p=e(2),d=window,l=d.document,m="addEventListener",v="attachEvent",g=d.XMLHttpRequest,w=g&&g.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:g,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var h=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1118.min.js"},b=g&&w&&w[m]&&!/CriOS/.test(navigator.userAgent),x=n.exports={offset:u,now:a,origin:h,features:{},xhrWrappable:b,userAgent:p};e(1),l[m]?(l[m]("DOMContentLoaded",i,!1),d[m]("load",r,!1)):(l[v]("onreadystatechange",o),d[v]("onload",r)),f("mark",["firstbyte",u],null,"api");var E=0,O=e(5)},{}]},{},["loader"]);</script><link rel="apple-touch-icon" href="https://learning.oreilly.com/static/images/apple-touch-icon.0c29511d2d72.png"><link rel="shortcut icon" href="https://learning.oreilly.com/favicon.ico" type="image/x-icon"><link href="./ep_files/css" rel="stylesheet" type="text/css"><title>Data Loading, Storage, and File
  Formats - Python for Data Analysis, 2nd Edition</title><link rel="stylesheet" href="./ep_files/1f82858304ba.css" type="text/css"><link rel="stylesheet" type="text/css" href="./ep_files/annotator.e3b0c44298fc.css"><link rel="stylesheet" href="./ep_files/font-awesome.min.css"><style type="text/css" title="ibis-book">
    @charset "utf-8";#sbo-rt-content html,#sbo-rt-content div,#sbo-rt-content div,#sbo-rt-content span,#sbo-rt-content applet,#sbo-rt-content object,#sbo-rt-content iframe,#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6,#sbo-rt-content p,#sbo-rt-content blockquote,#sbo-rt-content pre,#sbo-rt-content a,#sbo-rt-content abbr,#sbo-rt-content acronym,#sbo-rt-content address,#sbo-rt-content big,#sbo-rt-content cite,#sbo-rt-content code,#sbo-rt-content del,#sbo-rt-content dfn,#sbo-rt-content em,#sbo-rt-content img,#sbo-rt-content ins,#sbo-rt-content kbd,#sbo-rt-content q,#sbo-rt-content s,#sbo-rt-content samp,#sbo-rt-content small,#sbo-rt-content strike,#sbo-rt-content strong,#sbo-rt-content sub,#sbo-rt-content sup,#sbo-rt-content tt,#sbo-rt-content var,#sbo-rt-content b,#sbo-rt-content u,#sbo-rt-content i,#sbo-rt-content center,#sbo-rt-content dl,#sbo-rt-content dt,#sbo-rt-content dd,#sbo-rt-content ol,#sbo-rt-content ul,#sbo-rt-content li,#sbo-rt-content fieldset,#sbo-rt-content form,#sbo-rt-content label,#sbo-rt-content legend,#sbo-rt-content table,#sbo-rt-content caption,#sbo-rt-content tdiv,#sbo-rt-content tfoot,#sbo-rt-content thead,#sbo-rt-content tr,#sbo-rt-content th,#sbo-rt-content td,#sbo-rt-content article,#sbo-rt-content aside,#sbo-rt-content canvas,#sbo-rt-content details,#sbo-rt-content embed,#sbo-rt-content figure,#sbo-rt-content figcaption,#sbo-rt-content footer,#sbo-rt-content header,#sbo-rt-content hgroup,#sbo-rt-content menu,#sbo-rt-content nav,#sbo-rt-content output,#sbo-rt-content ruby,#sbo-rt-content section,#sbo-rt-content summary,#sbo-rt-content time,#sbo-rt-content mark,#sbo-rt-content audio,#sbo-rt-content video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}#sbo-rt-content article,#sbo-rt-content aside,#sbo-rt-content details,#sbo-rt-content figcaption,#sbo-rt-content figure,#sbo-rt-content footer,#sbo-rt-content header,#sbo-rt-content hgroup,#sbo-rt-content menu,#sbo-rt-content nav,#sbo-rt-content section{display:block}#sbo-rt-content div{line-height:1}#sbo-rt-content ol,#sbo-rt-content ul{list-style:none}#sbo-rt-content blockquote,#sbo-rt-content q{quotes:none}#sbo-rt-content blockquote:before,#sbo-rt-content blockquote:after,#sbo-rt-content q:before,#sbo-rt-content q:after{content:none}#sbo-rt-content table{border-collapse:collapse;border-spacing:0}@page{margin:5px !important}#sbo-rt-content p{margin:10px 0 0;line-height:125%;text-align:left}#sbo-rt-content p.byline{text-align:left;margin:-33px auto 35px;font-style:italic;font-weight:bold}#sbo-rt-content div.preface p+p.byline{margin:1em 0 0}#sbo-rt-content div.preface p.byline+p.byline{margin:0}#sbo-rt-content div.sect1>p.byline{margin:-.25em 0 1em}#sbo-rt-content div.sect1>p.byline+p.byline{margin-top:-1em}#sbo-rt-content em{font-style:italic;font-family:inherit}#sbo-rt-content em strong,#sbo-rt-content strong em{font-weight:bold;font-style:italic;font-family:inherit}#sbo-rt-content strong,#sbo-rt-content span.bold{font-weight:bold}#sbo-rt-content em.replaceable{font-style:italic}#sbo-rt-content strong.userinput{font-weight:bold;font-style:normal}#sbo-rt-content span.bolditalic{font-weight:bold;font-style:italic}#sbo-rt-content a.ulink,#sbo-rt-content a.xref,#sbo-rt-content a.email,#sbo-rt-content a.link,#sbo-rt-content a{text-decoration:none;color:#8e0012}#sbo-rt-content span.lineannotation{font-style:italic;color:#a62a2a;font-family:serif}#sbo-rt-content span.underline{text-decoration:underline}#sbo-rt-content span.strikethrough{text-decoration:line-through}#sbo-rt-content span.smallcaps{font-variant:small-caps}#sbo-rt-content span.cursor{background:#000;color:#fff}#sbo-rt-content span.smaller{font-size:75%}#sbo-rt-content .boxedtext,#sbo-rt-content .keycap{border-style:solid;border-width:1px;border-color:#000;padding:1px}#sbo-rt-content span.gray50{color:#7F7F7F;}#sbo-rt-content h1,#sbo-rt-content div.toc-title,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5{-webkit-hyphens:none;hyphens:none;adobe-hyphenate:none;font-weight:bold;text-align:left;page-break-after:avoid !important;font-family:sans-serif,"DejaVuSans"}#sbo-rt-content div.toc-title{font-size:1.5em;margin-top:20px !important;margin-bottom:30px !important}#sbo-rt-content section[data-type="sect1"] h1{font-size:1.3em;color:#8e0012;margin:40px 0 8px 0}#sbo-rt-content section[data-type="sect2"] h2{font-size:1.1em;margin:30px 0 8px 0 !important}#sbo-rt-content section[data-type="sect3"] h3{font-size:1em;color:#555;margin:20px 0 8px 0 !important}#sbo-rt-content section[data-type="sect4"] h4{font-size:1em;font-weight:normal;font-style:italic;margin:15px 0 6px 0 !important}#sbo-rt-content section[data-type="chapter"]>div>h1,#sbo-rt-content section[data-type="preface"]>div>h1,#sbo-rt-content section[data-type="appendix"]>div>h1,#sbo-rt-content section[data-type="glossary"]>div>h1,#sbo-rt-content section[data-type="bibliography"]>div>h1,#sbo-rt-content section[data-type="index"]>div>h1{font-size:2em;line-height:1;margin-bottom:50px;color:#000;padding-bottom:10px;border-bottom:1px solid #000}#sbo-rt-content span.label,#sbo-rt-content span.keep-together{font-size:inherit;font-weight:inherit}#sbo-rt-content div[data-type="part"] h1{font-size:2em;text-align:center;margin-top:0 !important;margin-bottom:50px;padding:50px 0 10px 0;border-bottom:1px solid #000}#sbo-rt-content img.width-ninety{width:90%}#sbo-rt-content img{max-width:95%;margin:0 auto;padding:0}#sbo-rt-content div.figure{background-color:transparent;text-align:center !important;margin:15px 0 15px 0 !important;page-break-inside:avoid}#sbo-rt-content figure{margin:15px 0 15px 0 !important;page-break-inside:avoid}#sbo-rt-content div.figure h6{font-size:90%;text-align:center;font-weight:normal;font-style:italic;font-family:serif !important;color:#000;padding-top:10px !important;page-break-before:avoid;page-break-after:avoid}#sbo-rt-content div.informalfigure{text-align:center !important;padding:5px 0 !important}#sbo-rt-content div.sidebar{margin:15px 0 10px 0 !important;border:1px solid #DCDCDC;background-color:#F7F7F7;padding:15px !important;page-break-inside:avoid}#sbo-rt-content aside[data-type="sidebar"]{margin:15px 0 10px 0 !important;page-break-inside:avoid}#sbo-rt-content div.sidebar-title,#sbo-rt-content aside[data-type="sidebar"] h5{font-weight:bold;font-size:1em;font-family:sans-serif;text-transform:uppercase;letter-spacing:1px;text-align:center;margin:4px 0 6px 0 !important;page-break-inside:avoid}#sbo-rt-content div.sidebar ol,#sbo-rt-content div.sidebar ul,#sbo-rt-content aside[data-type="sidebar"] ol,#sbo-rt-content aside[data-type="sidebar"] ul{margin-left:1.25em !important}#sbo-rt-content div.sidebar div.figure p.title,#sbo-rt-content aside[data-type="sidebar"] figcaption,#sbo-rt-content div.sidebar div.informalfigure div.caption{font-size:90%;text-align:center;font-weight:normal;font-style:italic;font-family:serif !important;color:#000;padding:5px !important;page-break-before:avoid;page-break-after:avoid}#sbo-rt-content div.sidebar div.tip,#sbo-rt-content div.sidebar div[data-type="tip"],#sbo-rt-content div.sidebar div.note,#sbo-rt-content div.sidebar div[data-type="note"],#sbo-rt-content div.sidebar div.warning,#sbo-rt-content div.sidebar div[data-type="warning"],#sbo-rt-content div.sidebar div[data-type="caution"],#sbo-rt-content div.sidebar div[data-type="important"]{margin:20px auto 20px auto !important;font-size:90%;width:85%}#sbo-rt-content aside[data-type="sidebar"] p.byline{font-size:90%;font-weight:bold;font-style:italic;text-align:center;text-indent:0;margin:5px auto 6px;page-break-after:avoid}#sbo-rt-content pre{white-space:pre-wrap;font-family:"Ubuntu Mono",monospace;margin:25px 0 25px 20px;font-size:85%;display:block;-webkit-hyphens:none;hyphens:none;adobe-hyphenate:none;overflow-wrap:break-word}#sbo-rt-content div.note pre.programlisting,#sbo-rt-content div.tip pre.programlisting,#sbo-rt-content div.warning pre.programlisting,#sbo-rt-content div.caution pre.programlisting,#sbo-rt-content div.important pre.programlisting{margin-bottom:0}#sbo-rt-content code{font-family:"Ubuntu Mono",monospace;-webkit-hyphens:none;hyphens:none;adobe-hyphenate:none;overflow-wrap:break-word}#sbo-rt-content code strong em,#sbo-rt-content code em strong,#sbo-rt-content pre em strong,#sbo-rt-content pre strong em,#sbo-rt-content strong code em code,#sbo-rt-content em code strong code,#sbo-rt-content span.bolditalic code{font-weight:bold;font-style:italic;font-family:"Ubuntu Mono BoldItal",monospace}#sbo-rt-content code em,#sbo-rt-content em code,#sbo-rt-content pre em,#sbo-rt-content em.replaceable{font-family:"Ubuntu Mono Ital",monospace;font-style:italic}#sbo-rt-content code strong,#sbo-rt-content strong code,#sbo-rt-content pre strong,#sbo-rt-content strong.userinput{font-family:"Ubuntu Mono Bold",monospace;font-weight:bold}#sbo-rt-content div[data-type="example"]{margin:10px 0 15px 0 !important}#sbo-rt-content div[data-type="example"] h1,#sbo-rt-content div[data-type="example"] h2,#sbo-rt-content div[data-type="example"] h3,#sbo-rt-content div[data-type="example"] h4,#sbo-rt-content div[data-type="example"] h5,#sbo-rt-content div[data-type="example"] h6{font-style:italic;font-weight:normal;text-align:left !important;text-transform:none !important;font-family:serif !important;margin:10px 0 5px 0 !important;border-bottom:1px solid #000}#sbo-rt-content li pre.example{padding:10px 0 !important}#sbo-rt-content div[data-type="example"] pre[data-type="programlisting"],#sbo-rt-content div[data-type="example"] pre[data-type="screen"]{margin:0}#sbo-rt-content section[data-type="titlepage"]>div>h1{font-size:2em;margin:50px 0 10px 0 !important;line-height:1;text-align:center}#sbo-rt-content section[data-type="titlepage"] h2,#sbo-rt-content section[data-type="titlepage"] p.subtitle,#sbo-rt-content section[data-type="titlepage"] p[data-type="subtitle"]{font-size:1.3em;font-weight:normal;text-align:center;margin-top:.5em;color:#555}#sbo-rt-content section[data-type="titlepage"]>div>h2[data-type="author"],#sbo-rt-content section[data-type="titlepage"] p.author{font-size:1.3em;font-family:serif !important;font-weight:bold;margin:50px 0 !important;text-align:center}#sbo-rt-content section[data-type="titlepage"] p.edition{text-align:center;text-transform:uppercase;margin-top:2em}#sbo-rt-content section[data-type="titlepage"]{text-align:center}#sbo-rt-content section[data-type="titlepage"]:after{content:url(css_assets/titlepage_footer_ebook.png);margin:0 auto;max-width:80%}#sbo-rt-content div.book div.titlepage div.publishername{margin-top:60%;margin-bottom:20px;text-align:center;font-size:1.25em}#sbo-rt-content div.book div.titlepage div.locations p{margin:0;text-align:center}#sbo-rt-content div.book div.titlepage div.locations p.cities{font-size:80%;text-align:center;margin-top:5px}#sbo-rt-content section.preface[title="Dedication"]>div.titlepage h2.title{text-align:center;text-transform:uppercase;font-size:1.5em;margin-top:50px;margin-bottom:50px}#sbo-rt-content ul.stafflist{margin:15px 0 15px 20px !important}#sbo-rt-content ul.stafflist li{list-style-type:none;padding:5px 0}#sbo-rt-content ul.printings li{list-style-type:none}#sbo-rt-content section.preface[title="Dedication"] p{font-style:italic;text-align:center}#sbo-rt-content div.colophon h1.title{font-size:1.3em;margin:0 !important;font-family:serif !important;font-weight:normal}#sbo-rt-content div.colophon h2.subtitle{margin:0 !important;color:#000;font-family:serif !important;font-size:1em;font-weight:normal}#sbo-rt-content div.colophon div.author h3.author{font-size:1.1em;font-family:serif !important;margin:10px 0 0 !important;font-weight:normal}#sbo-rt-content div.colophon div.editor h4,#sbo-rt-content div.colophon div.editor h3.editor{color:#000;font-size:.8em;margin:15px 0 0 !important;font-family:serif !important;font-weight:normal}#sbo-rt-content div.colophon div.editor h3.editor{font-size:.8em;margin:0 !important;font-family:serif !important;font-weight:normal}#sbo-rt-content div.colophon div.publisher{margin-top:10px}#sbo-rt-content div.colophon div.publisher p,#sbo-rt-content div.colophon div.publisher span.publishername{margin:0;font-size:.8em}#sbo-rt-content div.legalnotice p,#sbo-rt-content div.timestamp p{font-size:.8em}#sbo-rt-content div.timestamp p{margin-top:10px}#sbo-rt-content div.colophon[title="About the Author"] h1.title,#sbo-rt-content div.colophon[title="Colophon"] h1.title{font-size:1.5em;margin:0 !important;font-family:sans-serif !important}#sbo-rt-content section.chapter div.titlepage div.author{margin:10px 0 10px 0}#sbo-rt-content section.chapter div.titlepage div.author div.affiliation{font-style:italic}#sbo-rt-content div.attribution{margin:5px 0 0 50px !important}#sbo-rt-content h3.author span.orgname{display:none}#sbo-rt-content div.epigraph{margin:10px 0 10px 20px !important;page-break-inside:avoid;font-size:90%}#sbo-rt-content div.epigraph p{font-style:italic}#sbo-rt-content blockquote,#sbo-rt-content div.blockquote{margin:10px !important;page-break-inside:avoid;font-size:95%}#sbo-rt-content blockquote p,#sbo-rt-content div.blockquote p{font-style:italic;margin:.75em 0 0 !important}#sbo-rt-content blockquote div.attribution,#sbo-rt-content blockquote p[data-type="attribution"]{margin:5px 0 10px 30px !important;text-align:right;width:80%}#sbo-rt-content blockquote div.attribution p,#sbo-rt-content blockquote p[data-type="attribution"]{font-style:normal;margin-top:5px}#sbo-rt-content blockquote div.attribution p:before,#sbo-rt-content blockquote p[data-type="attribution"]:before{font-style:normal;content:"—";-webkit-hyphens:none;hyphens:none;adobe-hyphenate:none}#sbo-rt-content p.right{text-align:right;margin:0}#sbo-rt-content div[data-type="footnotes"]{border-top:1px solid black;margin-top:1.5em}#sbo-rt-content sub,#sbo-rt-content sup{font-size:75%;line-height:0;position:relative}#sbo-rt-content sup{top:-.5em}#sbo-rt-content sub{bottom:-.25em}#sbo-rt-content div.refentry p.refname{font-size:1em;font-family:sans-serif,"DejaVuSans";font-weight:bold;margin-bottom:5px;overflow:auto;width:100%}#sbo-rt-content div.refentry{width:100%;display:block;margin-top:2em}#sbo-rt-content div.refsynopsisdiv{display:block;clear:both}#sbo-rt-content div.refentry header{page-break-inside:avoid !important;display:block;break-inside:avoid !important;padding-top:0;border-bottom:1px solid #000}#sbo-rt-content div.refsect1 h6{font-size:.9em;font-family:sans-serif,"DejaVuSans";font-weight:bold}#sbo-rt-content div.refsect1{margin-top:3em}#sbo-rt-content dt{padding-top:10px !important;padding-bottom:0 !important}#sbo-rt-content dd{margin-left:1.5em !important;margin-bottom:.25em}#sbo-rt-content dd,#sbo-rt-content li{text-align:left}#sbo-rt-content ul{list-style-type:disc}#sbo-rt-content ul ul{list-style-type:square}#sbo-rt-content ul ul ul{list-style-type:circle}#sbo-rt-content ol{list-style-type:decimal}#sbo-rt-content ol ol{list-style-type:lower-alpha}#sbo-rt-content ol ol ol{list-style-type:lower-roman}#sbo-rt-content ol ul{list-style-type:disc}#sbo-rt-content ol ul ol{list-style-type:decimal}#sbo-rt-content ul ol{list-style-type:decimal}#sbo-rt-content ul ol ul{list-style-type:disc}#sbo-rt-content ol,#sbo-rt-content ul{list-style-position:outside;margin:15px 0 15px 1.25em}#sbo-rt-content ol li,#sbo-rt-content ul li{margin:.5em 0 .65em;line-height:125%}#sbo-rt-content div.orderedlistalpha{list-style-type:upper-alpha}#sbo-rt-content table.simplelist,#sbo-rt-content ul.simplelist{margin:15px 0 15px 20px !important}#sbo-rt-content ul.simplelist li{list-style-type:none;padding:5px 0}#sbo-rt-content table.simplelist td{border:none}#sbo-rt-content table.simplelist tr{border-bottom:none}#sbo-rt-content table.simplelist tr:nth-of-type(even){background-color:transparent}#sbo-rt-content dl.calloutlist p:first-child{margin-top:-25px !important}#sbo-rt-content dl.calloutlist dd{padding-left:0;margin-top:-25px}#sbo-rt-content dl.calloutlist img,#sbo-rt-content a.co img{padding:0}#sbo-rt-content div.toc ol{margin-top:8px !important;margin-bottom:8px !important;margin-left:0 !important;padding-left:0 !important}#sbo-rt-content div.toc ol ol{margin-left:30px !important;padding-left:0 !important}#sbo-rt-content div.toc ol li{list-style-type:none}#sbo-rt-content div.toc a{color:#8e0012}#sbo-rt-content div.toc ol a{font-size:1em;font-weight:bold}#sbo-rt-content div.toc ol>li>ol a{font-weight:bold;font-size:1em}#sbo-rt-content div.toc ol>li>ol>li>ol a{text-decoration:none;font-weight:normal;font-size:1em}#sbo-rt-content div.tip,#sbo-rt-content div[data-type="tip"],#sbo-rt-content div.note,#sbo-rt-content div[data-type="note"],#sbo-rt-content div.warning,#sbo-rt-content div[data-type="warning"],#sbo-rt-content div[data-type="caution"],#sbo-rt-content div[data-type="important"]{margin:30px !important;font-size:90%;padding:10px 8px 20px 8px !important;page-break-inside:avoid}#sbo-rt-content div.tip ol,#sbo-rt-content div.tip ul,#sbo-rt-content div[data-type="tip"] ol,#sbo-rt-content div[data-type="tip"] ul,#sbo-rt-content div.note ol,#sbo-rt-content div.note ul,#sbo-rt-content div[data-type="note"] ol,#sbo-rt-content div[data-type="note"] ul,#sbo-rt-content div.warning ol,#sbo-rt-content div.warning ul,#sbo-rt-content div[data-type="warning"] ol,#sbo-rt-content div[data-type="warning"] ul,#sbo-rt-content div[data-type="caution"] ol,#sbo-rt-content div[data-type="caution"] ul,#sbo-rt-content div[data-type="important"] ol,#sbo-rt-content div[data-type="important"] ul{margin-left:1.5em !important}#sbo-rt-content div.tip,#sbo-rt-content div[data-type="tip"],#sbo-rt-content div.note,#sbo-rt-content div[data-type="note"]{border:1px solid #BEBEBE;background-color:transparent}#sbo-rt-content div.warning,#sbo-rt-content div[data-type="warning"],#sbo-rt-content div[data-type="caution"],#sbo-rt-content div[data-type="important"]{border:1px solid #BC8F8F}#sbo-rt-content div.tip h3,#sbo-rt-content div[data-type="tip"] h6,#sbo-rt-content div[data-type="tip"] h1,#sbo-rt-content div.note h3,#sbo-rt-content div[data-type="note"] h6,#sbo-rt-content div[data-type="note"] h1,#sbo-rt-content div.warning h3,#sbo-rt-content div[data-type="warning"] h6,#sbo-rt-content div[data-type="warning"] h1,#sbo-rt-content div[data-type="caution"] h6,#sbo-rt-content div[data-type="caution"] h1,#sbo-rt-content div[data-type="important"] h1,#sbo-rt-content div[data-type="important"] h6{font-weight:bold;font-size:110%;font-family:sans-serif !important;text-transform:uppercase;letter-spacing:1px;text-align:center;margin:4px 0 6px !important}#sbo-rt-content div.tip h3,#sbo-rt-content div[data-type="tip"] h6,#sbo-rt-content div.note h3,#sbo-rt-content div[data-type="note"] h6,#sbo-rt-content div[data-type="tip"] h1,#sbo-rt-content div[data-type="note"] h1{color:#737373}#sbo-rt-content div.warning h3,#sbo-rt-content div[data-type="warning"] h6,#sbo-rt-content div[data-type="caution"] h6,#sbo-rt-content div[data-type="important"] h6,#sbo-rt-content div[data-type="warning"] h1,#sbo-rt-content div[data-type="caution"] h1,#sbo-rt-content div[data-type="important"] h1{color:#C67171}#sbo-rt-content div.sect1[title="Safari® Books Online"] div.note,#sbo-rt-content div.safarienabled{background-color:transparent;margin:8px 0 0 !important;border:0 solid #BEBEBE;font-size:100%;padding:0 !important;page-break-inside:avoid}#sbo-rt-content div.sect1[title="Safari® Books Online"] div.note h3,#sbo-rt-content div.safarienabled h6{display:none}#sbo-rt-content div.table,#sbo-rt-content table{margin:15px 0 30px 0 !important;max-width:95%;border:none !important;background:none;display:table !important}#sbo-rt-content div.table,#sbo-rt-content div.informaltable,#sbo-rt-content table{page-break-inside:avoid}#sbo-rt-content tr,#sbo-rt-content tr td{border-bottom:1px solid #c3c3c3}#sbo-rt-content thead td,#sbo-rt-content thead th{border-bottom:#9d9d9d 1px solid !important;border-top:#9d9d9d 1px solid !important}#sbo-rt-content tr:nth-of-type(even){background-color:#f1f6fc}#sbo-rt-content thead{font-family:sans-serif;font-weight:bold}#sbo-rt-content td,#sbo-rt-content th{display:table-cell;padding:.3em;text-align:left;vertical-align:middle;font-size:80%}#sbo-rt-content div.informaltable table{margin:10px auto !important}#sbo-rt-content div.informaltable table tr{border-bottom:none}#sbo-rt-content div.informaltable table tr:nth-of-type(even){background-color:transparent}#sbo-rt-content div.informaltable td,#sbo-rt-content div.informaltable th{border:#9d9d9d 1px solid}#sbo-rt-content div.table-title,#sbo-rt-content table caption{font-weight:normal;font-style:italic;font-family:serif;font-size:1em;margin:10px 0 10px 0 !important;padding:0;page-break-after:avoid;text-align:left !important}#sbo-rt-content table code{font-size:smaller}#sbo-rt-content div.equation,#sbo-rt-content div[data-type="equation"]{margin:10px 0 15px 0 !important}#sbo-rt-content div.equation-title,#sbo-rt-content div[data-type="equation"] h5{font-style:italic;font-weight:normal;font-family:serif !important;font-size:90%;margin:20px 0 10px 0 !important;page-break-after:avoid}#sbo-rt-content div.equation-contents{margin-left:20px}#sbo-rt-content span.inlinemediaobject{height:.85em;display:inline-block;margin-bottom:.2em}#sbo-rt-content span.inlinemediaobject img{margin:0;height:.85em}#sbo-rt-content div.informalequation{margin:20px 0 20px 20px;width:75%}#sbo-rt-content div.informalequation img{width:75%}#sbo-rt-content div.index{text-indent:0}#sbo-rt-content div.index li{line-height:140%}#sbo-rt-content div.index a.indexterm{color:#8e0012}#sbo-rt-content div.index ul,#sbo-rt-content div[data-type="index"] ul{list-style-type:none;padding-left:0;margin-left:0}#sbo-rt-content div.index ul li{padding-left:0;margin-left:0}#sbo-rt-content div.index ul li ul li{margin-left:1em}#sbo-rt-content code.boolean,#sbo-rt-content .navy{color:rgb(0,0,128);}#sbo-rt-content code.character,#sbo-rt-content .olive{color:rgb(128,128,0);}#sbo-rt-content code.comment,#sbo-rt-content .blue{color:rgb(0,0,255);}#sbo-rt-content code.conditional,#sbo-rt-content .limegreen{color:rgb(50,205,50);}#sbo-rt-content code.constant,#sbo-rt-content .darkorange{color:rgb(255,140,0);}#sbo-rt-content code.debug,#sbo-rt-content .darkred{color:rgb(139,0,0);}#sbo-rt-content code.define,#sbo-rt-content .darkgoldenrod,#sbo-rt-content .gold{color:rgb(184,134,11);}#sbo-rt-content code.delimiter,#sbo-rt-content .dimgray{color:rgb(105,105,105);}#sbo-rt-content code.error,#sbo-rt-content .red{color:rgb(255,0,0);}#sbo-rt-content code.exception,#sbo-rt-content .salmon{color:rgb(250,128,11);}#sbo-rt-content code.float,#sbo-rt-content .steelblue{color:rgb(70,130,180);}#sbo-rt-content pre code.function,#sbo-rt-content .green{color:rgb(0,128,0);}#sbo-rt-content code.identifier,#sbo-rt-content .royalblue{color:rgb(65,105,225);}#sbo-rt-content code.ignore,#sbo-rt-content .gray{color:rgb(128,128,128);}#sbo-rt-content code.include,#sbo-rt-content .purple{color:rgb(128,0,128);}#sbo-rt-content code.keyword,#sbo-rt-content .sienna{color:rgb(160,82,45);}#sbo-rt-content code.label,#sbo-rt-content .deeppink{color:rgb(255,20,147);}#sbo-rt-content code.macro,#sbo-rt-content .orangered{color:rgb(255,69,0);}#sbo-rt-content code.number,#sbo-rt-content .brown{color:rgb(165,42,42);}#sbo-rt-content code.operator,#sbo-rt-content .black{color:#000;}#sbo-rt-content code.preCondit,#sbo-rt-content .teal{color:rgb(0,128,128);}#sbo-rt-content code.preProc,#sbo-rt-content .fuschia{color:rgb(255,0,255);}#sbo-rt-content code.repeat,#sbo-rt-content .indigo{color:rgb(75,0,130);}#sbo-rt-content code.special,#sbo-rt-content .saddlebrown{color:rgb(139,69,19);}#sbo-rt-content code.specialchar,#sbo-rt-content .magenta{color:rgb(255,0,255);}#sbo-rt-content code.specialcomment,#sbo-rt-content .seagreen{color:rgb(46,139,87);}#sbo-rt-content code.statement,#sbo-rt-content .forestgreen{color:rgb(34,139,34);}#sbo-rt-content code.storageclass,#sbo-rt-content .plum{color:rgb(221,160,221);}#sbo-rt-content code.string,#sbo-rt-content .darkred{color:rgb(139,0,0);}#sbo-rt-content code.structure,#sbo-rt-content .chocolate{color:rgb(210,106,30);}#sbo-rt-content code.tag,#sbo-rt-content .darkcyan{color:rgb(0,139,139);}#sbo-rt-content code.todo,#sbo-rt-content .black{color:#000;}#sbo-rt-content code.type,#sbo-rt-content .mediumslateblue{color:rgb(123,104,238);}#sbo-rt-content code.typedef,#sbo-rt-content .darkgreen{color:rgb(0,100,0);}#sbo-rt-content code.underlined{text-decoration:underline;}#sbo-rt-content pre code.hll{background-color:#ffc}#sbo-rt-content pre code.c{color:#09F;font-style:italic}#sbo-rt-content pre code.err{color:#A00}#sbo-rt-content pre code.k{color:#069;font-weight:bold}#sbo-rt-content pre code.o{color:#555}#sbo-rt-content pre code.cm{color:#35586C;font-style:italic}#sbo-rt-content pre code.cp{color:#099}#sbo-rt-content pre code.c1{color:#35586C;font-style:italic}#sbo-rt-content pre code.cs{color:#35586C;font-weight:bold;font-style:italic}#sbo-rt-content pre code.gd{background-color:#FCC}#sbo-rt-content pre code.ge{font-style:italic}#sbo-rt-content pre code.gr{color:#F00}#sbo-rt-content pre code.gh{color:#030;font-weight:bold}#sbo-rt-content pre code.gi{background-color:#CFC}#sbo-rt-content pre code.go{color:#000}#sbo-rt-content pre code.gp{color:#009;font-weight:bold}#sbo-rt-content pre code.gs{font-weight:bold}#sbo-rt-content pre code.gu{color:#030;font-weight:bold}#sbo-rt-content pre code.gt{color:#9C6}#sbo-rt-content pre code.kc{color:#069;font-weight:bold}#sbo-rt-content pre code.kd{color:#069;font-weight:bold}#sbo-rt-content pre code.kn{color:#069;font-weight:bold}#sbo-rt-content pre code.kp{color:#069}#sbo-rt-content pre code.kr{color:#069;font-weight:bold}#sbo-rt-content pre code.kt{color:#078;font-weight:bold}#sbo-rt-content pre code.m{color:#F60}#sbo-rt-content pre code.s{color:#C30}#sbo-rt-content pre code.na{color:#309}#sbo-rt-content pre code.nb{color:#366}#sbo-rt-content pre code.nc{color:#0A8;font-weight:bold}#sbo-rt-content pre code.no{color:#360}#sbo-rt-content pre code.nd{color:#99F}#sbo-rt-content pre code.ni{color:#999;font-weight:bold}#sbo-rt-content pre code.ne{color:#C00;font-weight:bold}#sbo-rt-content pre code.nf{color:#C0F}#sbo-rt-content pre code.nl{color:#99F}#sbo-rt-content pre code.nn{color:#0CF;font-weight:bold}#sbo-rt-content pre code.nt{color:#309;font-weight:bold}#sbo-rt-content pre code.nv{color:#033}#sbo-rt-content pre code.ow{color:#000;font-weight:bold}#sbo-rt-content pre code.w{color:#bbb}#sbo-rt-content pre code.mf{color:#F60}#sbo-rt-content pre code.mh{color:#F60}#sbo-rt-content pre code.mi{color:#F60}#sbo-rt-content pre code.mo{color:#F60}#sbo-rt-content pre code.sb{color:#C30}#sbo-rt-content pre code.sc{color:#C30}#sbo-rt-content pre code.sd{color:#C30;font-style:italic}#sbo-rt-content pre code.s2{color:#C30}#sbo-rt-content pre code.se{color:#C30;font-weight:bold}#sbo-rt-content pre code.sh{color:#C30}#sbo-rt-content pre code.si{color:#A00}#sbo-rt-content pre code.sx{color:#C30}#sbo-rt-content pre code.sr{color:#3AA}#sbo-rt-content pre code.s1{color:#C30}#sbo-rt-content pre code.ss{color:#A60}#sbo-rt-content pre code.bp{color:#366}#sbo-rt-content pre code.vc{color:#033}#sbo-rt-content pre code.vg{color:#033}#sbo-rt-content pre code.vi{color:#033}#sbo-rt-content pre code.il{color:#F60}#sbo-rt-content pre code.g{color:#050}#sbo-rt-content pre code.l{color:#C60}#sbo-rt-content pre code.l{color:#F90}#sbo-rt-content pre code.n{color:#008}#sbo-rt-content pre code.nx{color:#008}#sbo-rt-content pre code.py{color:#96F}#sbo-rt-content pre code.p{color:#000}#sbo-rt-content pre code.x{color:#F06}#sbo-rt-content div.blockquote_sampler_toc{width:95%;margin:5px 5px 5px 10px !important}#sbo-rt-content div{font-family:serif;text-align:left}#sbo-rt-content .gray-background,#sbo-rt-content .reverse-video{background:#2E2E2E;color:#FFF}#sbo-rt-content .light-gray-background{background:#A0A0A0}#sbo-rt-content .preserve-whitespace{white-space:pre-wrap}#sbo-rt-content span.gray{color:#4C4C4C}
    </style><script> // <![CDATA[
    var g = {
      position_cache: {
        
          "chapter": "/api/v1/book/9781491957653/chapter/ch06.html",
          "book_id": "9781491957653",
          "chapter_uri": "ch06.html",
          "position": 44.746797386,
          "user_uuid": "6dde68c3-375a-4008-9d0b-4795390365f4",
          "next_chapter_uri": "/library/view/python-for-data/9781491957653/ch07.html"
        
      },
      title: "Python for Data Analysis, 2nd Edition",
      author_list: "Wes McKinney",
      format: "book",
      source: "application/epub+zip",
      is_system_book: true,
      is_public: false,
      loaded_from_server: true,
      allow_scripts: false,
      has_mathml: false,
      show_ios_app_teaser: false
    };
    // ]]></script><script src="./ep_files/modernizr.8e35451ddb64.js"></script><script>
    
      

      
        
          window.PUBLIC_ANNOTATIONS = true;
        
      

      window.MOBILE_PUBLIC_ANNOTATIONS = false;

    

    
      window.PRIVACY_CONTROL_OVERRIDE = false;
    

    
      window.PRIVACY_CONTROL_SWITCH = true;
    

    
      window.PUBLISHER_PAGES = true;
    

      window.SBO = {
        "constants": {
          "SITB_ENDPOINT": "/api/v2/sitb/",
          "SEARCH_SELECT_ENDPOINT": "/api/v2/search/select/",
          "ENABLE_ONLINE_TRAINING": true
        }
      };
  </script><link rel="canonical" href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html"><meta name="description" content="Chapter 6. Data Loading, Storage, and File Formats Accessing data is a necessary first step for using most of the tools in this book. I’m going to be focused ... "><meta property="og:title" content="Data Loading, Storage, and File
  Formats"><meta itemprop="isPartOf" content="/library/view/python-for-data/9781491957653/"><meta itemprop="name" content="Data Loading, Storage, and File
  Formats"><meta property="og:url" itemprop="url" content="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html"><meta property="og:site_name" content="Safari"><meta property="og:image" itemprop="thumbnailUrl" content="https://learning.oreilly.com/library/cover/9781491957653/"><meta property="og:description" itemprop="description" content="Chapter 6. Data Loading, Storage, and File Formats Accessing data is a necessary first step for using most of the tools in this book. I’m going to be focused ... "><meta itemprop="inLanguage" content="en"><meta itemprop="publisher" content="O&#39;Reilly Media, Inc."><meta property="og:type" content="book"><meta property="og:book:isbn" itemprop="isbn" content="9781491957660"><meta property="og:book:author" itemprop="author" content="Wes McKinney"><meta property="og:book:tag" itemprop="about" content="Python"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@safari"><style type="text/css" id="font-styles" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &lt;%= font_size %&gt; !important; }">
        
            
              #sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: 1.08em !important; }
            
        
        </style><style type="text/css" id="font-family" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &lt;%= font_family %&gt; !important; }"></style><style type="text/css" id="column-width" data-template="#sbo-rt-content { max-width: &lt;%= column_width %&gt;% !important; margin: 0 auto !important; }">
          
            
                #sbo-rt-content { max-width: 88% !important; margin: 0 auto !important; }
            
          
        </style><noscript><meta http-equiv="refresh" content="0; url=/library/no-js/" /></noscript><script type="text/javascript">
    (function(i,s,o,g,r,a,m) {
      i['GoogleAnalyticsObject']=r;
      i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();
      a=s.createElement(o),m=s.getElementsByTagName(o)[0];
      a.async=1;
      a.src=g;
      m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    var matches = document.cookie.match(/BrowserCookie\s*=\s*([a-f0-9\-]{36})/),
      user_uuid = null;

    if (matches && matches.length === 2) {
      user_uuid = matches[1];
    }

  
    ga('create', 'UA-39299553-7', {'userId': '6dde68c3-375a-4008-9d0b-4795390365f4' });
  

  
    
      ga('set', 'dimension1', 'B2B');
    
  

  ga('set', 'dimension6', user_uuid);

  
    ga('set', 'dimension2', '6dde68c3-375a-4008-9d0b-4795390365f4');
    
      ga('set', 'dimension7', '0014100001O8uVsAAJ');
    
  

  

  

  //enable enhanced link tracking
  ga('require', 'linkid', 'linkid.js');

  // reading interface will track pageviews itself
  if (document.location.pathname.indexOf("/library/view") !== 0) {
    ga('send', 'pageview');
  }
  </script><script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5P4V6Z');
  </script><script defer="" src="./ep_files/vendor.367244aced93.js"></script><script defer="" src="./ep_files/reader.e244cbfbb395.js"></script><script async="" src="./ep_files/MathJax.js"></script><style id="annotator-dynamic-style">.annotator-adder, .annotator-outer, .annotator-notice {
  z-index: 100019;
}
.annotator-filter {
  z-index: 100009;
}</style><style class="blockbyte-bs-style" data-name="content">body>div#blockbyte-bs-indicator>div{opacity:0;pointer-events:none}body>iframe#blockbyte-bs-sidebar.blockbyte-bs-visible,body>iframe#blockbyte-bs-overlay.blockbyte-bs-visible{opacity:1;pointer-events:auto}body.blockbyte-bs-noscroll{overflow:hidden !important}body>div#blockbyte-bs-indicator>div{position:absolute;transform:translate3d(-40px, 0, 0);top:0;left:0;width:40px !important;height:100%;background:rgba(0,0,0,0.5);border-radius:0 10px 10px 0;transition:opacity 0.3s, transform 0.3s;z-index:2}body>div#blockbyte-bs-indicator>div>span{-webkit-mask:no-repeat center/32px;-webkit-mask-image:url(chrome-extension://jdbnofccmhefkmjbkkdkfiicjkgofkdh/img/icon-bookmark.svg);background-color:#ffffff;position:absolute;display:block;top:0;left:0;width:100%;height:100%}body>div#blockbyte-bs-indicator[data-pos='right']{left:auto;right:0}body>div#blockbyte-bs-indicator[data-pos='right']>div{transform:translate3d(40px, 0, 0);left:auto;right:0;border-radius:10px 0 0 10px}body>div#blockbyte-bs-indicator.blockbyte-bs-fullHeight>div{border-radius:0}body>div#blockbyte-bs-indicator.blockbyte-bs-hover>div{transform:translate3d(0, 0, 0);opacity:1}body>div#blockbyte-bs-indicator[data-pos='left'].blockbyte-bs-has-lsb{height:100% !important;top:0 !important}body>div#blockbyte-bs-indicator[data-pos='left'].blockbyte-bs-has-lsb>div{background:transparent}body>div#blockbyte-bs-indicator[data-pos='left'].blockbyte-bs-has-lsb>div>span{-webkit-mask-position-y:20px}body>iframe#blockbyte-bs-sidebar{width:350px;max-width:none;height:0;z-index:2147483646;background-color:rgba(255,255,255,0.8) !important;border:none;display:block !important;transform:translate3d(-350px, 0, 0);transition:width 0s 0.3s, height 0s 0.3s, opacity 0.3s, transform 0.3s}body>iframe#blockbyte-bs-sidebar[data-pos='right']{left:auto;right:0;transform:translate3d(350px, 0, 0)}body>iframe#blockbyte-bs-sidebar.blockbyte-bs-visible{width:calc(100% + 350px);height:100%;transform:translate3d(0, 0, 0);transition:opacity 0.3s, transform 0.3s}body>iframe#blockbyte-bs-sidebar.blockbyte-bs-hideMask{background:none !important}body>iframe#blockbyte-bs-sidebar.blockbyte-bs-hideMask:not(.blockbyte-bs-hover){width:calc(350px + 50px)}body>iframe#blockbyte-bs-overlay{width:100%;max-width:none;height:100%;z-index:2147483647;border:none;background:rgba(0,0,0,0.5) !important;transition:opacity 0.3s}
</style></head>


<body class="reading sidenav nav-collapsed  scalefonts day-mode library" data-gr-c-s-loaded="true" style="">

    
  
  <noscript> 
    <iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P4V6Z"
            height="0" width="0"
            style="display:none;visibility:hidden">
    </iframe>
  </noscript>
  



    
      <div class="hide working" role="status">
        <div class="working-image"></div>
      </div>
      <div class="sbo-site-nav">
        





<a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#container" class="skip">Skip to content</a><header class="topbar t-topbar"><nav role="navigation" class="js-site-nav"><ul class="topnav"><li class="t-logo"><a href="https://learning.oreilly.com/home/" class="l0 None safari-home nav-icn js-keyboard-nav-home"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>Safari Home Icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M4 9.9L4 9.9 4 18 16 18 16 9.9 10 4 4 9.9ZM2.6 8.1L2.6 8.1 8.7 1.9 10 0.5 11.3 1.9 17.4 8.1 18 8.7 18 9.5 18 18.1 18 20 16.1 20 3.9 20 2 20 2 18.1 2 9.5 2 8.7 2.6 8.1Z"></path><rect x="10" y="12" width="3" height="7"></rect><rect transform="translate(18.121320, 10.121320) rotate(-315.000000) translate(-18.121320, -10.121320) " x="16.1" y="9.1" width="4" height="2"></rect><rect transform="translate(2.121320, 10.121320) scale(-1, 1) rotate(-315.000000) translate(-2.121320, -10.121320) " x="0.1" y="9.1" width="4" height="2"></rect></g></svg><span>Safari Home</span></a></li><li><a href="https://learning.oreilly.com/r/" class="t-recommendations-nav l0 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>recommendations icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M50 25C50 18.2 44.9 12.5 38.3 11.7 37.5 5.1 31.8 0 25 0 18.2 0 12.5 5.1 11.7 11.7 5.1 12.5 0 18.2 0 25 0 31.8 5.1 37.5 11.7 38.3 12.5 44.9 18.2 50 25 50 31.8 50 37.5 44.9 38.3 38.3 44.9 37.5 50 31.8 50 25ZM25 3.1C29.7 3.1 33.6 6.9 34.4 11.8 30.4 12.4 26.9 15.1 25 18.8 23.1 15.1 19.6 12.4 15.6 11.8 16.4 6.9 20.3 3.1 25 3.1ZM34.4 15.6C33.6 19.3 30.7 22.2 27.1 22.9 27.8 19.2 30.7 16.3 34.4 15.6ZM22.9 22.9C19.2 22.2 16.3 19.3 15.6 15.6 19.3 16.3 22.2 19.2 22.9 22.9ZM3.1 25C3.1 20.3 6.9 16.4 11.8 15.6 12.4 19.6 15.1 23.1 18.8 25 15.1 26.9 12.4 30.4 11.8 34.4 6.9 33.6 3.1 29.7 3.1 25ZM22.9 27.1C22.2 30.7 19.3 33.6 15.6 34.4 16.3 30.7 19.2 27.8 22.9 27.1ZM25 46.9C20.3 46.9 16.4 43.1 15.6 38.2 19.6 37.6 23.1 34.9 25 31.3 26.9 34.9 30.4 37.6 34.4 38.2 33.6 43.1 29.7 46.9 25 46.9ZM27.1 27.1C30.7 27.8 33.6 30.7 34.4 34.4 30.7 33.6 27.8 30.7 27.1 27.1ZM38.2 34.4C37.6 30.4 34.9 26.9 31.3 25 34.9 23.1 37.6 19.6 38.2 15.6 43.1 16.4 46.9 20.3 46.9 25 46.9 29.7 43.1 33.6 38.2 34.4Z"></path></g></svg><span>Recommended</span></a></li><li><a href="https://learning.oreilly.com/playlists/" class="t-queue-nav l0 nav-icn None"><!--?xml version="1.0" encoding="UTF-8"?--><svg width="21px" height="17px" viewBox="0 0 21 17" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><!-- Generator: Sketch 46.2 (44496) - http://www.bohemiancoding.com/sketch --><title>icon_Playlist_sml</title><desc>Created with Sketch.</desc><defs></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="icon_Playlist_sml" fill-rule="nonzero" fill="#000000"><g id="playlist-icon"><g id="Group-6"><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle></g><g id="Group-5" transform="translate(0.000000, 7.000000)"><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect></g><g id="Group-5-Copy" transform="translate(0.000000, 14.000000)"><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect></g></g></g></g></svg><span>
               Playlists
            </span></a></li><li class="search"><a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#" class="t-search-nav trigger nav-icn l0" data-dropdown-selector=".searchbox"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>search icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M31.3 0C20.9 0 12.5 8.4 12.5 18.8 12.5 22.5 13.6 25.9 15.4 28.8L1.2 42.9C-0.4 44.5-0.4 47.2 1.2 48.8 2 49.6 3.1 50 4.2 50 5.2 50 6.3 49.6 7.1 48.8L21.2 34.6C24.1 36.5 27.5 37.5 31.3 37.5 41.6 37.5 50 29.1 50 18.8 50 8.4 41.6 0 31.3 0ZM31.3 31.3C24.4 31.3 18.8 25.6 18.8 18.8 18.8 11.9 24.4 6.3 31.3 6.3 38.1 6.3 43.8 11.9 43.8 18.8 43.8 25.6 38.1 31.3 31.3 31.3Z"></path></g></svg><span>Search</span></a></li><li class="usermenu dropdown"><a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#" class="trigger l0 nav-icn nav-dropdown"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>navigation arrow</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M0.1 12.5L9.7 3.1C9.8 3 9.9 3 10 3 10.1 3 10.2 3 10.3 3.1L19.9 12.5C20 12.5 20 12.6 20 12.8 20 12.9 20 13 19.9 13L17 15.9C16.9 16 16.8 16 16.7 16 16.5 16 16.4 16 16.4 15.9L10 9.7 3.6 15.9C3.6 16 3.5 16 3.3 16 3.2 16 3.1 16 3 15.9L0.1 13C0 12.9 0 12.8 0 12.7 0 12.7 0 12.6 0.1 12.5Z"></path></g></svg><span>Expand Nav</span></a><div class="drop-content"><ul><li><a href="https://learning.oreilly.com/history/" class="t-recent-nav l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>recent items icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M25 0C11.2 0 0 11.2 0 25 0 38.8 11.2 50 25 50 38.8 50 50 38.8 50 25 50 11.2 38.8 0 25 0ZM6.3 25C6.3 14.6 14.6 6.3 25 6.3 35.4 6.3 43.8 14.6 43.8 25 43.8 35.4 35.4 43.8 25 43.8 14.6 43.8 6.3 35.4 6.3 25ZM31.8 31.5C32.5 30.5 32.4 29.2 31.6 28.3L27.1 23.8 27.1 12.8C27.1 11.5 26.2 10.4 25 10.4 23.9 10.4 22.9 11.5 22.9 12.8L22.9 25.7 28.8 31.7C29.2 32.1 29.7 32.3 30.2 32.3 30.8 32.3 31.3 32 31.8 31.5Z"></path></g></svg><span>History</span></a></li><li><a href="https://learning.oreilly.com/topics" class="t-topics-link l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 55" width="20" height="20" version="1.1" fill="#4A3C31"><desc>topics icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M25 55L50 41.262 50 13.762 25 0 0 13.762 0 41.262 25 55ZM8.333 37.032L8.333 17.968 25 8.462 41.667 17.968 41.667 37.032 25 46.538 8.333 37.032Z"></path></g></svg><span>Topics</span></a></li><li><a href="https://learning.oreilly.com/learning-paths/" class="l1 nav-icn t-learningpaths-nav js-toggle-menu-item"><!--?xml version="1.0" encoding="UTF-8"?--><svg width="32px" height="32px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><!-- Generator: Sketch 52.5 (67469) - http://www.bohemiancoding.com/sketch --><title>Mask</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M0,16.0214227 C0,15.0387209 0.796453294,14.2411658 1.77779753,14.2411658 C2.75914177,14.2411658 3.55559506,15.0387209 3.55559506,16.0214227 C3.55559506,17.0041246 2.75914177,17.8016797 1.77779753,17.8016797 C0.796453294,17.8016797 0,17.0041246 0,16.0214227 Z M9.77788642,5.22914885 C8.9280992,5.72049977 7.84008711,5.42853763 7.34941499,4.57757479 C6.85874287,3.72661195 7.15030167,2.63709467 8.00008889,2.14574375 C8.84987611,1.65439282 9.9378882,1.94635496 10.4285603,2.7973178 C10.9192324,3.64828064 10.6276736,4.73779792 9.77788642,5.22914885 Z M4.57213969,7.35869225 C5.42192691,7.85004318 5.71348571,8.93956046 5.22281359,9.79052329 C4.73214147,10.6414861 3.64412938,10.9334483 2.79434216,10.4420974 C1.94455494,9.95074642 1.65299614,8.86122915 2.14366826,8.01026631 C2.63434038,7.15930347 3.72235247,6.86734132 4.57213969,7.35869225 Z M2.79434216,21.6007481 C3.64412938,21.1093972 4.73214147,21.4013594 5.22281359,22.2523222 C5.71348571,23.103285 5.42192691,24.1928023 4.57213969,24.6841532 C3.72235247,25.1755042 2.63434038,24.883542 2.14366826,24.0325792 C1.65299614,23.1816163 1.94455494,22.0920991 2.79434216,21.6007481 Z M7.34941499,27.4652707 C7.84008711,26.6143079 8.9280992,26.3223457 9.77788642,26.8136966 C10.6276736,27.3050476 10.9192324,28.3945649 10.4285603,29.2455277 C9.9378882,30.0964905 8.84987611,30.3884527 8.00008889,29.8971017 C7.15030167,29.4057508 6.85874287,28.3162335 7.34941499,27.4652707 Z M18.7118524,11.3165596 C21.3074367,12.8173162 22.1963355,16.1392758 20.6976522,18.738451 C19.1989689,21.3358459 15.8815987,22.2259744 13.2860143,20.726998 C10.6922077,19.2262414 9.80330893,15.9042818 11.3002144,13.3051066 C12.7988978,10.7059314 16.116268,9.81580294 18.7118524,11.3165596 Z M26.7821642,27.8093944 L30.1315348,31.1633985 C30.3982044,31.4304371 30.2097579,31.8844026 29.8346426,31.8844026 L21.5945511,31.8844026 C21.1287681,31.8844026 20.751875,31.5069881 20.751875,31.0405608 L20.751875,22.7890697 C20.751875,22.4134355 21.2052134,22.2247282 21.4701052,22.4899865 L24.2843587,25.3081333 C26.8337204,23.0240636 28.4444049,19.7092251 28.4444049,16.0223129 C28.4444049,9.15052091 22.8621207,3.56051397 15.9998222,3.56051397 L15.9998222,0 C24.8230314,0 32,7.18689745 32,16.0223129 C32,20.6919269 29.9750886,24.8790914 26.7821642,27.8093944 Z" id="Mask" fill="#8B889A"></path></g></svg><span>Learning Paths</span></a></li><li class="nav-offers flyout-parent"><a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#" class="l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>offers icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M35.9 20.6L27 15.5C26.1 15 24.7 15 23.7 15.5L14.9 20.6C13.9 21.1 13.2 22.4 13.2 23.4L13.2 41.4C13.2 42.4 13.9 43.7 14.9 44.2L23.3 49C24.2 49.5 25.6 49.5 26.6 49L35.9 43.6C36.8 43.1 37.6 41.8 37.6 40.8L37.6 23.4C37.6 22.4 36.8 21.1 35.9 20.6L35.9 20.6ZM40 8.2C39.1 7.6 37.6 7.6 36.7 8.2L30.2 11.9C29.3 12.4 29.3 13.2 30.2 13.8L39.1 18.8C40 19.4 40.7 20.6 40.7 21.7L40.7 39C40.7 40.1 41.4 40.5 42.4 40L48.2 36.6C49.1 36.1 49.8 34.9 49.8 33.8L49.8 15.6C49.8 14.6 49.1 13.3 48.2 12.8L40 8.2 40 8.2ZM27 10.1L33.6 6.4C34.5 5.9 34.5 5 33.6 4.5L26.6 0.5C25.6 0 24.2 0 23.3 0.5L16.7 4.2C15.8 4.7 15.8 5.6 16.7 6.1L23.7 10.1C24.7 10.6 26.1 10.6 27 10.1ZM10.1 21.7C10.1 20.6 10.8 19.4 11.7 18.8L20.6 13.8C21.5 13.2 21.5 12.4 20.6 11.9L13.6 7.9C12.7 7.4 11.2 7.4 10.3 7.9L1.6 12.8C0.7 13.3 0 14.6 0 15.6L0 33.8C0 34.9 0.7 36.1 1.6 36.6L8.4 40.5C9.3 41 10.1 40.6 10.1 39.6L10.1 21.7 10.1 21.7Z"></path></g></svg><span>Offers &amp; Deals</span></a><ul class="flyout"><li><a href="https://learning.oreilly.com/oreilly-conferences/" class="l2 nav-icn"><span>Conferences</span></a></li><li><a href="https://get.oreilly.com/email-signup.html" target="_blank" class="l2 nav-icn"><span>Newsletters</span></a></li></ul></li><li class="nav-highlights"><a href="https://learning.oreilly.com/u/6dde68c3-375a-4008-9d0b-4795390365f4/" class="t-highlights-nav l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 35" width="20" height="20" version="1.1" fill="#4A3C31"><desc>highlights icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M13.325 18.071L8.036 18.071C8.036 11.335 12.36 7.146 22.5 5.594L22.5 0C6.37 1.113 0 10.632 0 22.113 0 29.406 3.477 35 10.403 35 15.545 35 19.578 31.485 19.578 26.184 19.578 21.556 17.211 18.891 13.325 18.071L13.325 18.071ZM40.825 18.071L35.565 18.071C35.565 11.335 39.86 7.146 50 5.594L50 0C33.899 1.113 27.5 10.632 27.5 22.113 27.5 29.406 30.977 35 37.932 35 43.045 35 47.078 31.485 47.078 26.184 47.078 21.556 44.74 18.891 40.825 18.071L40.825 18.071Z"></path></g></svg><span>Highlights</span></a></li><li><a href="https://learning.oreilly.com/u/preferences/" class="t-settings-nav l1 js-settings nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 53" width="20" height="20" version="1.1" fill="#4A3C31"><desc>settings icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M44.6 29.6C44.7 28.6 44.8 27.5 44.8 26.5 44.8 25.5 44.7 24.4 44.6 23.4L49.6 19C50 18.8 50.1 18.3 49.9 17.9 48.9 14.7 47.1 11.7 44.9 9.1 44.6 8.8 44.2 8.7 43.8 8.8L37.4 11.1C35.8 9.8 34 8.7 32.1 8L30.9 1.4C30.8 0.9 30.4 0.6 30 0.5 26.7-0.2 23.3-0.2 20 0.5 19.6 0.6 19.2 0.9 19.1 1.4L17.9 8C16 8.7 14.1 9.8 12.6 11.1L6.2 8.8C5.8 8.7 5.4 8.8 5.1 9.1 2.9 11.7 1.1 14.7 0.1 17.9 -0.1 18.3 0 18.8 0.4 19L5.4 23.4C5.3 24.4 5.2 25.5 5.2 26.5 5.2 27.5 5.3 28.6 5.4 29.6L0.4 34C0 34.2-0.1 34.7 0.1 35.1 1.1 38.3 2.9 41.4 5.1 43.9 5.4 44.2 5.8 44.4 6.2 44.2L12.6 42C14.1 43.2 16 44.3 17.9 45L19.1 51.7C19.2 52.1 19.6 52.5 20 52.5 21.6 52.8 23.3 53 25 53 26.7 53 28.4 52.8 30 52.5 30.4 52.5 30.8 52.1 30.9 51.7L32.1 45C34 44.3 35.8 43.2 37.4 42L43.8 44.2C44.2 44.4 44.6 44.2 44.9 43.9 47.1 41.4 48.9 38.3 49.9 35.1 50.1 34.7 50 34.2 49.6 34L44.6 29.6ZM25 36.4C19.6 36.4 15.2 32 15.2 26.5 15.2 21 19.6 16.6 25 16.6 30.4 16.6 34.8 21 34.8 26.5 34.8 32 30.4 36.4 25 36.4Z"></path></g></svg><span>Settings</span></a></li><li><a href="https://www.oreilly.com/online-learning/support/" class="l1 no-icon">Support</a></li><li><a href="https://learning.oreilly.com/accounts/logout/" class="l1 no-icon">Sign Out</a></li></ul><ul class="profile"><li><a href="https://learning.oreilly.com/u/preferences/" class="l2 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 53" width="20" height="20" version="1.1" fill="#4A3C31"><desc>settings icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M44.6 29.6C44.7 28.6 44.8 27.5 44.8 26.5 44.8 25.5 44.7 24.4 44.6 23.4L49.6 19C50 18.8 50.1 18.3 49.9 17.9 48.9 14.7 47.1 11.7 44.9 9.1 44.6 8.8 44.2 8.7 43.8 8.8L37.4 11.1C35.8 9.8 34 8.7 32.1 8L30.9 1.4C30.8 0.9 30.4 0.6 30 0.5 26.7-0.2 23.3-0.2 20 0.5 19.6 0.6 19.2 0.9 19.1 1.4L17.9 8C16 8.7 14.1 9.8 12.6 11.1L6.2 8.8C5.8 8.7 5.4 8.8 5.1 9.1 2.9 11.7 1.1 14.7 0.1 17.9 -0.1 18.3 0 18.8 0.4 19L5.4 23.4C5.3 24.4 5.2 25.5 5.2 26.5 5.2 27.5 5.3 28.6 5.4 29.6L0.4 34C0 34.2-0.1 34.7 0.1 35.1 1.1 38.3 2.9 41.4 5.1 43.9 5.4 44.2 5.8 44.4 6.2 44.2L12.6 42C14.1 43.2 16 44.3 17.9 45L19.1 51.7C19.2 52.1 19.6 52.5 20 52.5 21.6 52.8 23.3 53 25 53 26.7 53 28.4 52.8 30 52.5 30.4 52.5 30.8 52.1 30.9 51.7L32.1 45C34 44.3 35.8 43.2 37.4 42L43.8 44.2C44.2 44.4 44.6 44.2 44.9 43.9 47.1 41.4 48.9 38.3 49.9 35.1 50.1 34.7 50 34.2 49.6 34L44.6 29.6ZM25 36.4C19.6 36.4 15.2 32 15.2 26.5 15.2 21 19.6 16.6 25 16.6 30.4 16.6 34.8 21 34.8 26.5 34.8 32 30.4 36.4 25 36.4Z"></path></g></svg><span>Settings</span></a></li><li><a href="https://www.oreilly.com/online-learning/support/" class="l2">Support</a></li><li><a href="https://learning.oreilly.com/accounts/logout/" class="l2">Sign Out</a></li></ul></div></li></ul></nav></header>


      </div>
      <div id="container" class="application" style="height: auto;">
        
          <div class="nav-container clearfix">
            


            
            
          </div>

          

  <div class="js-toc">
    
      <div class="sbo-reading-menu sbo-menu-top"><section class="sbo-toc-container toc-menu"><a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#" class="sbo-toc-thumb"><span class="sbo-title ss-list"><h1><div class="visuallyhidden">Table of Contents for </div>
      
      Python for Data Analysis, 2nd Edition
      
    </h1></span></a><div class="toc-contents"></div></section></div>

    

    <div class="interface-controls interface-controls-top">
      <ul class="interface-control-btns js-bitlist js-reader">
        <li class="js-search-in-archive search-in-archive t-search-in-archive"><a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#" title="Search in archive" class="js-search-controls search-controls"><span class="icon">Search in book...</span></a><form class="search-archive-bar js-search-form"><input type="search" name="query" placeholder="Search inside this book..." autocomplete="off"></form><div class="search-archive-results"><div class="js-sitb-results-region"></div></div></li><li class="queue-control"><div class="js-content-uri" data-content-uri="/api/v1/book/9781491957653/chapter/ch06.html"><div class="js-collections-dropdown collections-dropdown menu-bit-cards"><div data-reactroot="" class="menu-dropdown-wrapper js-menu-dropdown-wrapper align-right"><img class="hidden" src="./ep_files/ajax-transp.gif" alt="loading spinner"><div class="menu-control"><div class="control "><div class="js-playlists-menu"><button class="js-playlist-icon"><svg class="icon-add-to-playlist-sml" viewBox="0 0 16 14" version="1.1" xmlns="http://www.w3.org/2000/svg"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g fill-rule="nonzero" fill="#000000"><g transform="translate(-1.000000, 0.000000)"><rect x="5" y="0" width="12" height="2"></rect><title>Playlists</title><path d="M4.5,14 C6.43299662,14 8,12.4329966 8,10.5 C8,8.56700338 6.43299662,7 4.5,7 C2.56700338,7 1,8.56700338 1,10.5 C1,12.4329966 2.56700338,14 4.5,14 Z M2.5,10 L4,10 L4,8.5 L5,8.5 L5,10 L6.5,10 L6.5,11 L5,11 L5,12.5 L4,12.5 L4,11 L2.5,11 L2.5,10 Z"></path><circle cx="2" cy="5" r="1"></circle><circle cx="1.94117647" cy="1" r="1"></circle><rect x="5" y="4" width="12" height="2"></rect><rect x="9" y="8" width="8" height="2"></rect><rect x="9" y="12" width="8" height="2"></rect></g></g></g></svg><div class="js-playlist-addto-label">Add&nbsp;To</div></button></div></div></div></div></div></div></li><li class="js-font-control-panel font-control-activator"><a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#" data-push-state="false" id="font-controls" title="Change font size" aria-label="Change font size"><span class="icon">Toggle Font Controls</span></a></li><li class="dropdown sharing-controls"><a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#" class="trigger" data-push-state="false" title="Share" aria-label="Share"><i class="fa fa-share"></i></a><ul class="social-sharing dropdown-menu"><li><a class="twitter share-button t-twitter" target="_blank" aria-label="Share this section on Twitter" title="Share this section on Twitter" href="https://twitter.com/share?url=https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html&amp;text=Python%20for%20Data%20Analysis%2C%202nd%20Edition&amp;via=safari"><span>Twitter</span></a></li><li><a class="facebook share-button t-facebook" target="_blank" aria-label="Share this section on Facebook" title="Share this section on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html"><span>Facebook</span></a></li><li><a class="googleplus share-button t-googleplus" target="_blank" aria-label="Share this secton on Google Plus" title="Share this secton on Google Plus" href="https://plus.google.com/share?url=https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html"><span>Google Plus</span></a></li><li><a class="email share-button t-email" aria-label="Share this section via email" title="Share this section via email" href="mailto:?subject=Safari:%20Data%20Loading%2C%20Storage%2C%20and%20File%0A%20%20Formats&amp;body=https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html%0D%0Afrom%20Python%20for%20Data%20Analysis%2C%202nd%20Edition%0D%0A"><span>Email</span></a></li></ul></li>
      </ul>
    </div>

    <section role="document">
        
        




  <script defer="" src="./ep_files/djangoMessagesPage.2f97010e3922.js"></script>


        
	  <div class="t-sbo-prev sbo-prev sbo-nav-top">
  
    
      
        <a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch05.html" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">Getting Started with pandas</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-top">
  
    
      
        <a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch07.html" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">Data Cleaning and Preparation</div>
        </a>
    
  
  </div>



<div id="sbo-rt-content" style="transform: none;"><div class="annotator-wrapper"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 6. Data Loading, Storage, and File
  Formats"><div class="chapter" id="io"><h1><span class="label">Chapter 6. </span>Data Loading, Storage, <span class="keep-together">and File
  Formats</span></h1><p>Accessing data is a necessary first step for using most of the tools
  in this book. I’m going to be focused on data input and output using pandas,
  though there are numerous tools in other libraries to help with reading and
  writing data in various formats.</p><p>Input and output typically falls into a few main categories: reading
  text files and other more efficient on-disk formats, loading data from
  databases, and interacting with network sources like web APIs.</p><section data-type="sect1" data-pdf-bookmark="6.1 Reading and Writing Data in Text Format"><div class="sect1" id="io_flat_files"><h1>6.1 Reading and Writing Data in Text Format</h1><p>pandas features a <a data-type="indexterm" data-primary="pandas library" data-secondary="reading and writing data in text format" id="pl6.1"></a><a data-type="indexterm" data-primary="file management" data-secondary="reading and writing data in text format" id="fm6.1"></a><a data-type="indexterm" data-primary="text files" data-secondary="reading" id="tfr6.1"></a><a data-type="indexterm" data-primary="text files" data-secondary="writing to" id="tfw6.1"></a><a data-type="indexterm" data-primary="reading data" data-secondary="in text format" id="rd6.1"></a><a data-type="indexterm" data-primary="writing data in text format" id="wd6.1"></a><a data-type="indexterm" data-primary="data loading" data-see="reading data" id="idm140621948020000"></a>number of functions for reading tabular data as a DataFrame
    object. <a data-type="xref" href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#table_parsing_functions">Table&nbsp;6-1</a> summarizes some of
    them, though <code>read_csv</code> and <code>read_table</code> are likely the ones you’ll use the
    most.</p><table id="table_parsing_functions"><caption><span class="label">Table 6-1. </span>Parsing functions in pandas</caption><thead><tr><th>Function</th><th>Description</th></tr></thead><tbody><tr><td><code>read_csv</code></td><td>Load delimited data <a data-type="indexterm" data-primary="read_csv function" id="idm140621948014288"></a>from a file, URL, or file-like object; use comma as
            default delimiter</td></tr><tr><td><code>read_table</code></td><td>Load delimited <a data-type="indexterm" data-primary="read_table function" id="idm140621948012400"></a>data from a file, URL, or file-like object; use tab
            (<code>'\t'</code>) as default
            delimiter</td></tr><tr><td><code>read_fwf</code></td><td>Read data in <a data-type="indexterm" data-primary="read_fwf function" id="idm140621948010192"></a>fixed-width column format (i.e., no
            delimiters)</td></tr><tr><td><code>read_clipboard</code></td><td>Version <a data-type="indexterm" data-primary="read_clipboard function" id="idm140621948008400"></a>of <code>read_table</code>
            that reads data from the clipboard; useful for converting tables
            from web pages</td></tr><tr><td><code>read_excel</code></td><td>Read tabular <a data-type="indexterm" data-primary="read_excel function" id="idm140621948006032"></a>data from an Excel XLS or XLSX file</td></tr><tr><td><code>read_hdf</code></td><td>Read HDF5 <a data-type="indexterm" data-primary="read_hdf function" id="idm140621948004192"></a>files written by pandas</td></tr><tr><td><code>read_html</code></td><td>Read all <a data-type="indexterm" data-primary="read_html function" id="idm140621948002368"></a>tables found in the given HTML document</td></tr><tr><td><code>read_json</code></td><td>Read data <a data-type="indexterm" data-primary="read_json function" id="idm140621948000528"></a>from a JSON (JavaScript Object Notation) string
            representation</td></tr><tr><td><code>read_msgpack</code></td><td>Read <a data-type="indexterm" data-primary="read_msgpack function" id="idm140621947998640"></a>pandas data encoded using the MessagePack binary
            format</td></tr><tr><td><code>read_pickle</code></td><td>Read an <a data-type="indexterm" data-primary="read_pickle function" id="idm140621947996848"></a>arbitrary object stored in Python pickle
            format</td></tr><tr><td><code>read_sas</code></td><td>Read a <a data-type="indexterm" data-primary="read_sas function" id="idm140621947995056"></a>SAS dataset stored in one of the SAS system’s custom
            storage formats</td></tr><tr><td><code>read_sql</code></td><td>Read <a data-type="indexterm" data-primary="read_sql function" id="idm140621947993168"></a>the results of a SQL query (using SQLAlchemy) as a
            pandas DataFrame</td></tr><tr><td><code>read_stata</code></td><td>Read a <a data-type="indexterm" data-primary="read_stata function" id="idm140621947991280"></a>dataset from <a data-type="indexterm" data-primary="Stata file format" id="idm140621947990288"></a>Stata file format</td></tr><tr><td><code>read_feather</code></td><td>Read the <a data-type="indexterm" data-primary="read_feather function" id="idm140621947988464"></a><a data-type="indexterm" data-primary="Feather binary file format" id="idm140621947987600"></a>Feather binary file format</td></tr></tbody></table><p>I’ll give an overview of the <a data-type="indexterm" data-primary="DataFrame data structure" data-secondary="optional function arguments" id="idm140621947986448"></a>mechanics of these functions, which are meant to convert
    text data into a DataFrame. The optional arguments for these functions may
    fall into a few categories:</p><dl><dt>Indexing</dt><dd><p>Can treat one or more columns as the returned DataFrame, and
          whether to get column names from the file, the user, or not at
          all.</p></dd><dt>Type inference and data conversion</dt><dd><p>This includes the user-defined value conversions and custom
          list of missing value markers.</p></dd><dt>Datetime parsing</dt><dd><p>Includes combining capability, including combining date and
          time information spread over multiple columns into a single column
          in the result.</p></dd><dt>Iterating</dt><dd><p>Support for iterating over chunks of very large files.</p></dd><dt>Unclean data issues</dt><dd><p>Skipping rows or a footer, comments, or other minor things
          like numeric data with thousands separated by commas.</p></dd></dl><p>Because of how messy data in the real world can be, some of the data
    loading functions (especially <code>read_csv</code>) have grown very
    complex in their options over time. It’s normal to feel overwhelmed by the
    number of different parameters (<code>read_csv</code> has over 50 as
    of this writing). The online pandas documentation has many examples about
    how each of them works, so if you’re struggling to read a particular file,
    there might be a similar enough example to help you find the right
    parameters.</p><p>Some of these functions, like <code>pandas.read_csv</code>,
    perform <em>type inference</em>, <a data-type="indexterm" data-primary="functions" data-secondary="type inference in" id="idm140621947978160"></a><a data-type="indexterm" data-primary="type inference in functions" id="idm140621947977024"></a>because the column data types are not part of the data
    format. That means you don’t necessarily have to specify which columns are
    numeric, integer, boolean, or string. Other data formats, like HDF5,
    Feather, and msgpack, have the data types stored in the format.</p><p>Handling dates and other custom types can require extra effort.
    Let’s start with a small <a data-type="indexterm" data-primary="CSV files" id="idm140621947975344"></a>comma-separated (CSV) text file:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">8</code><code class="p">]:</code> <code class="err">!</code><code class="n">cat</code> <code class="n">examples</code><code class="o">/</code><code class="n">ex1</code><code class="o">.</code><code class="n">csv</code>
<code class="n">a</code><code class="p">,</code><code class="n">b</code><code class="p">,</code><code class="n">c</code><code class="p">,</code><code class="n">d</code><code class="p">,</code><code class="n">message</code>
<code class="mi">1</code><code class="p">,</code><code class="mi">2</code><code class="p">,</code><code class="mi">3</code><code class="p">,</code><code class="mi">4</code><code class="p">,</code><code class="n">hello</code>
<code class="mi">5</code><code class="p">,</code><code class="mi">6</code><code class="p">,</code><code class="mi">7</code><code class="p">,</code><code class="mi">8</code><code class="p">,</code><code class="n">world</code>
<code class="mi">9</code><code class="p">,</code><code class="mi">10</code><code class="p">,</code><code class="mi">11</code><code class="p">,</code><code class="mi">12</code><code class="p">,</code><code class="n">foo</code></pre><div data-type="note" epub:type="note"><h6>Note</h6><p>Here I used the Unix <code>cat</code> shell
      command to print the raw contents of the file to the screen. If you’re
      on Windows, you can use <code>type</code> instead
      of <code>cat</code> to achieve the same
      effect.</p></div><p>Since this is comma-delimited, we can use <code>read_csv</code> to read it into a DataFrame:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">9</code><code class="p">]:</code> <code class="n">df</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'examples/ex1.csv'</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">10</code><code class="p">]:</code> <code class="n">df</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">10</code><code class="p">]:</code> 
   <code class="n">a</code>   <code class="n">b</code>   <code class="n">c</code>   <code class="n">d</code> <code class="n">message</code>
<code class="mi">0</code>  <code class="mi">1</code>   <code class="mi">2</code>   <code class="mi">3</code>   <code class="mi">4</code>   <code class="n">hello</code>
<code class="mi">1</code>  <code class="mi">5</code>   <code class="mi">6</code>   <code class="mi">7</code>   <code class="mi">8</code>   <code class="n">world</code>
<code class="mi">2</code>  <code class="mi">9</code>  <code class="mi">10</code>  <code class="mi">11</code>  <code class="mi">12</code>     <code class="n">foo</code></pre><p>We could also have used <code>read_table</code> and specified the delimiter:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">11</code><code class="p">]:</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_table</code><code class="p">(</code><code class="s1">'examples/ex1.csv'</code><code class="p">,</code> <code class="n">sep</code><code class="o">=</code><code class="s1">','</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">11</code><code class="p">]:</code> 
   <code class="n">a</code>   <code class="n">b</code>   <code class="n">c</code>   <code class="n">d</code> <code class="n">message</code>
<code class="mi">0</code>  <code class="mi">1</code>   <code class="mi">2</code>   <code class="mi">3</code>   <code class="mi">4</code>   <code class="n">hello</code>
<code class="mi">1</code>  <code class="mi">5</code>   <code class="mi">6</code>   <code class="mi">7</code>   <code class="mi">8</code>   <code class="n">world</code>
<code class="mi">2</code>  <code class="mi">9</code>  <code class="mi">10</code>  <code class="mi">11</code>  <code class="mi">12</code>     <code class="n">foo</code></pre><p>A file will not always have a header row. Consider this file:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">12</code><code class="p">]:</code> <code class="err">!</code><code class="n">cat</code> <code class="n">examples</code><code class="o">/</code><code class="n">ex2</code><code class="o">.</code><code class="n">csv</code>
<code class="mi">1</code><code class="p">,</code><code class="mi">2</code><code class="p">,</code><code class="mi">3</code><code class="p">,</code><code class="mi">4</code><code class="p">,</code><code class="n">hello</code>
<code class="mi">5</code><code class="p">,</code><code class="mi">6</code><code class="p">,</code><code class="mi">7</code><code class="p">,</code><code class="mi">8</code><code class="p">,</code><code class="n">world</code>
<code class="mi">9</code><code class="p">,</code><code class="mi">10</code><code class="p">,</code><code class="mi">11</code><code class="p">,</code><code class="mi">12</code><code class="p">,</code><code class="n">foo</code></pre><p>To read this file, you have a couple of options. You can allow
    pandas to assign default column names, or you can specify names
    yourself:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">13</code><code class="p">]:</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'examples/ex2.csv'</code><code class="p">,</code> <code class="n">header</code><code class="o">=</code><code class="bp">None</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">13</code><code class="p">]:</code> 
   <code class="mi">0</code>   <code class="mi">1</code>   <code class="mi">2</code>   <code class="mi">3</code>      <code class="mi">4</code>
<code class="mi">0</code>  <code class="mi">1</code>   <code class="mi">2</code>   <code class="mi">3</code>   <code class="mi">4</code>  <code class="n">hello</code>
<code class="mi">1</code>  <code class="mi">5</code>   <code class="mi">6</code>   <code class="mi">7</code>   <code class="mi">8</code>  <code class="n">world</code>
<code class="mi">2</code>  <code class="mi">9</code>  <code class="mi">10</code>  <code class="mi">11</code>  <code class="mi">12</code>    <code class="n">foo</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">14</code><code class="p">]:</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'examples/ex2.csv'</code><code class="p">,</code> <code class="n">names</code><code class="o">=</code><code class="p">[</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">,</code> <code class="s1">'d'</code><code class="p">,</code> <code class="s1">'message'</code><code class="p">])</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">14</code><code class="p">]:</code> 
   <code class="n">a</code>   <code class="n">b</code>   <code class="n">c</code>   <code class="n">d</code> <code class="n">message</code>
<code class="mi">0</code>  <code class="mi">1</code>   <code class="mi">2</code>   <code class="mi">3</code>   <code class="mi">4</code>   <code class="n">hello</code>
<code class="mi">1</code>  <code class="mi">5</code>   <code class="mi">6</code>   <code class="mi">7</code>   <code class="mi">8</code>   <code class="n">world</code>
<code class="mi">2</code>  <code class="mi">9</code>  <code class="mi">10</code>  <code class="mi">11</code>  <code class="mi">12</code>     <code class="n">foo</code></pre><p>Suppose you wanted the <code>message</code>
    column to be the index of the returned DataFrame. You can either indicate
    you want the column at index 4 or named <code>'message'</code> using the <code>index_col</code> argument:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">15</code><code class="p">]:</code> <code class="n">names</code> <code class="o">=</code> <code class="p">[</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">,</code> <code class="s1">'d'</code><code class="p">,</code> <code class="s1">'message'</code><code class="p">]</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">16</code><code class="p">]:</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'examples/ex2.csv'</code><code class="p">,</code> <code class="n">names</code><code class="o">=</code><code class="n">names</code><code class="p">,</code> <code class="n">index_col</code><code class="o">=</code><code class="s1">'message'</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">16</code><code class="p">]:</code> 
         <code class="n">a</code>   <code class="n">b</code>   <code class="n">c</code>   <code class="n">d</code>
<code class="n">message</code>               
<code class="n">hello</code>    <code class="mi">1</code>   <code class="mi">2</code>   <code class="mi">3</code>   <code class="mi">4</code>
<code class="n">world</code>    <code class="mi">5</code>   <code class="mi">6</code>   <code class="mi">7</code>   <code class="mi">8</code>
<code class="n">foo</code>      <code class="mi">9</code>  <code class="mi">10</code>  <code class="mi">11</code>  <code class="mi">12</code></pre><p>In the event that you want to form a <a data-type="indexterm" data-primary="hierarchical indexing" data-secondary="in pandas" id="idm140621947329744"></a><a data-type="indexterm" data-primary="indexes and indexing" data-secondary="hierarchical indexing" id="idm140621947328880"></a>hierarchical index from multiple columns, pass a list of
    column numbers or names:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">17</code><code class="p">]:</code> <code class="err">!</code><code class="n">cat</code> <code class="n">examples</code><code class="o">/</code><code class="n">csv_mindex</code><code class="o">.</code><code class="n">csv</code>
<code class="n">key1</code><code class="p">,</code><code class="n">key2</code><code class="p">,</code><code class="n">value1</code><code class="p">,</code><code class="n">value2</code>
<code class="n">one</code><code class="p">,</code><code class="n">a</code><code class="p">,</code><code class="mi">1</code><code class="p">,</code><code class="mi">2</code>
<code class="n">one</code><code class="p">,</code><code class="n">b</code><code class="p">,</code><code class="mi">3</code><code class="p">,</code><code class="mi">4</code>
<code class="n">one</code><code class="p">,</code><code class="n">c</code><code class="p">,</code><code class="mi">5</code><code class="p">,</code><code class="mi">6</code>
<code class="n">one</code><code class="p">,</code><code class="n">d</code><code class="p">,</code><code class="mi">7</code><code class="p">,</code><code class="mi">8</code>
<code class="n">two</code><code class="p">,</code><code class="n">a</code><code class="p">,</code><code class="mi">9</code><code class="p">,</code><code class="mi">10</code>
<code class="n">two</code><code class="p">,</code><code class="n">b</code><code class="p">,</code><code class="mi">11</code><code class="p">,</code><code class="mi">12</code>
<code class="n">two</code><code class="p">,</code><code class="n">c</code><code class="p">,</code><code class="mi">13</code><code class="p">,</code><code class="mi">14</code>
<code class="n">two</code><code class="p">,</code><code class="n">d</code><code class="p">,</code><code class="mi">15</code><code class="p">,</code><code class="mi">16</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">18</code><code class="p">]:</code> <code class="n">parsed</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'examples/csv_mindex.csv'</code><code class="p">,</code>
   <code class="o">....</code><code class="p">:</code>                      <code class="n">index_col</code><code class="o">=</code><code class="p">[</code><code class="s1">'key1'</code><code class="p">,</code> <code class="s1">'key2'</code><code class="p">])</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">19</code><code class="p">]:</code> <code class="n">parsed</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">19</code><code class="p">]:</code> 
           <code class="n">value1</code>  <code class="n">value2</code>
<code class="n">key1</code> <code class="n">key2</code>                
<code class="n">one</code>  <code class="n">a</code>          <code class="mi">1</code>       <code class="mi">2</code>
     <code class="n">b</code>          <code class="mi">3</code>       <code class="mi">4</code>
     <code class="n">c</code>          <code class="mi">5</code>       <code class="mi">6</code>
     <code class="n">d</code>          <code class="mi">7</code>       <code class="mi">8</code>
<code class="n">two</code>  <code class="n">a</code>          <code class="mi">9</code>      <code class="mi">10</code>
     <code class="n">b</code>         <code class="mi">11</code>      <code class="mi">12</code>
     <code class="n">c</code>         <code class="mi">13</code>      <code class="mi">14</code>
     <code class="n">d</code>         <code class="mi">15</code>      <code class="mi">16</code></pre><p>In some cases, a table might not have a fixed delimiter, using
    whitespace or some other pattern to separate fields. Consider a text file
    that looks like this:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">20</code><code class="p">]:</code> <code class="nb">list</code><code class="p">(</code><code class="nb">open</code><code class="p">(</code><code class="s1">'examples/ex3.txt'</code><code class="p">))</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">20</code><code class="p">]:</code> 
<code class="p">[</code><code class="s1">'            A         B         C</code><code class="se">\n</code><code class="s1">'</code><code class="p">,</code>
 <code class="s1">'aaa -0.264438 -1.026059 -0.619500</code><code class="se">\n</code><code class="s1">'</code><code class="p">,</code>
 <code class="s1">'bbb  0.927272  0.302904 -0.032399</code><code class="se">\n</code><code class="s1">'</code><code class="p">,</code>
 <code class="s1">'ccc -0.264273 -0.386314 -0.217601</code><code class="se">\n</code><code class="s1">'</code><code class="p">,</code>
 <code class="s1">'ddd -0.871858 -0.348382  1.100491</code><code class="se">\n</code><code class="s1">'</code><code class="p">]</code></pre><p>While you could do some munging by hand, the fields here are
    separated by a variable amount of whitespace. In these cases, you can pass
    a <a data-type="indexterm" data-primary="regular expressions" data-secondary="passes as delimiters" id="idm140621947215264"></a>regular expression as a delimiter for <code>read_table</code>. This can be expressed by the regular
    expression <code>\s+</code>, so we have then:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">21</code><code class="p">]:</code> <code class="n">result</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_table</code><code class="p">(</code><code class="s1">'examples/ex3.txt'</code><code class="p">,</code> <code class="n">sep</code><code class="o">=</code><code class="s1">'\s+'</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">22</code><code class="p">]:</code> <code class="n">result</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">22</code><code class="p">]:</code> 
            <code class="n">A</code>         <code class="n">B</code>         <code class="n">C</code>
<code class="n">aaa</code> <code class="o">-</code><code class="mf">0.264438</code> <code class="o">-</code><code class="mf">1.026059</code> <code class="o">-</code><code class="mf">0.619500</code>
<code class="n">bbb</code>  <code class="mf">0.927272</code>  <code class="mf">0.302904</code> <code class="o">-</code><code class="mf">0.032399</code>
<code class="n">ccc</code> <code class="o">-</code><code class="mf">0.264273</code> <code class="o">-</code><code class="mf">0.386314</code> <code class="o">-</code><code class="mf">0.217601</code>
<code class="n">ddd</code> <code class="o">-</code><code class="mf">0.871858</code> <code class="o">-</code><code class="mf">0.348382</code>  <code class="mf">1.100491</code></pre><p>Because there was one fewer column name than the number of data
    rows, <code>read_table</code> infers that the first
    column should be the DataFrame’s index in this special case.</p><p>The parser functions have many additional arguments to help you
    handle the wide variety of exception file formats that occur (see a
    partial listing in <a data-type="xref" href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#table_read_csv_function">Table&nbsp;6-2</a>). For
    example, you can skip the first, third, and fourth rows of a file with
    <code>skiprows</code>:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">23</code><code class="p">]:</code> <code class="err">!</code><code class="n">cat</code> <code class="n">examples</code><code class="o">/</code><code class="n">ex4</code><code class="o">.</code><code class="n">csv</code>
<code class="c1"># hey!</code>
<code class="n">a</code><code class="p">,</code><code class="n">b</code><code class="p">,</code><code class="n">c</code><code class="p">,</code><code class="n">d</code><code class="p">,</code><code class="n">message</code>
<code class="c1"># just wanted to make things more difficult for you</code>
<code class="c1"># who reads CSV files with computers, anyway?</code>
<code class="mi">1</code><code class="p">,</code><code class="mi">2</code><code class="p">,</code><code class="mi">3</code><code class="p">,</code><code class="mi">4</code><code class="p">,</code><code class="n">hello</code>
<code class="mi">5</code><code class="p">,</code><code class="mi">6</code><code class="p">,</code><code class="mi">7</code><code class="p">,</code><code class="mi">8</code><code class="p">,</code><code class="n">world</code>
<code class="mi">9</code><code class="p">,</code><code class="mi">10</code><code class="p">,</code><code class="mi">11</code><code class="p">,</code><code class="mi">12</code><code class="p">,</code><code class="n">foo</code>
<code class="n">In</code> <code class="p">[</code><code class="mi">24</code><code class="p">]:</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'examples/ex4.csv'</code><code class="p">,</code> <code class="n">skiprows</code><code class="o">=</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">])</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">24</code><code class="p">]:</code> 
   <code class="n">a</code>   <code class="n">b</code>   <code class="n">c</code>   <code class="n">d</code> <code class="n">message</code>
<code class="mi">0</code>  <code class="mi">1</code>   <code class="mi">2</code>   <code class="mi">3</code>   <code class="mi">4</code>   <code class="n">hello</code>
<code class="mi">1</code>  <code class="mi">5</code>   <code class="mi">6</code>   <code class="mi">7</code>   <code class="mi">8</code>   <code class="n">world</code>
<code class="mi">2</code>  <code class="mi">9</code>  <code class="mi">10</code>  <code class="mi">11</code>  <code class="mi">12</code>     <code class="n">foo</code></pre><p>Handling missing values is an important and frequently nuanced part
    of the file parsing process. <a data-type="indexterm" data-primary="missing data" data-secondary="marked by sentinel values" id="idm140621946956736"></a>Missing data is usually either not present (empty string) or
    <a data-type="indexterm" data-primary="sentinel value" id="idm140621947111504"></a>marked by some <em>sentinel</em> value. By
    default, pandas uses a set of commonly occurring sentinels, such as
    <code>NA</code> and <code>NULL</code>:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">25</code><code class="p">]:</code> <code class="err">!</code><code class="n">cat</code> <code class="n">examples</code><code class="o">/</code><code class="n">ex5</code><code class="o">.</code><code class="n">csv</code>
<code class="n">something</code><code class="p">,</code><code class="n">a</code><code class="p">,</code><code class="n">b</code><code class="p">,</code><code class="n">c</code><code class="p">,</code><code class="n">d</code><code class="p">,</code><code class="n">message</code>
<code class="n">one</code><code class="p">,</code><code class="mi">1</code><code class="p">,</code><code class="mi">2</code><code class="p">,</code><code class="mi">3</code><code class="p">,</code><code class="mi">4</code><code class="p">,</code><code class="n">NA</code>
<code class="n">two</code><code class="p">,</code><code class="mi">5</code><code class="p">,</code><code class="mi">6</code><code class="p">,,</code><code class="mi">8</code><code class="p">,</code><code class="n">world</code>
<code class="n">three</code><code class="p">,</code><code class="mi">9</code><code class="p">,</code><code class="mi">10</code><code class="p">,</code><code class="mi">11</code><code class="p">,</code><code class="mi">12</code><code class="p">,</code><code class="n">foo</code>
<code class="n">In</code> <code class="p">[</code><code class="mi">26</code><code class="p">]:</code> <code class="n">result</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'examples/ex5.csv'</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">27</code><code class="p">]:</code> <code class="n">result</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">27</code><code class="p">]:</code> 
  <code class="n">something</code>  <code class="n">a</code>   <code class="n">b</code>     <code class="n">c</code>   <code class="n">d</code> <code class="n">message</code>
<code class="mi">0</code>       <code class="n">one</code>  <code class="mi">1</code>   <code class="mi">2</code>   <code class="mf">3.0</code>   <code class="mi">4</code>     <code class="n">NaN</code>
<code class="mi">1</code>       <code class="n">two</code>  <code class="mi">5</code>   <code class="mi">6</code>   <code class="n">NaN</code>   <code class="mi">8</code>   <code class="n">world</code>
<code class="mi">2</code>     <code class="n">three</code>  <code class="mi">9</code>  <code class="mi">10</code>  <code class="mf">11.0</code>  <code class="mi">12</code>     <code class="n">foo</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">28</code><code class="p">]:</code> <code class="n">pd</code><code class="o">.</code><code class="n">isnull</code><code class="p">(</code><code class="n">result</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">28</code><code class="p">]:</code> 
   <code class="n">something</code>      <code class="n">a</code>      <code class="n">b</code>      <code class="n">c</code>      <code class="n">d</code>  <code class="n">message</code>
<code class="mi">0</code>      <code class="bp">False</code>  <code class="bp">False</code>  <code class="bp">False</code>  <code class="bp">False</code>  <code class="bp">False</code>     <code class="bp">True</code>
<code class="mi">1</code>      <code class="bp">False</code>  <code class="bp">False</code>  <code class="bp">False</code>   <code class="bp">True</code>  <code class="bp">False</code>    <code class="bp">False</code>
<code class="mi">2</code>      <code class="bp">False</code>  <code class="bp">False</code>  <code class="bp">False</code>  <code class="bp">False</code>  <code class="bp">False</code>    <code class="bp">False</code></pre><p>The <code>na_values</code> option can take
    either a list or set of strings to consider missing <span class="keep-together">values</span>:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">29</code><code class="p">]:</code> <code class="n">result</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'examples/ex5.csv'</code><code class="p">,</code> <code class="n">na_values</code><code class="o">=</code><code class="p">[</code><code class="s1">'NULL'</code><code class="p">])</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">30</code><code class="p">]:</code> <code class="n">result</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">30</code><code class="p">]:</code> 
  <code class="n">something</code>  <code class="n">a</code>   <code class="n">b</code>     <code class="n">c</code>   <code class="n">d</code> <code class="n">message</code>
<code class="mi">0</code>       <code class="n">one</code>  <code class="mi">1</code>   <code class="mi">2</code>   <code class="mf">3.0</code>   <code class="mi">4</code>     <code class="n">NaN</code>
<code class="mi">1</code>       <code class="n">two</code>  <code class="mi">5</code>   <code class="mi">6</code>   <code class="n">NaN</code>   <code class="mi">8</code>   <code class="n">world</code>
<code class="mi">2</code>     <code class="n">three</code>  <code class="mi">9</code>  <code class="mi">10</code>  <code class="mf">11.0</code>  <code class="mi">12</code>     <code class="n">foo</code></pre><p>Different NA sentinels can be specified for each column in a
    dict:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">31</code><code class="p">]:</code> <code class="n">sentinels</code> <code class="o">=</code> <code class="p">{</code><code class="s1">'message'</code><code class="p">:</code> <code class="p">[</code><code class="s1">'foo'</code><code class="p">,</code> <code class="s1">'NA'</code><code class="p">],</code> <code class="s1">'something'</code><code class="p">:</code> <code class="p">[</code><code class="s1">'two'</code><code class="p">]}</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">32</code><code class="p">]:</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'examples/ex5.csv'</code><code class="p">,</code> <code class="n">na_values</code><code class="o">=</code><code class="n">sentinels</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">32</code><code class="p">]:</code> 
  <code class="n">something</code>  <code class="n">a</code>   <code class="n">b</code>     <code class="n">c</code>   <code class="n">d</code> <code class="n">message</code>
<code class="mi">0</code>       <code class="n">one</code>  <code class="mi">1</code>   <code class="mi">2</code>   <code class="mf">3.0</code>   <code class="mi">4</code>     <code class="n">NaN</code>
<code class="mi">1</code>       <code class="n">NaN</code>  <code class="mi">5</code>   <code class="mi">6</code>   <code class="n">NaN</code>   <code class="mi">8</code>   <code class="n">world</code>
<code class="mi">2</code>     <code class="n">three</code>  <code class="mi">9</code>  <code class="mi">10</code>  <code class="mf">11.0</code>  <code class="mi">12</code>     <code class="n">NaN</code></pre><p><a data-type="xref" href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#table_read_csv_function">Table&nbsp;6-2</a> lists some frequently
    used options in <code>pandas.read_csv</code> and
    <code>pandas.read_table</code>.</p><table id="table_read_csv_function"><caption><span class="label">Table 6-2. </span>Some read_csv/read_table function arguments</caption><thead><tr><th>Argument</th><th>Description</th></tr></thead><tbody><tr><td><code>path</code></td><td>String <a data-type="indexterm" data-primary="read_csv function" id="idm140621946626608"></a><a data-type="indexterm" data-primary="read_table function" id="idm140621946625744"></a>indicating filesystem location, URL, or file-like
            object</td></tr><tr><td><code>sep</code> or <code>delimiter</code></td><td>Character sequence or regular expression to use to split
            fields in each row</td></tr><tr><td><code>header</code></td><td>Row number to use as column names; defaults to 0 (first
            row), but should be <code>None</code> if
            there is no header row</td></tr><tr><td><code>index_col</code></td><td>Column numbers or names to use as the row index in the
            result; can be a single name/number or a list of them for a
            hierarchical index</td></tr><tr><td><code>names</code></td><td>List of column names for result, combine with <code>header=None</code></td></tr><tr><td><code>skiprows</code></td><td>Number of rows at beginning of file to ignore or list of
            row numbers (starting from 0) to skip.</td></tr><tr><td><code>na_values</code></td><td>Sequence of values to replace with NA.</td></tr><tr><td><code>comment</code></td><td>Character(s) to split comments off the end of lines.</td></tr><tr><td><code>parse_dates</code></td><td>Attempt to parse data to <code>datetime</code>; <code>False</code> by default. If
              <code>True</code>, will attempt to parse all columns. Otherwise can specify a
            list of column numbers or name to parse. If element of list is
            tuple or list, will combine multiple columns together and parse to
            date (e.g., if date/time split across two columns).</td></tr><tr><td><code>keep_date_col</code></td><td>If joining columns to parse date, keep the joined columns;
              <code>False</code> by default.</td></tr><tr><td><code>converters</code></td><td>Dict containing column number of name mapping to functions
            (e.g., <code>{'foo': f}</code> would apply
            the function <code>f</code> to all values in
            the <code>'foo'</code> column).</td></tr><tr><td><code>dayfirst</code></td><td>When parsing potentially ambiguous dates, treat as
              international format (e.g., 7/6/2012 -&gt; June 7, 2012); <code>False</code> by
            default.</td></tr><tr><td><code>date_parser</code></td><td>Function to use to parse dates.</td></tr><tr><td><code>nrows</code></td><td>Number of rows to read from beginning of file.</td></tr><tr><td><code>iterator</code></td><td>Return a <code>TextParser</code> object for reading file
            piecemeal.</td></tr><tr><td><code>chunksize</code></td><td>For iteration, size of file chunks.</td></tr><tr><td><code>skip_footer</code></td><td>Number of lines to ignore at end of file.</td></tr><tr><td><code>verbose</code></td><td>Print various parser output information, like the number of
            missing values placed in non-numeric columns.</td></tr><tr><td><code>encoding</code></td><td>Text encoding for Unicode (e.g., <code>'utf-8'</code> for UTF-8 encoded text).</td></tr><tr><td><code>squeeze</code></td><td>If the parsed data only contains one column, return a
            Series.</td></tr><tr><td><code>thousands</code></td><td>Separator for thousands (e.g., <code>','</code> or <code>'.'</code>).</td></tr></tbody></table><section data-type="sect2" data-pdf-bookmark="Reading Text Files in Pieces"><div class="sect2" id="pandas_file_chunking"><h2>Reading Text Files in Pieces</h2><p>When processing very large files or figuring out the right set of
      arguments to correctly process a large file, you may only want to read
      in a small piece of a file or iterate through smaller chunks of the
      file.</p><p>Before we look at a large file, we make the pandas display
      settings more compact:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">33</code><code class="p">]:</code> <code class="n">pd</code><code class="o">.</code><code class="n">options</code><code class="o">.</code><code class="n">display</code><code class="o">.</code><code class="n">max_rows</code> <code class="o">=</code> <code class="mi">10</code></pre><p>Now we have:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">34</code><code class="p">]:</code> <code class="n">result</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'examples/ex6.csv'</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">35</code><code class="p">]:</code> <code class="n">result</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">35</code><code class="p">]:</code> 
           <code class="n">one</code>       <code class="n">two</code>     <code class="n">three</code>      <code class="n">four</code> <code class="n">key</code>
<code class="mi">0</code>     <code class="mf">0.467976</code> <code class="o">-</code><code class="mf">0.038649</code> <code class="o">-</code><code class="mf">0.295344</code> <code class="o">-</code><code class="mf">1.824726</code>   <code class="n">L</code>
<code class="mi">1</code>    <code class="o">-</code><code class="mf">0.358893</code>  <code class="mf">1.404453</code>  <code class="mf">0.704965</code> <code class="o">-</code><code class="mf">0.200638</code>   <code class="n">B</code>
<code class="mi">2</code>    <code class="o">-</code><code class="mf">0.501840</code>  <code class="mf">0.659254</code> <code class="o">-</code><code class="mf">0.421691</code> <code class="o">-</code><code class="mf">0.057688</code>   <code class="n">G</code>
<code class="mi">3</code>     <code class="mf">0.204886</code>  <code class="mf">1.074134</code>  <code class="mf">1.388361</code> <code class="o">-</code><code class="mf">0.982404</code>   <code class="n">R</code>
<code class="mi">4</code>     <code class="mf">0.354628</code> <code class="o">-</code><code class="mf">0.133116</code>  <code class="mf">0.283763</code> <code class="o">-</code><code class="mf">0.837063</code>   <code class="n">Q</code>
<code class="o">...</code>        <code class="o">...</code>       <code class="o">...</code>       <code class="o">...</code>       <code class="o">...</code>  <code class="o">..</code>
<code class="mi">9995</code>  <code class="mf">2.311896</code> <code class="o">-</code><code class="mf">0.417070</code> <code class="o">-</code><code class="mf">1.409599</code> <code class="o">-</code><code class="mf">0.515821</code>   <code class="n">L</code>
<code class="mi">9996</code> <code class="o">-</code><code class="mf">0.479893</code> <code class="o">-</code><code class="mf">0.650419</code>  <code class="mf">0.745152</code> <code class="o">-</code><code class="mf">0.646038</code>   <code class="n">E</code>
<code class="mi">9997</code>  <code class="mf">0.523331</code>  <code class="mf">0.787112</code>  <code class="mf">0.486066</code>  <code class="mf">1.093156</code>   <code class="n">K</code>
<code class="mi">9998</code> <code class="o">-</code><code class="mf">0.362559</code>  <code class="mf">0.598894</code> <code class="o">-</code><code class="mf">1.843201</code>  <code class="mf">0.887292</code>   <code class="n">G</code>
<code class="mi">9999</code> <code class="o">-</code><code class="mf">0.096376</code> <code class="o">-</code><code class="mf">1.012999</code> <code class="o">-</code><code class="mf">0.657431</code> <code class="o">-</code><code class="mf">0.573315</code>   <code class="mi">0</code>
<code class="p">[</code><code class="mi">10000</code> <code class="n">rows</code> <code class="n">x</code> <code class="mi">5</code> <code class="n">columns</code><code class="p">]</code></pre><p>If you want to only read a small number of rows (avoiding reading
      the entire file), specify that with <code>nrows</code>:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">36</code><code class="p">]:</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'examples/ex6.csv'</code><code class="p">,</code> <code class="n">nrows</code><code class="o">=</code><code class="mi">5</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">36</code><code class="p">]:</code> 
        <code class="n">one</code>       <code class="n">two</code>     <code class="n">three</code>      <code class="n">four</code> <code class="n">key</code>
<code class="mi">0</code>  <code class="mf">0.467976</code> <code class="o">-</code><code class="mf">0.038649</code> <code class="o">-</code><code class="mf">0.295344</code> <code class="o">-</code><code class="mf">1.824726</code>   <code class="n">L</code>
<code class="mi">1</code> <code class="o">-</code><code class="mf">0.358893</code>  <code class="mf">1.404453</code>  <code class="mf">0.704965</code> <code class="o">-</code><code class="mf">0.200638</code>   <code class="n">B</code>
<code class="mi">2</code> <code class="o">-</code><code class="mf">0.501840</code>  <code class="mf">0.659254</code> <code class="o">-</code><code class="mf">0.421691</code> <code class="o">-</code><code class="mf">0.057688</code>   <code class="n">G</code>
<code class="mi">3</code>  <code class="mf">0.204886</code>  <code class="mf">1.074134</code>  <code class="mf">1.388361</code> <code class="o">-</code><code class="mf">0.982404</code>   <code class="n">R</code>
<code class="mi">4</code>  <code class="mf">0.354628</code> <code class="o">-</code><code class="mf">0.133116</code>  <code class="mf">0.283763</code> <code class="o">-</code><code class="mf">0.837063</code>   <code class="n">Q</code></pre><p>To read a file in pieces, specify a <code>chunksize</code> as a number of rows:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">37</code><code class="p">]:</code> <code class="n">chunker</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'examples/ex6.csv'</code><code class="p">,</code> <code class="n">chunksize</code><code class="o">=</code><code class="mi">1000</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">38</code><code class="p">]:</code> <code class="n">chunker</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">38</code><code class="p">]:</code> <code class="o">&lt;</code><code class="n">pandas</code><code class="o">.</code><code class="n">io</code><code class="o">.</code><code class="n">parsers</code><code class="o">.</code><code class="n">TextFileReader</code> <code class="n">at</code> <code class="mh">0x7fb741fe7160</code><code class="o">&gt;</code></pre><p>The <code>TextParser</code> object
      <a data-type="indexterm" data-primary="TextParser class" id="idm140621946011200"></a>returned by <code>read_csv</code>
      allows you to iterate over the parts of the file according to the
      <code>chunksize</code>. For example, we can
      iterate over <code>ex6.csv</code>, aggregating the
      value counts in the <code>'key'</code> column like
      so:</p><pre data-type="programlisting" data-code-language="python"><code class="n">chunker</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'examples/ex6.csv'</code><code class="p">,</code> <code class="n">chunksize</code><code class="o">=</code><code class="mi">1000</code><code class="p">)</code>

<code class="n">tot</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">Series</code><code class="p">([])</code>
<code class="k">for</code> <code class="n">piece</code> <code class="ow">in</code> <code class="n">chunker</code><code class="p">:</code>
    <code class="n">tot</code> <code class="o">=</code> <code class="n">tot</code><code class="o">.</code><code class="n">add</code><code class="p">(</code><code class="n">piece</code><code class="p">[</code><code class="s1">'key'</code><code class="p">]</code><code class="o">.</code><code class="n">value_counts</code><code class="p">(),</code> <code class="n">fill_value</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code>

<code class="n">tot</code> <code class="o">=</code> <code class="n">tot</code><code class="o">.</code><code class="n">sort_values</code><code class="p">(</code><code class="n">ascending</code><code class="o">=</code><code class="bp">False</code><code class="p">)</code></pre><p>We have then:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">40</code><code class="p">]:</code> <code class="n">tot</code><code class="p">[:</code><code class="mi">10</code><code class="p">]</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">40</code><code class="p">]:</code> 
<code class="n">E</code>    <code class="mf">368.0</code>
<code class="n">X</code>    <code class="mf">364.0</code>
<code class="n">L</code>    <code class="mf">346.0</code>
<code class="n">O</code>    <code class="mf">343.0</code>
<code class="n">Q</code>    <code class="mf">340.0</code>
<code class="n">M</code>    <code class="mf">338.0</code>
<code class="n">J</code>    <code class="mf">337.0</code>
<code class="n">F</code>    <code class="mf">335.0</code>
<code class="n">K</code>    <code class="mf">334.0</code>
<code class="n">H</code>    <code class="mf">330.0</code>
<code class="n">dtype</code><code class="p">:</code> <code class="n">float64</code></pre><p><code>TextParser</code> is also equipped
      with a <code>get_chunk</code> method <a data-type="indexterm" data-primary="get_chunk method" id="idm140621945932912"></a>that enables you to read pieces of an <a data-type="indexterm" data-primary="" data-startref="tfr6.1" id="idm140621945932048"></a><a data-type="indexterm" data-primary="" data-startref="rd6.1" id="idm140621945930944"></a>arbitrary size.</p></div></section><section data-type="sect2" data-pdf-bookmark="Writing Data to Text Format"><div class="sect2" id="pandas_text_writing"><h2>Writing Data to Text Format</h2><p>Data can also be <a data-type="indexterm" data-primary="CSV files" id="cf6.1.2"></a>exported to a delimited format. Let’s consider one of the
      CSV files read before:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">41</code><code class="p">]:</code> <code class="n">data</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'examples/ex5.csv'</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">42</code><code class="p">]:</code> <code class="n">data</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">42</code><code class="p">]:</code> 
  <code class="n">something</code>  <code class="n">a</code>   <code class="n">b</code>     <code class="n">c</code>   <code class="n">d</code> <code class="n">message</code>
<code class="mi">0</code>       <code class="n">one</code>  <code class="mi">1</code>   <code class="mi">2</code>   <code class="mf">3.0</code>   <code class="mi">4</code>     <code class="n">NaN</code>
<code class="mi">1</code>       <code class="n">two</code>  <code class="mi">5</code>   <code class="mi">6</code>   <code class="n">NaN</code>   <code class="mi">8</code>   <code class="n">world</code>
<code class="mi">2</code>     <code class="n">three</code>  <code class="mi">9</code>  <code class="mi">10</code>  <code class="mf">11.0</code>  <code class="mi">12</code>     <code class="n">foo</code></pre><p>Using DataFrame’s <code>to_csv</code>
      method, <a data-type="indexterm" data-primary="to_csv method" id="idm140621945798752"></a>we can write the data out to a comma-separated
      file:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">43</code><code class="p">]:</code> <code class="n">data</code><code class="o">.</code><code class="n">to_csv</code><code class="p">(</code><code class="s1">'examples/out.csv'</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">44</code><code class="p">]:</code> <code class="err">!</code><code class="n">cat</code> <code class="n">examples</code><code class="o">/</code><code class="n">out</code><code class="o">.</code><code class="n">csv</code>
<code class="p">,</code><code class="n">something</code><code class="p">,</code><code class="n">a</code><code class="p">,</code><code class="n">b</code><code class="p">,</code><code class="n">c</code><code class="p">,</code><code class="n">d</code><code class="p">,</code><code class="n">message</code>
<code class="mi">0</code><code class="p">,</code><code class="n">one</code><code class="p">,</code><code class="mi">1</code><code class="p">,</code><code class="mi">2</code><code class="p">,</code><code class="mf">3.0</code><code class="p">,</code><code class="mi">4</code><code class="p">,</code>
<code class="mi">1</code><code class="p">,</code><code class="n">two</code><code class="p">,</code><code class="mi">5</code><code class="p">,</code><code class="mi">6</code><code class="p">,,</code><code class="mi">8</code><code class="p">,</code><code class="n">world</code>
<code class="mi">2</code><code class="p">,</code><code class="n">three</code><code class="p">,</code><code class="mi">9</code><code class="p">,</code><code class="mi">10</code><code class="p">,</code><code class="mf">11.0</code><code class="p">,</code><code class="mi">12</code><code class="p">,</code><code class="n">foo</code></pre><p>Other delimiters can be used, of course (writing <a data-type="indexterm" data-primary="sys module" id="idm140621945830912"></a>to <code>sys.stdout</code> so it
      prints the text result to the console):</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">45</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">sys</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">46</code><code class="p">]:</code> <code class="n">data</code><code class="o">.</code><code class="n">to_csv</code><code class="p">(</code><code class="n">sys</code><code class="o">.</code><code class="n">stdout</code><code class="p">,</code> <code class="n">sep</code><code class="o">=</code><code class="s1">'|'</code><code class="p">)</code>
<code class="o">|</code><code class="n">something</code><code class="o">|</code><code class="n">a</code><code class="o">|</code><code class="n">b</code><code class="o">|</code><code class="n">c</code><code class="o">|</code><code class="n">d</code><code class="o">|</code><code class="n">message</code>
<code class="mi">0</code><code class="o">|</code><code class="n">one</code><code class="o">|</code><code class="mi">1</code><code class="o">|</code><code class="mi">2</code><code class="o">|</code><code class="mf">3.0</code><code class="o">|</code><code class="mi">4</code><code class="o">|</code>
<code class="mi">1</code><code class="o">|</code><code class="n">two</code><code class="o">|</code><code class="mi">5</code><code class="o">|</code><code class="mi">6</code><code class="o">||</code><code class="mi">8</code><code class="o">|</code><code class="n">world</code>
<code class="mi">2</code><code class="o">|</code><code class="n">three</code><code class="o">|</code><code class="mi">9</code><code class="o">|</code><code class="mi">10</code><code class="o">|</code><code class="mf">11.0</code><code class="o">|</code><code class="mi">12</code><code class="o">|</code><code class="n">foo</code></pre><p>Missing values appear as empty strings in the output. You might
      want to denote them by some other sentinel value:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">47</code><code class="p">]:</code> <code class="n">data</code><code class="o">.</code><code class="n">to_csv</code><code class="p">(</code><code class="n">sys</code><code class="o">.</code><code class="n">stdout</code><code class="p">,</code> <code class="n">na_rep</code><code class="o">=</code><code class="s1">'NULL'</code><code class="p">)</code>
<code class="p">,</code><code class="n">something</code><code class="p">,</code><code class="n">a</code><code class="p">,</code><code class="n">b</code><code class="p">,</code><code class="n">c</code><code class="p">,</code><code class="n">d</code><code class="p">,</code><code class="n">message</code>
<code class="mi">0</code><code class="p">,</code><code class="n">one</code><code class="p">,</code><code class="mi">1</code><code class="p">,</code><code class="mi">2</code><code class="p">,</code><code class="mf">3.0</code><code class="p">,</code><code class="mi">4</code><code class="p">,</code><code class="n">NULL</code>
<code class="mi">1</code><code class="p">,</code><code class="n">two</code><code class="p">,</code><code class="mi">5</code><code class="p">,</code><code class="mi">6</code><code class="p">,</code><code class="n">NULL</code><code class="p">,</code><code class="mi">8</code><code class="p">,</code><code class="n">world</code>
<code class="mi">2</code><code class="p">,</code><code class="n">three</code><code class="p">,</code><code class="mi">9</code><code class="p">,</code><code class="mi">10</code><code class="p">,</code><code class="mf">11.0</code><code class="p">,</code><code class="mi">12</code><code class="p">,</code><code class="n">foo</code></pre><p>With no other options specified, both the row and column labels
      are written. Both of these can be disabled:</p><pre class="pagebreak-before" data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">48</code><code class="p">]:</code> <code class="n">data</code><code class="o">.</code><code class="n">to_csv</code><code class="p">(</code><code class="n">sys</code><code class="o">.</code><code class="n">stdout</code><code class="p">,</code> <code class="n">index</code><code class="o">=</code><code class="bp">False</code><code class="p">,</code> <code class="n">header</code><code class="o">=</code><code class="bp">False</code><code class="p">)</code>
<code class="n">one</code><code class="p">,</code><code class="mi">1</code><code class="p">,</code><code class="mi">2</code><code class="p">,</code><code class="mf">3.0</code><code class="p">,</code><code class="mi">4</code><code class="p">,</code>
<code class="n">two</code><code class="p">,</code><code class="mi">5</code><code class="p">,</code><code class="mi">6</code><code class="p">,,</code><code class="mi">8</code><code class="p">,</code><code class="n">world</code>
<code class="n">three</code><code class="p">,</code><code class="mi">9</code><code class="p">,</code><code class="mi">10</code><code class="p">,</code><code class="mf">11.0</code><code class="p">,</code><code class="mi">12</code><code class="p">,</code><code class="n">foo</code></pre><p>You can also write only a subset of the columns, and in an order
      of your choosing:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">49</code><code class="p">]:</code> <code class="n">data</code><code class="o">.</code><code class="n">to_csv</code><code class="p">(</code><code class="n">sys</code><code class="o">.</code><code class="n">stdout</code><code class="p">,</code> <code class="n">index</code><code class="o">=</code><code class="bp">False</code><code class="p">,</code> <code class="n">columns</code><code class="o">=</code><code class="p">[</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">])</code>
<code class="n">a</code><code class="p">,</code><code class="n">b</code><code class="p">,</code><code class="n">c</code>
<code class="mi">1</code><code class="p">,</code><code class="mi">2</code><code class="p">,</code><code class="mf">3.0</code>
<code class="mi">5</code><code class="p">,</code><code class="mi">6</code><code class="p">,</code>
<code class="mi">9</code><code class="p">,</code><code class="mi">10</code><code class="p">,</code><code class="mf">11.0</code></pre><p>Series also has <a data-type="indexterm" data-primary="" data-startref="tfw6.1" id="idm140621945459504"></a><a data-type="indexterm" data-primary="" data-startref="wd6.1" id="idm140621945297696"></a><a data-type="indexterm" data-primary="" data-startref="fm6.1" id="idm140621945296656"></a><a data-type="indexterm" data-primary="" data-startref="pl6.1" id="idm140621945295552"></a>a <code>to_csv</code> method:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">50</code><code class="p">]:</code> <code class="n">dates</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">date_range</code><code class="p">(</code><code class="s1">'1/1/2000'</code><code class="p">,</code> <code class="n">periods</code><code class="o">=</code><code class="mi">7</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">51</code><code class="p">]:</code> <code class="n">ts</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">Series</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">arange</code><code class="p">(</code><code class="mi">7</code><code class="p">),</code> <code class="n">index</code><code class="o">=</code><code class="n">dates</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">52</code><code class="p">]:</code> <code class="n">ts</code><code class="o">.</code><code class="n">to_csv</code><code class="p">(</code><code class="s1">'examples/tseries.csv'</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">53</code><code class="p">]:</code> <code class="err">!</code><code class="n">cat</code> <code class="n">examples</code><code class="o">/</code><code class="n">tseries</code><code class="o">.</code><code class="n">csv</code>
<code class="mi">2000</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">01</code><code class="p">,</code><code class="mi">0</code>
<code class="mi">2000</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">02</code><code class="p">,</code><code class="mi">1</code>
<code class="mi">2000</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">03</code><code class="p">,</code><code class="mi">2</code>
<code class="mi">2000</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">04</code><code class="p">,</code><code class="mi">3</code>
<code class="mi">2000</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">05</code><code class="p">,</code><code class="mi">4</code>
<code class="mi">2000</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">06</code><code class="p">,</code><code class="mi">5</code>
<code class="mi">2000</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">07</code><code class="p">,</code><code class="mi">6</code></pre><p></p></div></section><section data-type="sect2" data-pdf-bookmark="Working with Delimited Formats"><div class="sect2" id="io_file_formats_csv"><h2>Working with Delimited Formats</h2><p>It’s possible to <a data-type="indexterm" data-primary="file management" data-secondary="working with delimited formats" id="fm6.1.3"></a><a data-type="indexterm" data-primary="pandas library" data-secondary="working with delimited formats" id="pl6.1.3"></a><a data-type="indexterm" data-primary="delimited formats, working with" id="df6.1.3"></a><a data-type="indexterm" data-primary="data wrangling" data-secondary="working with delimited formats" id="dw6.1.3"></a>load most forms of tabular data from disk using functions
      like <code>pandas.read_table</code>. In some
      cases, however, some manual processing may be necessary. It’s not
      uncommon to receive a file with one or more malformed lines that trip
      <a data-type="indexterm" data-primary="read_table function" id="idm140621945243680"></a>up <code>read_table</code>. To
      illustrate the basic tools, consider a small CSV file:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">54</code><code class="p">]:</code> <code class="err">!</code><code class="n">cat</code> <code class="n">examples</code><code class="o">/</code><code class="n">ex7</code><code class="o">.</code><code class="n">csv</code>
<code class="s2">"a"</code><code class="p">,</code><code class="s2">"b"</code><code class="p">,</code><code class="s2">"c"</code>
<code class="s2">"1"</code><code class="p">,</code><code class="s2">"2"</code><code class="p">,</code><code class="s2">"3"</code>
<code class="s2">"1"</code><code class="p">,</code><code class="s2">"2"</code><code class="p">,</code><code class="s2">"3"</code></pre><p>For any file with a single-character delimiter, you can use
      Python’s <a data-type="indexterm" data-primary="csv module" id="idm140621945240960"></a>built-in <code>csv</code> module. To
      use it, pass any open file or file-like object to <code>csv.reader</code>:</p><pre data-type="programlisting" data-code-language="python"><code class="kn">import</code> <code class="nn">csv</code>
<code class="n">f</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s1">'examples/ex7.csv'</code><code class="p">)</code>

<code class="n">reader</code> <code class="o">=</code> <code class="n">csv</code><code class="o">.</code><code class="n">reader</code><code class="p">(</code><code class="n">f</code><code class="p">)</code></pre><p>Iterating through the reader like a file yields tuples of values
      with any quote characters removed:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">56</code><code class="p">]:</code> <code class="k">for</code> <code class="n">line</code> <code class="ow">in</code> <code class="n">reader</code><code class="p">:</code>
   <code class="o">....</code><code class="p">:</code>     <code class="k">print</code><code class="p">(</code><code class="n">line</code><code class="p">)</code>
<code class="p">[</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">]</code>
<code class="p">[</code><code class="s1">'1'</code><code class="p">,</code> <code class="s1">'2'</code><code class="p">,</code> <code class="s1">'3'</code><code class="p">]</code>
<code class="p">[</code><code class="s1">'1'</code><code class="p">,</code> <code class="s1">'2'</code><code class="p">,</code> <code class="s1">'3'</code><code class="p">]</code></pre><p>From there, it’s up to you to do the wrangling necessary to put
      the data in the form that you need it. Let’s take this step by step.
      First, we read the file into a list of lines:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">57</code><code class="p">]:</code> <code class="k">with</code> <code class="nb">open</code><code class="p">(</code><code class="s1">'examples/ex7.csv'</code><code class="p">)</code> <code class="k">as</code> <code class="n">f</code><code class="p">:</code>
   <code class="o">....</code><code class="p">:</code>     <code class="n">lines</code> <code class="o">=</code> <code class="nb">list</code><code class="p">(</code><code class="n">csv</code><code class="o">.</code><code class="n">reader</code><code class="p">(</code><code class="n">f</code><code class="p">))</code></pre><p>Then, we split the lines into the header line and the data
      lines:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">58</code><code class="p">]:</code> <code class="n">header</code><code class="p">,</code> <code class="n">values</code> <code class="o">=</code> <code class="n">lines</code><code class="p">[</code><code class="mi">0</code><code class="p">],</code> <code class="n">lines</code><code class="p">[</code><code class="mi">1</code><code class="p">:]</code></pre><p>Then we can create a dictionary of data columns using a dictionary
      comprehension and the expression <code>zip(*values)</code>, which
      transposes rows to columns:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">59</code><code class="p">]:</code> <code class="n">data_dict</code> <code class="o">=</code> <code class="p">{</code><code class="n">h</code><code class="p">:</code> <code class="n">v</code> <code class="k">for</code> <code class="n">h</code><code class="p">,</code> <code class="n">v</code> <code class="ow">in</code> <code class="nb">zip</code><code class="p">(</code><code class="n">header</code><code class="p">,</code> <code class="nb">zip</code><code class="p">(</code><code class="o">*</code><code class="n">values</code><code class="p">))}</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">60</code><code class="p">]:</code> <code class="n">data_dict</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">60</code><code class="p">]:</code> <code class="p">{</code><code class="s1">'a'</code><code class="p">:</code> <code class="p">(</code><code class="s1">'1'</code><code class="p">,</code> <code class="s1">'1'</code><code class="p">),</code> <code class="s1">'b'</code><code class="p">:</code> <code class="p">(</code><code class="s1">'2'</code><code class="p">,</code> <code class="s1">'2'</code><code class="p">),</code> <code class="s1">'c'</code><code class="p">:</code> <code class="p">(</code><code class="s1">'3'</code><code class="p">,</code> <code class="s1">'3'</code><code class="p">)}</code></pre><p>CSV files come in many different flavors. To define a new format
      with a different delimiter, string quoting convention, or line
      terminator, we define a simple subclass of <code>csv.Dialect</code>:</p><pre data-type="programlisting" data-code-language="python"><code class="k">class</code> <code class="nc">my_dialect</code><code class="p">(</code><code class="n">csv</code><code class="o">.</code><code class="n">Dialect</code><code class="p">):</code>
    <code class="n">lineterminator</code> <code class="o">=</code> <code class="s1">'</code><code class="se">\n</code><code class="s1">'</code>
    <code class="n">delimiter</code> <code class="o">=</code> <code class="s1">';'</code>
    <code class="n">quotechar</code> <code class="o">=</code> <code class="s1">'"'</code>
    <code class="n">quoting</code> <code class="o">=</code> <code class="n">csv</code><code class="o">.</code><code class="n">QUOTE_MINIMAL</code></pre><pre data-type="programlisting" data-code-language="python"><code class="n">reader</code> <code class="o">=</code> <code class="n">csv</code><code class="o">.</code><code class="n">reader</code><code class="p">(</code><code class="n">f</code><code class="p">,</code> <code class="n">dialect</code><code class="o">=</code><code class="n">my_dialect</code><code class="p">)</code></pre><p>We can also give individual CSV dialect parameters as keywords to
      <code>csv.reader</code> without having to define a
      subclass:</p><pre data-type="programlisting" data-code-language="python"><code class="n">reader</code> <code class="o">=</code> <code class="n">csv</code><code class="o">.</code><code class="n">reader</code><code class="p">(</code><code class="n">f</code><code class="p">,</code> <code class="n">delimiter</code><code class="o">=</code><code class="s1">'|'</code><code class="p">)</code></pre><p>The possible options (attributes of <code>csv.Dialect</code>) and what <a data-type="indexterm" data-primary="Dialect class" id="idm140621944839760"></a>they do can be found in <a data-type="xref" href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#table_csv_dialect">Table&nbsp;6-3</a>.</p><table id="table_csv_dialect"><caption><span class="label">Table 6-3. </span>CSV dialect options</caption><thead><tr><th>Argument</th><th>Description</th></tr></thead><tbody><tr><td><code>delimiter</code></td><td>One-character string to separate fields; defaults to
              <code>','</code>.</td></tr><tr><td><span class="keep-together"><code>lineterminator</code></span></td><td>Line terminator for writing; defaults to <code>'\r\n'</code>. Reader ignores this and
              recognizes cross-platform line terminators.</td></tr><tr><td><code>quotechar</code></td><td>Quote character for fields with special characters (like
              a delimiter); default is <code>'"'</code>.</td></tr><tr><td><code>quoting</code></td><td>Quoting convention. Options include <code>csv.QUOTE_ALL</code> (quote all fields),
              <code>csv.QUOTE_MINIMAL</code> (only
              fields with special characters like the delimiter), <code>csv.QUOTE_NONNUMERIC</code>, and <code>csv.QUOTE_NONE</code> (no quoting). See
              Python’s documentation for full details. Defaults to <code>QUOTE_MINIMAL</code>.</td></tr><tr><td><code>skipinitialspace</code></td><td>Ignore whitespace after each delimiter; default is
              <code>False</code>.</td></tr><tr><td><code>doublequote</code></td><td>How to handle quoting character inside a field; if
              <code>True</code>, it is doubled (see
              online documentation for full detail and behavior).</td></tr><tr><td><code>escapechar</code></td><td>String to escape the delimiter if <code>quoting</code> is set to <code>csv.QUOTE_NONE</code>; disabled by
              default.</td></tr></tbody></table><div data-type="note" epub:type="note"><h6>Note</h6><p>For files with more complicated or fixed multicharacter
        delimiters, you will not be able to use the <code>csv</code> module. In those cases, you’ll have to
        do the line splitting and other cleanup using string’s <code>split</code> method <a data-type="indexterm" data-primary="split method" id="idm140621944816448"></a>or the regular expression method <code>re.split</code>.</p></div><p>To <em>write</em> delimited files manually, you can
      use <code>csv.writer</code>. It accepts an open,
      writable file object and the same dialect and format options <a data-type="indexterm" data-primary="" data-startref="dw6.1.3" id="idm140621944813536"></a><a data-type="indexterm" data-primary="" data-startref="df6.1.3" id="idm140621944812432"></a><a data-type="indexterm" data-primary="" data-startref="fm6.1.3" id="idm140621944811328"></a><a data-type="indexterm" data-primary="" data-startref="pl6.1.3" id="idm140621944810224"></a><a data-type="indexterm" data-primary="" data-startref="cf6.1.2" id="idm140621944809120"></a>as <code>csv.reader</code>:</p><pre data-type="programlisting" data-code-language="python"><code class="k">with</code> <code class="nb">open</code><code class="p">(</code><code class="s1">'mydata.csv'</code><code class="p">,</code> <code class="s1">'w'</code><code class="p">)</code> <code class="k">as</code> <code class="n">f</code><code class="p">:</code>
    <code class="n">writer</code> <code class="o">=</code> <code class="n">csv</code><code class="o">.</code><code class="n">writer</code><code class="p">(</code><code class="n">f</code><code class="p">,</code> <code class="n">dialect</code><code class="o">=</code><code class="n">my_dialect</code><code class="p">)</code>
    <code class="n">writer</code><code class="o">.</code><code class="n">writerow</code><code class="p">((</code><code class="s1">'one'</code><code class="p">,</code> <code class="s1">'two'</code><code class="p">,</code> <code class="s1">'three'</code><code class="p">))</code>
    <code class="n">writer</code><code class="o">.</code><code class="n">writerow</code><code class="p">((</code><code class="s1">'1'</code><code class="p">,</code> <code class="s1">'2'</code><code class="p">,</code> <code class="s1">'3'</code><code class="p">))</code>
    <code class="n">writer</code><code class="o">.</code><code class="n">writerow</code><code class="p">((</code><code class="s1">'4'</code><code class="p">,</code> <code class="s1">'5'</code><code class="p">,</code> <code class="s1">'6'</code><code class="p">))</code>
    <code class="n">writer</code><code class="o">.</code><code class="n">writerow</code><code class="p">((</code><code class="s1">'7'</code><code class="p">,</code> <code class="s1">'8'</code><code class="p">,</code> <code class="s1">'9'</code><code class="p">))</code></pre></div></section><section data-type="sect2" data-pdf-bookmark="JSON Data"><div class="sect2" id="io_format_json"><h2>JSON Data</h2><p>JSON (short for JavaScript Object Notation) has <a data-type="indexterm" data-primary="file management" data-secondary="JSON data" id="fm6.1.4"></a><a data-type="indexterm" data-primary="pandas library" data-secondary="JSON data" id="pl6.1.4"></a><a data-type="indexterm" data-primary="JSON (JavaScript Object Notation)" id="js6.1.4"></a>become one of the standard formats for sending data by
      HTTP request between web browsers and other applications. It is a much
      more free-form data format than a tabular text form like CSV. Here is an
      example:</p><pre data-type="programlisting" data-code-language="python"><code class="n">obj</code> <code class="o">=</code> <code class="s2">"""</code>
<code class="s2">{"name": "Wes",</code>
<code class="s2"> "places_lived": ["United States", "Spain", "Germany"],</code>
<code class="s2"> "pet": null,</code>
<code class="s2"> "siblings": [{"name": "Scott", "age": 30, "pets": ["Zeus", "Zuko"]},</code>
<code class="s2">              {"name": "Katie", "age": 38,</code>
<code class="s2">               "pets": ["Sixes", "Stache", "Cisco"]}]</code>
<code class="s2">}</code>
<code class="s2">"""</code></pre><p>JSON is very nearly valid Python code with the exception of its
      <a data-type="indexterm" data-primary="null value" id="idm140621944515344"></a>null value <code>null</code> and
      some other nuances (such as disallowing trailing commas at the end of
      lists). The basic types are objects (dicts), arrays (lists), strings,
      numbers, booleans, and nulls. All of the keys in an object must be
      strings. There are several Python libraries for reading and writing JSON
      data. I’ll use <code>json</code> here, as it is
      built into the Python standard library. To convert a JSON string to
      Python form, <a data-type="indexterm" data-primary="loads function" id="idm140621944635104"></a>use <code>json.loads</code>:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">62</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">json</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">63</code><code class="p">]:</code> <code class="n">result</code> <code class="o">=</code> <code class="n">json</code><code class="o">.</code><code class="n">loads</code><code class="p">(</code><code class="n">obj</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">64</code><code class="p">]:</code> <code class="n">result</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">64</code><code class="p">]:</code> 
<code class="p">{</code><code class="s1">'name'</code><code class="p">:</code> <code class="s1">'Wes'</code><code class="p">,</code>
 <code class="s1">'pet'</code><code class="p">:</code> <code class="bp">None</code><code class="p">,</code>
 <code class="s1">'places_lived'</code><code class="p">:</code> <code class="p">[</code><code class="s1">'United States'</code><code class="p">,</code> <code class="s1">'Spain'</code><code class="p">,</code> <code class="s1">'Germany'</code><code class="p">],</code>
 <code class="s1">'siblings'</code><code class="p">:</code> <code class="p">[{</code><code class="s1">'age'</code><code class="p">:</code> <code class="mi">30</code><code class="p">,</code> <code class="s1">'name'</code><code class="p">:</code> <code class="s1">'Scott'</code><code class="p">,</code> <code class="s1">'pets'</code><code class="p">:</code> <code class="p">[</code><code class="s1">'Zeus'</code><code class="p">,</code> <code class="s1">'Zuko'</code><code class="p">]},</code>
  <code class="p">{</code><code class="s1">'age'</code><code class="p">:</code> <code class="mi">38</code><code class="p">,</code> <code class="s1">'name'</code><code class="p">:</code> <code class="s1">'Katie'</code><code class="p">,</code> <code class="s1">'pets'</code><code class="p">:</code> <code class="p">[</code><code class="s1">'Sixes'</code><code class="p">,</code> <code class="s1">'Stache'</code><code class="p">,</code> <code class="s1">'Cisco'</code><code class="p">]}]}</code></pre><p><code>json.dumps</code>, on the <a data-type="indexterm" data-primary="dumps function" id="idm140621944626016"></a>other hand, converts a Python object back to JSON:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">65</code><code class="p">]:</code> <code class="n">asjson</code> <code class="o">=</code> <code class="n">json</code><code class="o">.</code><code class="n">dumps</code><code class="p">(</code><code class="n">result</code><code class="p">)</code></pre><p>How you convert a JSON object or list of objects to a DataFrame or
      some other data structure for analysis will be up to you. Conveniently,
      you can pass a list of dicts (which were previously JSON objects) to the
      DataFrame constructor and select a subset of the data fields:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">66</code><code class="p">]:</code> <code class="n">siblings</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">result</code><code class="p">[</code><code class="s1">'siblings'</code><code class="p">],</code> <code class="n">columns</code><code class="o">=</code><code class="p">[</code><code class="s1">'name'</code><code class="p">,</code> <code class="s1">'age'</code><code class="p">])</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">67</code><code class="p">]:</code> <code class="n">siblings</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">67</code><code class="p">]:</code> 
    <code class="n">name</code>  <code class="n">age</code>
<code class="mi">0</code>  <code class="n">Scott</code>   <code class="mi">30</code>
<code class="mi">1</code>  <code class="n">Katie</code>   <code class="mi">38</code></pre><p>The <code>pandas.read_json</code> can <a data-type="indexterm" data-primary="read_json function" id="idm140621944470848"></a>automatically convert JSON datasets in specific
      arrangements into a Series or DataFrame. For example:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">68</code><code class="p">]:</code> <code class="err">!</code><code class="n">cat</code> <code class="n">examples</code><code class="o">/</code><code class="n">example</code><code class="o">.</code><code class="n">json</code>
<code class="p">[{</code><code class="s2">"a"</code><code class="p">:</code> <code class="mi">1</code><code class="p">,</code> <code class="s2">"b"</code><code class="p">:</code> <code class="mi">2</code><code class="p">,</code> <code class="s2">"c"</code><code class="p">:</code> <code class="mi">3</code><code class="p">},</code>
 <code class="p">{</code><code class="s2">"a"</code><code class="p">:</code> <code class="mi">4</code><code class="p">,</code> <code class="s2">"b"</code><code class="p">:</code> <code class="mi">5</code><code class="p">,</code> <code class="s2">"c"</code><code class="p">:</code> <code class="mi">6</code><code class="p">},</code>
 <code class="p">{</code><code class="s2">"a"</code><code class="p">:</code> <code class="mi">7</code><code class="p">,</code> <code class="s2">"b"</code><code class="p">:</code> <code class="mi">8</code><code class="p">,</code> <code class="s2">"c"</code><code class="p">:</code> <code class="mi">9</code><code class="p">}]</code></pre><p>The default options for <code>pandas.read_json</code> assume
      that each object in the JSON array is a row in the table:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">69</code><code class="p">]:</code> <code class="n">data</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_json</code><code class="p">(</code><code class="s1">'examples/example.json'</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">70</code><code class="p">]:</code> <code class="n">data</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">70</code><code class="p">]:</code> 
   <code class="n">a</code>  <code class="n">b</code>  <code class="n">c</code>
<code class="mi">0</code>  <code class="mi">1</code>  <code class="mi">2</code>  <code class="mi">3</code>
<code class="mi">1</code>  <code class="mi">4</code>  <code class="mi">5</code>  <code class="mi">6</code>
<code class="mi">2</code>  <code class="mi">7</code>  <code class="mi">8</code>  <code class="mi">9</code></pre><p>For an extended example of reading and manipulating JSON data
      (including nested records), see the USDA Food Database example in <a data-type="xref" href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch07.html#data-preparation">Chapter&nbsp;7</a>.</p><p>If you need to export data from pandas to JSON, one way is to use
      the <code>to_json</code> methods on <a data-type="indexterm" data-primary="to_json method" id="idm140621944198240"></a><a data-type="indexterm" data-primary="Series data structure" data-secondary="JSON data and" id="idm140621944197408"></a><a data-type="indexterm" data-primary="DataFrame data structure" data-secondary="JSON data and" id="idm140621944196304"></a>Series <a data-type="indexterm" data-primary="" data-startref="js6.1.4" id="idm140621944195104"></a><a data-type="indexterm" data-primary="" data-startref="fm6.1.4" id="idm140621944193968"></a><a data-type="indexterm" data-primary="" data-startref="pl6.1.4" id="idm140621944192864"></a>and DataFrame:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">71</code><code class="p">]:</code> <code class="k">print</code><code class="p">(</code><code class="n">data</code><code class="o">.</code><code class="n">to_json</code><code class="p">())</code>
<code class="p">{</code><code class="s2">"a"</code><code class="p">:{</code><code class="s2">"0"</code><code class="p">:</code><code class="mi">1</code><code class="p">,</code><code class="s2">"1"</code><code class="p">:</code><code class="mi">4</code><code class="p">,</code><code class="s2">"2"</code><code class="p">:</code><code class="mi">7</code><code class="p">},</code><code class="s2">"b"</code><code class="p">:{</code><code class="s2">"0"</code><code class="p">:</code><code class="mi">2</code><code class="p">,</code><code class="s2">"1"</code><code class="p">:</code><code class="mi">5</code><code class="p">,</code><code class="s2">"2"</code><code class="p">:</code><code class="mi">8</code><code class="p">},</code><code class="s2">"c"</code><code class="p">:{</code><code class="s2">"0"</code><code class="p">:</code><code class="mi">3</code><code class="p">,</code><code class="s2">"1"</code><code class="p">:</code><code class="mi">6</code><code class="p">,</code><code class="s2">"2"</code><code class="p">:</code><code class="mi">9</code><code class="p">}}</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">72</code><code class="p">]:</code> <code class="k">print</code><code class="p">(</code><code class="n">data</code><code class="o">.</code><code class="n">to_json</code><code class="p">(</code><code class="n">orient</code><code class="o">=</code><code class="s1">'records'</code><code class="p">))</code>
<code class="p">[{</code><code class="s2">"a"</code><code class="p">:</code><code class="mi">1</code><code class="p">,</code><code class="s2">"b"</code><code class="p">:</code><code class="mi">2</code><code class="p">,</code><code class="s2">"c"</code><code class="p">:</code><code class="mi">3</code><code class="p">},{</code><code class="s2">"a"</code><code class="p">:</code><code class="mi">4</code><code class="p">,</code><code class="s2">"b"</code><code class="p">:</code><code class="mi">5</code><code class="p">,</code><code class="s2">"c"</code><code class="p">:</code><code class="mi">6</code><code class="p">},{</code><code class="s2">"a"</code><code class="p">:</code><code class="mi">7</code><code class="p">,</code><code class="s2">"b"</code><code class="p">:</code><code class="mi">8</code><code class="p">,</code><code class="s2">"c"</code><code class="p">:</code><code class="mi">9</code><code class="p">}]</code></pre><p></p></div></section><section data-type="sect2" data-pdf-bookmark="XML and HTML: Web Scraping"><div class="sect2" id="io_file_formats_html_xml"><h2>XML and HTML: Web Scraping</h2><p>Python has many libraries for <a data-type="indexterm" data-primary="pandas library" data-secondary="Web scraping" id="pl6.1.5"></a><a data-type="indexterm" data-primary="file management" data-secondary="Web scraping" id="fm6.1.5"></a><a data-type="indexterm" data-primary="Web scraping" id="ws6.1.5"></a><a data-type="indexterm" data-primary="XML files" id="xf6.1.5"></a><a data-type="indexterm" data-primary="HTML files" id="hf6.1.5"></a>reading and writing data in the ubiquitous HTML and XML
      formats. Examples include <a href="http://lxml.de/">lxml</a>,
      Beautiful Soup, and html5lib. While <a data-type="indexterm" data-primary="lxml library" id="ll6.1.5"></a>lxml is comparatively much faster in general, the other
      libraries can better handle malformed HTML or XML files.</p><p>pandas has a built-in function, <code>read_html</code>,
      <a data-type="indexterm" data-primary="read_html function" id="rf6.1.5"></a>which uses libraries like lxml and Beautiful Soup to
      automatically parse tables out of HTML files as DataFrame objects. To
      show how this works, I downloaded an HTML file (used in the pandas
      documentation) from the United States <a data-type="indexterm" data-primary="FDIC bank failures list" id="idm140621944083872"></a>FDIC government agency showing bank failures.<sup><a data-type="noteref" id="idm140621944082912-marker" href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#idm140621944082912" class="totri-footnote">1</a></sup> First, you must install some additional libraries used by
      <code>read_html</code>:</p><pre data-type="programlisting">conda install lxml
pip install beautifulsoup4 html5lib</pre><p>If you are not using conda, <code>pip install lxml</code>
      will <a data-type="indexterm" data-primary="pip tool" id="idm140621944079792"></a><a data-type="indexterm" id="idm140621944078928"></a>likely also work.</p><p>The <code>pandas.read_html</code> function has a number of
      options, but by default it searches for and attempts to parse all
      tabular data contained within <code>&lt;table&gt;</code> tags. The
      result is a list of DataFrame objects:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">73</code><code class="p">]:</code> <code class="n">tables</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_html</code><code class="p">(</code><code class="s1">'examples/fdic_failed_bank_list.html'</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">74</code><code class="p">]:</code> <code class="nb">len</code><code class="p">(</code><code class="n">tables</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">74</code><code class="p">]:</code> <code class="mi">1</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">75</code><code class="p">]:</code> <code class="n">failures</code> <code class="o">=</code> <code class="n">tables</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">76</code><code class="p">]:</code> <code class="n">failures</code><code class="o">.</code><code class="n">head</code><code class="p">()</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">76</code><code class="p">]:</code> 
                      <code class="n">Bank</code> <code class="n">Name</code>             <code class="n">City</code>  <code class="n">ST</code>   <code class="n">CERT</code>  \
<code class="mi">0</code>                   <code class="n">Allied</code> <code class="n">Bank</code>         <code class="n">Mulberry</code>  <code class="n">AR</code>     <code class="mi">91</code>   
<code class="mi">1</code>  <code class="n">The</code> <code class="n">Woodbury</code> <code class="n">Banking</code> <code class="n">Company</code>         <code class="n">Woodbury</code>  <code class="n">GA</code>  <code class="mi">11297</code>   
<code class="mi">2</code>        <code class="n">First</code> <code class="n">CornerStone</code> <code class="n">Bank</code>  <code class="n">King</code> <code class="n">of</code> <code class="n">Prussia</code>  <code class="n">PA</code>  <code class="mi">35312</code>   
<code class="mi">3</code>            <code class="n">Trust</code> <code class="n">Company</code> <code class="n">Bank</code>          <code class="n">Memphis</code>  <code class="n">TN</code>   <code class="mi">9956</code>   
<code class="mi">4</code>    <code class="n">North</code> <code class="n">Milwaukee</code> <code class="n">State</code> <code class="n">Bank</code>        <code class="n">Milwaukee</code>  <code class="n">WI</code>  <code class="mi">20364</code>   
                 <code class="n">Acquiring</code> <code class="n">Institution</code>        <code class="n">Closing</code> <code class="n">Date</code>       <code class="n">Updated</code> <code class="n">Date</code>  
<code class="mi">0</code>                         <code class="n">Today</code><code class="s1">'s Bank  September 23, 2016  November 17, 2016  </code>
<code class="mi">1</code>                          <code class="n">United</code> <code class="n">Bank</code>     <code class="n">August</code> <code class="mi">19</code><code class="p">,</code> <code class="mi">2016</code>  <code class="n">November</code> <code class="mi">17</code><code class="p">,</code> <code class="mi">2016</code>  
<code class="mi">2</code>  <code class="n">First</code><code class="o">-</code><code class="n">Citizens</code> <code class="n">Bank</code> <code class="o">&amp;</code> <code class="n">Trust</code> <code class="n">Company</code>         <code class="n">May</code> <code class="mi">6</code><code class="p">,</code> <code class="mi">2016</code>  <code class="n">September</code> <code class="mi">6</code><code class="p">,</code> <code class="mi">2016</code>  
<code class="mi">3</code>           <code class="n">The</code> <code class="n">Bank</code> <code class="n">of</code> <code class="n">Fayette</code> <code class="n">County</code>      <code class="n">April</code> <code class="mi">29</code><code class="p">,</code> <code class="mi">2016</code>  <code class="n">September</code> <code class="mi">6</code><code class="p">,</code> <code class="mi">2016</code>  
<code class="mi">4</code>  <code class="n">First</code><code class="o">-</code><code class="n">Citizens</code> <code class="n">Bank</code> <code class="o">&amp;</code> <code class="n">Trust</code> <code class="n">Company</code>      <code class="n">March</code> <code class="mi">11</code><code class="p">,</code> <code class="mi">2016</code>      <code class="n">June</code> <code class="mi">16</code><code class="p">,</code> <code class="mi">2016</code>  </pre><p>Because <code>failures</code> has many columns, pandas
      inserts a line break character <code>\</code>.</p><p>As you will learn in later chapters, from here we could proceed to
      do some data cleaning and analysis, like computing the number of bank
      failures by year:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">77</code><code class="p">]:</code> <code class="n">close_timestamps</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">to_datetime</code><code class="p">(</code><code class="n">failures</code><code class="p">[</code><code class="s1">'Closing Date'</code><code class="p">])</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">78</code><code class="p">]:</code> <code class="n">close_timestamps</code><code class="o">.</code><code class="n">dt</code><code class="o">.</code><code class="n">year</code><code class="o">.</code><code class="n">value_counts</code><code class="p">()</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">78</code><code class="p">]:</code> 
<code class="mi">2010</code>    <code class="mi">157</code>
<code class="mi">2009</code>    <code class="mi">140</code>
<code class="mi">2011</code>     <code class="mi">92</code>
<code class="mi">2012</code>     <code class="mi">51</code>
<code class="mi">2008</code>     <code class="mi">25</code>
       <code class="o">...</code> 
<code class="mi">2004</code>      <code class="mi">4</code>
<code class="mi">2001</code>      <code class="mi">4</code>
<code class="mi">2007</code>      <code class="mi">3</code>
<code class="mi">2003</code>      <code class="mi">3</code>
<code class="mi">2000</code>      <code class="mi">2</code>
<code class="n">Name</code><code class="p">:</code> <code class="n">Closing</code> <code class="n">Date</code><code class="p">,</code> <code class="n">Length</code><code class="p">:</code> <code class="mi">15</code><code class="p">,</code> <code class="n">dtype</code><code class="p">:</code> <code class="n">int64</code></pre><section data-type="sect3" data-pdf-bookmark="Parsing XML with lxml.objectify"><div class="sect3" id="io_file_formats_xml"><h3>Parsing XML with lxml.objectify</h3><p>XML (eXtensible Markup Language)<a data-type="indexterm" data-primary="objectify function" id="of6.1.5.1"></a> is another common structured data format supporting
        hierarchical, nested data with metadata. The book you are currently
        reading was actually created from a series of large XML documents.</p><p>Earlier, I showed the <code>pandas.read_html</code>
        function, which uses either lxml or Beautiful Soup under the hood to
        parse data from HTML. XML and HTML are structurally similar, but XML
        is more general. Here, I will show an example of how to use lxml to
        parse data from a more general XML format.</p><p>The New York Metropolitan Transportation Authority (MTA)
        publishes <a data-type="indexterm" data-primary="New York MTA (Metropolitan Transportation
            Authority)" id="idm140621943800096"></a>a number of <a href="http://www.mta.info/developers/download.html">data series about
        its bus and train services</a>. Here we’ll look at the performance
        data, which is contained in a set of XML files. Each train or bus
        service has a different file (like
        <em>Performance_MNR.xml</em> for the Metro-North Railroad)
        containing monthly data as a series of XML records that look like
        this:</p><pre data-type="programlisting" data-code-language="xml"><code class="nt">&lt;INDICATOR&gt;</code>
  <code class="nt">&lt;INDICATOR_SEQ&gt;</code>373889<code class="nt">&lt;/INDICATOR_SEQ&gt;</code>
  <code class="nt">&lt;PARENT_SEQ&gt;&lt;/PARENT_SEQ&gt;</code>
  <code class="nt">&lt;AGENCY_NAME&gt;</code>Metro-North Railroad<code class="nt">&lt;/AGENCY_NAME&gt;</code>
  <code class="nt">&lt;INDICATOR_NAME&gt;</code>Escalator Availability<code class="nt">&lt;/INDICATOR_NAME&gt;</code>
  <code class="nt">&lt;DESCRIPTION&gt;</code>Percent of the time that escalators are operational
  systemwide. The availability rate is based on physical observations performed
  the morning of regular business days only. This is a new indicator the agency
  began reporting in 2009.<code class="nt">&lt;/DESCRIPTION&gt;</code>
  <code class="nt">&lt;PERIOD_YEAR&gt;</code>2011<code class="nt">&lt;/PERIOD_YEAR&gt;</code>
  <code class="nt">&lt;PERIOD_MONTH&gt;</code>12<code class="nt">&lt;/PERIOD_MONTH&gt;</code>
  <code class="nt">&lt;CATEGORY&gt;</code>Service Indicators<code class="nt">&lt;/CATEGORY&gt;</code>
  <code class="nt">&lt;FREQUENCY&gt;</code>M<code class="nt">&lt;/FREQUENCY&gt;</code>
  <code class="nt">&lt;DESIRED_CHANGE&gt;</code>U<code class="nt">&lt;/DESIRED_CHANGE&gt;</code>
  <code class="nt">&lt;INDICATOR_UNIT&gt;</code>%<code class="nt">&lt;/INDICATOR_UNIT&gt;</code>
  <code class="nt">&lt;DECIMAL_PLACES&gt;</code>1<code class="nt">&lt;/DECIMAL_PLACES&gt;</code>
  <code class="nt">&lt;YTD_TARGET&gt;</code>97.00<code class="nt">&lt;/YTD_TARGET&gt;</code>
  <code class="nt">&lt;YTD_ACTUAL&gt;&lt;/YTD_ACTUAL&gt;</code>
  <code class="nt">&lt;MONTHLY_TARGET&gt;</code>97.00<code class="nt">&lt;/MONTHLY_TARGET&gt;</code>
  <code class="nt">&lt;MONTHLY_ACTUAL&gt;&lt;/MONTHLY_ACTUAL&gt;</code>
<code class="nt">&lt;/INDICATOR&gt;</code></pre><p>Using <code>lxml.objectify</code>, we
        parse the file and get a reference to the root node of the XML file
        <a data-type="indexterm" data-primary="getroot method" id="idm140621943550576"></a>with <code>getroot</code>:</p><pre data-type="programlisting" data-code-language="python"><code class="kn">from</code> <code class="nn">lxml</code> <code class="kn">import</code> <code class="n">objectify</code>

<code class="n">path</code> <code class="o">=</code> <code class="s1">'datasets/mta_perf/Performance_MNR.xml'</code>
<code class="n">parsed</code> <code class="o">=</code> <code class="n">objectify</code><code class="o">.</code><code class="n">parse</code><code class="p">(</code><code class="nb">open</code><code class="p">(</code><code class="n">path</code><code class="p">))</code>
<code class="n">root</code> <code class="o">=</code> <code class="n">parsed</code><code class="o">.</code><code class="n">getroot</code><code class="p">()</code></pre><p><code>root.INDICATOR</code> returns a
        generator yielding each <code>&lt;INDICATOR&gt;</code> XML element. For each
        record, we can populate a dict of tag names (like <code>YTD_ACTUAL</code>) to data values (excluding a few
        tags):</p><pre data-type="programlisting" data-code-language="python"><code class="n">data</code> <code class="o">=</code> <code class="p">[]</code>

<code class="n">skip_fields</code> <code class="o">=</code> <code class="p">[</code><code class="s1">'PARENT_SEQ'</code><code class="p">,</code> <code class="s1">'INDICATOR_SEQ'</code><code class="p">,</code>
               <code class="s1">'DESIRED_CHANGE'</code><code class="p">,</code> <code class="s1">'DECIMAL_PLACES'</code><code class="p">]</code>

<code class="k">for</code> <code class="n">elt</code> <code class="ow">in</code> <code class="n">root</code><code class="o">.</code><code class="n">INDICATOR</code><code class="p">:</code>
    <code class="n">el_data</code> <code class="o">=</code> <code class="p">{}</code>
    <code class="k">for</code> <code class="n">child</code> <code class="ow">in</code> <code class="n">elt</code><code class="o">.</code><code class="n">getchildren</code><code class="p">():</code>
        <code class="k">if</code> <code class="n">child</code><code class="o">.</code><code class="n">tag</code> <code class="ow">in</code> <code class="n">skip_fields</code><code class="p">:</code>
            <code class="k">continue</code>
        <code class="n">el_data</code><code class="p">[</code><code class="n">child</code><code class="o">.</code><code class="n">tag</code><code class="p">]</code> <code class="o">=</code> <code class="n">child</code><code class="o">.</code><code class="n">pyval</code>
    <code class="n">data</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="n">el_data</code><code class="p">)</code></pre><p>Lastly, convert this list of dicts into a DataFrame:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">81</code><code class="p">]:</code> <code class="n">perf</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">data</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">82</code><code class="p">]:</code> <code class="n">perf</code><code class="o">.</code><code class="n">head</code><code class="p">()</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">82</code><code class="p">]:</code> 
            <code class="n">AGENCY_NAME</code>            <code class="n">CATEGORY</code>  \
<code class="mi">0</code>  <code class="n">Metro</code><code class="o">-</code><code class="n">North</code> <code class="n">Railroad</code>  <code class="n">Service</code> <code class="n">Indicators</code>   
<code class="mi">1</code>  <code class="n">Metro</code><code class="o">-</code><code class="n">North</code> <code class="n">Railroad</code>  <code class="n">Service</code> <code class="n">Indicators</code>   
<code class="mi">2</code>  <code class="n">Metro</code><code class="o">-</code><code class="n">North</code> <code class="n">Railroad</code>  <code class="n">Service</code> <code class="n">Indicators</code>   
<code class="mi">3</code>  <code class="n">Metro</code><code class="o">-</code><code class="n">North</code> <code class="n">Railroad</code>  <code class="n">Service</code> <code class="n">Indicators</code>   
<code class="mi">4</code>  <code class="n">Metro</code><code class="o">-</code><code class="n">North</code> <code class="n">Railroad</code>  <code class="n">Service</code> <code class="n">Indicators</code>   
                                         <code class="n">DESCRIPTION</code> <code class="n">FREQUENCY</code>  \
<code class="mi">0</code>  <code class="n">Percent</code> <code class="n">of</code> <code class="n">commuter</code> <code class="n">trains</code> <code class="n">that</code> <code class="n">arrive</code> <code class="n">at</code> <code class="n">thei</code><code class="o">...</code>         <code class="n">M</code>   
<code class="mi">1</code>  <code class="n">Percent</code> <code class="n">of</code> <code class="n">commuter</code> <code class="n">trains</code> <code class="n">that</code> <code class="n">arrive</code> <code class="n">at</code> <code class="n">thei</code><code class="o">...</code>         <code class="n">M</code>   
<code class="mi">2</code>  <code class="n">Percent</code> <code class="n">of</code> <code class="n">commuter</code> <code class="n">trains</code> <code class="n">that</code> <code class="n">arrive</code> <code class="n">at</code> <code class="n">thei</code><code class="o">...</code>         <code class="n">M</code>   
<code class="mi">3</code>  <code class="n">Percent</code> <code class="n">of</code> <code class="n">commuter</code> <code class="n">trains</code> <code class="n">that</code> <code class="n">arrive</code> <code class="n">at</code> <code class="n">thei</code><code class="o">...</code>         <code class="n">M</code>   
<code class="mi">4</code>  <code class="n">Percent</code> <code class="n">of</code> <code class="n">commuter</code> <code class="n">trains</code> <code class="n">that</code> <code class="n">arrive</code> <code class="n">at</code> <code class="n">thei</code><code class="o">...</code>         <code class="n">M</code>   
                         <code class="n">INDICATOR_NAME</code> <code class="n">INDICATOR_UNIT</code> <code class="n">MONTHLY_ACTUAL</code>  \
<code class="mi">0</code>  <code class="n">On</code><code class="o">-</code><code class="n">Time</code> <code class="n">Performance</code> <code class="p">(</code><code class="n">West</code> <code class="n">of</code> <code class="n">Hudson</code><code class="p">)</code>              <code class="o">%</code>           <code class="mf">96.9</code>   
<code class="mi">1</code>  <code class="n">On</code><code class="o">-</code><code class="n">Time</code> <code class="n">Performance</code> <code class="p">(</code><code class="n">West</code> <code class="n">of</code> <code class="n">Hudson</code><code class="p">)</code>              <code class="o">%</code>             <code class="mi">95</code>   
<code class="mi">2</code>  <code class="n">On</code><code class="o">-</code><code class="n">Time</code> <code class="n">Performance</code> <code class="p">(</code><code class="n">West</code> <code class="n">of</code> <code class="n">Hudson</code><code class="p">)</code>              <code class="o">%</code>           <code class="mf">96.9</code>   
<code class="mi">3</code>  <code class="n">On</code><code class="o">-</code><code class="n">Time</code> <code class="n">Performance</code> <code class="p">(</code><code class="n">West</code> <code class="n">of</code> <code class="n">Hudson</code><code class="p">)</code>              <code class="o">%</code>           <code class="mf">98.3</code>   
<code class="mi">4</code>  <code class="n">On</code><code class="o">-</code><code class="n">Time</code> <code class="n">Performance</code> <code class="p">(</code><code class="n">West</code> <code class="n">of</code> <code class="n">Hudson</code><code class="p">)</code>              <code class="o">%</code>           <code class="mf">95.8</code>   
  <code class="n">MONTHLY_TARGET</code>  <code class="n">PERIOD_MONTH</code>  <code class="n">PERIOD_YEAR</code> <code class="n">YTD_ACTUAL</code> <code class="n">YTD_TARGET</code>  
<code class="mi">0</code>             <code class="mi">95</code>             <code class="mi">1</code>         <code class="mi">2008</code>       <code class="mf">96.9</code>         <code class="mi">95</code>  
<code class="mi">1</code>             <code class="mi">95</code>             <code class="mi">2</code>         <code class="mi">2008</code>         <code class="mi">96</code>         <code class="mi">95</code>  
<code class="mi">2</code>             <code class="mi">95</code>             <code class="mi">3</code>         <code class="mi">2008</code>       <code class="mf">96.3</code>         <code class="mi">95</code>  
<code class="mi">3</code>             <code class="mi">95</code>             <code class="mi">4</code>         <code class="mi">2008</code>       <code class="mf">96.8</code>         <code class="mi">95</code>  
<code class="mi">4</code>             <code class="mi">95</code>             <code class="mi">5</code>         <code class="mi">2008</code>       <code class="mf">96.6</code>         <code class="mi">95</code>  </pre><p>XML data can get much more complicated than this example. Each
        tag can have metadata, too. Consider an HTML link tag, which is also
        valid XML:</p><pre data-type="programlisting" data-code-language="python"><code class="kn">from</code> <code class="nn">io</code> <code class="kn">import</code> <code class="n">StringIO</code>
<code class="n">tag</code> <code class="o">=</code> <code class="s1">'&lt;a href="http://www.google.com"&gt;Google&lt;/a&gt;'</code>
<code class="n">root</code> <code class="o">=</code> <code class="n">objectify</code><code class="o">.</code><code class="n">parse</code><code class="p">(</code><code class="n">StringIO</code><code class="p">(</code><code class="n">tag</code><code class="p">))</code><code class="o">.</code><code class="n">getroot</code><code class="p">()</code></pre><p>You can now access any of the fields (like <code>href</code>) in the tag or the <a data-type="indexterm" data-primary="" data-startref="fm6.1.5" id="idm140621943142096"></a><a data-type="indexterm" data-primary="" data-startref="hf6.1.5" id="idm140621943141088"></a><a data-type="indexterm" data-primary="" data-startref="pl6.1.5" id="idm140621943139984"></a><a data-type="indexterm" data-primary="" data-startref="ws6.1.5" id="idm140621943138880"></a><a data-type="indexterm" data-primary="" data-startref="xf6.1.5" id="idm140621943137776"></a><a data-type="indexterm" data-primary="" data-startref="ll6.1.5" id="idm140621943136672"></a><a data-type="indexterm" data-primary="" data-startref="rf6.1.5" id="idm140621943135568"></a><a data-type="indexterm" data-primary="" data-startref="of6.1.5.1" id="idm140621943134464"></a>link text:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">84</code><code class="p">]:</code> <code class="n">root</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">84</code><code class="p">]:</code> <code class="o">&lt;</code><code class="n">Element</code> <code class="n">a</code> <code class="n">at</code> <code class="mh">0x7fb73962a088</code><code class="o">&gt;</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">85</code><code class="p">]:</code> <code class="n">root</code><code class="o">.</code><code class="n">get</code><code class="p">(</code><code class="s1">'href'</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">85</code><code class="p">]:</code> <code class="s1">'http://www.google.com'</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">86</code><code class="p">]:</code> <code class="n">root</code><code class="o">.</code><code class="n">text</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">86</code><code class="p">]:</code> <code class="s1">'Google'</code></pre></div></section></div></section></div></section><section data-type="sect1" data-pdf-bookmark="6.2 Binary Data Formats"><div class="sect1" id="io_binary"><h1>6.2 Binary Data Formats</h1><p>One of the easiest <a data-type="indexterm" data-primary="file management" data-secondary="binary data formats" id="fm6.2"></a><a data-type="indexterm" data-primary="pandas library" data-secondary="binary data formats" id="pl6.2"></a><a data-type="indexterm" data-primary="binary data formats" data-secondary="about" id="idm140621943088848"></a><a data-type="indexterm" data-primary="storing data" data-secondary="in binary format" id="sd6.2"></a>ways to store data (also known as
    <em>serialization</em>) <a data-type="indexterm" data-primary="serialization" data-see="storing data" id="idm140621943085824"></a>efficiently in binary format is using Python’s built-in
    <code>pickle</code> serialization. <a data-type="indexterm" data-primary="pickle module" id="idm140621943084144"></a>pandas objects all <a data-type="indexterm" data-primary="to_pickle method" id="idm140621943083152"></a>have a <code>to_pickle</code> method
    that writes the data to disk in pickle format:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">87</code><code class="p">]:</code> <code class="n">frame</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'examples/ex1.csv'</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">88</code><code class="p">]:</code> <code class="n">frame</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">88</code><code class="p">]:</code> 
   <code class="n">a</code>   <code class="n">b</code>   <code class="n">c</code>   <code class="n">d</code> <code class="n">message</code>
<code class="mi">0</code>  <code class="mi">1</code>   <code class="mi">2</code>   <code class="mi">3</code>   <code class="mi">4</code>   <code class="n">hello</code>
<code class="mi">1</code>  <code class="mi">5</code>   <code class="mi">6</code>   <code class="mi">7</code>   <code class="mi">8</code>   <code class="n">world</code>
<code class="mi">2</code>  <code class="mi">9</code>  <code class="mi">10</code>  <code class="mi">11</code>  <code class="mi">12</code>     <code class="n">foo</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">89</code><code class="p">]:</code> <code class="n">frame</code><code class="o">.</code><code class="n">to_pickle</code><code class="p">(</code><code class="s1">'examples/frame_pickle'</code><code class="p">)</code></pre><p>You can read any “pickled” object stored in a file by using the
    built-in <code>pickle</code> directly, or even more conveniently
    <a data-type="indexterm" data-primary="read_pickle function" id="idm140621943263840"></a>using <code>pandas.read_pickle</code>:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">90</code><code class="p">]:</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_pickle</code><code class="p">(</code><code class="s1">'examples/frame_pickle'</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">90</code><code class="p">]:</code> 
   <code class="n">a</code>   <code class="n">b</code>   <code class="n">c</code>   <code class="n">d</code> <code class="n">message</code>
<code class="mi">0</code>  <code class="mi">1</code>   <code class="mi">2</code>   <code class="mi">3</code>   <code class="mi">4</code>   <code class="n">hello</code>
<code class="mi">1</code>  <code class="mi">5</code>   <code class="mi">6</code>   <code class="mi">7</code>   <code class="mi">8</code>   <code class="n">world</code>
<code class="mi">2</code>  <code class="mi">9</code>  <code class="mi">10</code>  <code class="mi">11</code>  <code class="mi">12</code>     <code class="n">foo</code></pre><div data-type="caution"><h6>Caution</h6><p><code>pickle</code> is only recommended as a
      short-term storage format. The problem is that it is hard to guarantee
      that the format will be stable over time; an object pickled today may
      not unpickle with a later version of a library. We have tried to
      maintain backward compatibility when possible, but at some point in the
      future it may be necessary to “break” the pickle format.</p></div><p>pandas has built-in support for two more binary data formats: HDF5
    and MessagePack. I will give some HDF5 examples in the next section, but I
    encourage you to explore different file formats to see how fast they are
    and how well they work for your analysis. Some other storage formats for
    pandas or NumPy data include:</p><dl><dt><a href="http://bcolz.blosc.org/"><em>bcolz</em></a></dt><dd><p>A compressable column-oriented <a data-type="indexterm" data-primary="bcolz binary format" id="idm140621942801888"></a>binary format based on the <a data-type="indexterm" data-primary="Blosc compression library" id="idm140621942800928"></a>Blosc compression library.</p></dd><dt><a href="http://github.com/wesm/feather"><em>Feather</em></a></dt><dd><p>A cross-language column-oriented <a data-type="indexterm" data-primary="Feather binary file format" id="idm140621942798784"></a>file format I designed with the R programming
          <a data-type="indexterm" data-primary="Wickham, Hadley" id="idm140621942797760"></a>community’s <a href="http://hadley.nz/">Hadley
          Wickham</a>. Feather uses the <a href="http://arrow.apache.org/">Apache Arrow</a> columnar memory
          format.</p></dd></dl><section data-type="sect2" data-pdf-bookmark="Using HDF5 Format"><div class="sect2" id="io_hdf5"><h2>Using HDF5 Format</h2><p>HDF5 is a well-regarded <a data-type="indexterm" data-primary="binary data formats" data-secondary="HDF5 format" id="bd6.2.1"></a><a data-type="indexterm" data-primary="HDF5 (hierarchical data format 5)" id="hd6.2.1"></a>file format intended for storing large quantities of
      scientific array data. It is available as a C library, and it has
      interfaces available in many other languages, including Java, Julia,
      MATLAB, and Python. The “HDF” in HDF5 stands for <em>hierarchical
      data format</em>. Each HDF5 file can store multiple datasets and
      supporting metadata. Compared with simpler formats, HDF5 supports
      on-the-fly compression with a variety of compression modes, enabling
      data with repeated patterns to be stored more efficiently. HDF5 can be a
      good choice for working with very large datasets that don’t fit into
      memory, as you can efficiently read and write small sections of much
      larger arrays.</p><p>While it’s possible to directly access HDF5 files using either the
      PyTables or h5py libraries, pandas provides a high-level interface that
      simplifies storing Series and DataFrame object. <a data-type="indexterm" data-primary="HDFStore class" id="idm140621942789568"></a>The <code>HDFStore</code> class works like a dict
      and handles the low-level details:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">92</code><code class="p">]:</code> <code class="n">frame</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">({</code><code class="s1">'a'</code><code class="p">:</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">randn</code><code class="p">(</code><code class="mi">100</code><code class="p">)})</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">93</code><code class="p">]:</code> <code class="n">store</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">HDFStore</code><code class="p">(</code><code class="s1">'mydata.h5'</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">94</code><code class="p">]:</code> <code class="n">store</code><code class="p">[</code><code class="s1">'obj1'</code><code class="p">]</code> <code class="o">=</code> <code class="n">frame</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">95</code><code class="p">]:</code> <code class="n">store</code><code class="p">[</code><code class="s1">'obj1_col'</code><code class="p">]</code> <code class="o">=</code> <code class="n">frame</code><code class="p">[</code><code class="s1">'a'</code><code class="p">]</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">96</code><code class="p">]:</code> <code class="n">store</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">96</code><code class="p">]:</code> 
<code class="o">&lt;</code><code class="k">class</code> <code class="err">'</code><code class="nc">pandas</code><code class="o">.</code><code class="n">io</code><code class="o">.</code><code class="n">pytables</code><code class="o">.</code><code class="n">HDFStore</code><code class="s1">'&gt;</code>
<code class="n">File</code> <code class="n">path</code><code class="p">:</code> <code class="n">mydata</code><code class="o">.</code><code class="n">h5</code>
<code class="o">/</code><code class="n">obj1</code>                <code class="n">frame</code>        <code class="p">(</code><code class="n">shape</code><code class="o">-&gt;</code><code class="p">[</code><code class="mi">100</code><code class="p">,</code><code class="mi">1</code><code class="p">])</code>                               
        
<code class="o">/</code><code class="n">obj1_col</code>            <code class="n">series</code>       <code class="p">(</code><code class="n">shape</code><code class="o">-&gt;</code><code class="p">[</code><code class="mi">100</code><code class="p">])</code>                                 
        
<code class="o">/</code><code class="n">obj2</code>                <code class="n">frame_table</code>  <code class="p">(</code><code class="n">typ</code><code class="o">-&gt;</code><code class="n">appendable</code><code class="p">,</code><code class="n">nrows</code><code class="o">-&gt;</code><code class="mi">100</code><code class="p">,</code><code class="n">ncols</code><code class="o">-&gt;</code><code class="mi">1</code><code class="p">,</code><code class="n">indexers</code><code class="o">-&gt;</code>
<code class="p">[</code><code class="n">index</code><code class="p">])</code>
<code class="o">/</code><code class="n">obj3</code>                <code class="n">frame_table</code>  <code class="p">(</code><code class="n">typ</code><code class="o">-&gt;</code><code class="n">appendable</code><code class="p">,</code><code class="n">nrows</code><code class="o">-&gt;</code><code class="mi">100</code><code class="p">,</code><code class="n">ncols</code><code class="o">-&gt;</code><code class="mi">1</code><code class="p">,</code><code class="n">indexers</code><code class="o">-&gt;</code>
<code class="p">[</code><code class="n">index</code><code class="p">])</code></pre><p>Objects contained in the HDF5 file can then be retrieved with the
      same dict-like API:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">97</code><code class="p">]:</code> <code class="n">store</code><code class="p">[</code><code class="s1">'obj1'</code><code class="p">]</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">97</code><code class="p">]:</code> 
           <code class="n">a</code>
<code class="mi">0</code>  <code class="o">-</code><code class="mf">0.204708</code>
<code class="mi">1</code>   <code class="mf">0.478943</code>
<code class="mi">2</code>  <code class="o">-</code><code class="mf">0.519439</code>
<code class="mi">3</code>  <code class="o">-</code><code class="mf">0.555730</code>
<code class="mi">4</code>   <code class="mf">1.965781</code>
<code class="o">..</code>       <code class="o">...</code>
<code class="mi">95</code>  <code class="mf">0.795253</code>
<code class="mi">96</code>  <code class="mf">0.118110</code>
<code class="mi">97</code> <code class="o">-</code><code class="mf">0.748532</code>
<code class="mi">98</code>  <code class="mf">0.584970</code>
<code class="mi">99</code>  <code class="mf">0.152677</code>
<code class="p">[</code><code class="mi">100</code> <code class="n">rows</code> <code class="n">x</code> <code class="mi">1</code> <code class="n">columns</code><code class="p">]</code></pre><p><code>HDFStore</code> supports two storage schemas,
      <code>'fixed'</code> and <code>'table'</code>. The latter is
      generally slower, but it supports query operations using a special
      syntax:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">98</code><code class="p">]:</code> <code class="n">store</code><code class="o">.</code><code class="n">put</code><code class="p">(</code><code class="s1">'obj2'</code><code class="p">,</code> <code class="n">frame</code><code class="p">,</code> <code class="n">format</code><code class="o">=</code><code class="s1">'table'</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">99</code><code class="p">]:</code> <code class="n">store</code><code class="o">.</code><code class="n">select</code><code class="p">(</code><code class="s1">'obj2'</code><code class="p">,</code> <code class="n">where</code><code class="o">=</code><code class="p">[</code><code class="s1">'index &gt;= 10 and index &lt;= 15'</code><code class="p">])</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">99</code><code class="p">]:</code> 
           <code class="n">a</code>
<code class="mi">10</code>  <code class="mf">1.007189</code>
<code class="mi">11</code> <code class="o">-</code><code class="mf">1.296221</code>
<code class="mi">12</code>  <code class="mf">0.274992</code>
<code class="mi">13</code>  <code class="mf">0.228913</code>
<code class="mi">14</code>  <code class="mf">1.352917</code>
<code class="mi">15</code>  <code class="mf">0.886429</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">100</code><code class="p">]:</code> <code class="n">store</code><code class="o">.</code><code class="n">close</code><code class="p">()</code></pre><p>The <code>put</code> is an explicit version of the
      <code>store['obj2'] = frame</code> method but allows us to set
      other options like the storage format.</p><p>The <code>pandas.read_hdf</code> function <a data-type="indexterm" data-primary="read_hdf function" id="idm140621942404720"></a>gives you a shortcut to these tools:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">101</code><code class="p">]:</code> <code class="n">frame</code><code class="o">.</code><code class="n">to_hdf</code><code class="p">(</code><code class="s1">'mydata.h5'</code><code class="p">,</code> <code class="s1">'obj3'</code><code class="p">,</code> <code class="n">format</code><code class="o">=</code><code class="s1">'table'</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">102</code><code class="p">]:</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_hdf</code><code class="p">(</code><code class="s1">'mydata.h5'</code><code class="p">,</code> <code class="s1">'obj3'</code><code class="p">,</code> <code class="n">where</code><code class="o">=</code><code class="p">[</code><code class="s1">'index &lt; 5'</code><code class="p">])</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">102</code><code class="p">]:</code> 
          <code class="n">a</code>
<code class="mi">0</code> <code class="o">-</code><code class="mf">0.204708</code>
<code class="mi">1</code>  <code class="mf">0.478943</code>
<code class="mi">2</code> <code class="o">-</code><code class="mf">0.519439</code>
<code class="mi">3</code> <code class="o">-</code><code class="mf">0.555730</code>
<code class="mi">4</code>  <code class="mf">1.965781</code></pre><div data-type="note" epub:type="note"><h6>Note</h6><p>If you are processing data that is stored on remote servers,
        like Amazon S3 or HDFS, using a different binary format designed for
        distributed storage <a data-type="indexterm" data-primary="Apache Parquet format" id="idm140621942333760"></a>like <a href="http://parquet.apache.org/">Apache
        Parquet</a> may be more suitable. Python for Parquet and other
        such storage formats is still developing, so I do not write about them
        in this book.</p></div><p>If you work with large quantities of data locally, I would
      encourage you to explore PyTables and h5py to see how they can suit your
      needs. Since many data analysis problems are I/O-bound (rather than
      CPU-bound), using a tool like HDF5 can massively accelerate your
      <a data-type="indexterm" data-primary="" data-startref="bd6.2.1" id="idm140621942331504"></a><a data-type="indexterm" data-primary="" data-startref="hd6.2.1" id="idm140621942330432"></a>applications.</p><div data-type="caution"><h6>Caution</h6><p>HDF5 is <em>not</em> a database. It is best suited
        for write-once, read-many datasets. While data can be added to a file
        at any time, if multiple writers do so simultaneously, the file can
        become corrupted.</p></div></div></section><section data-type="sect2" data-pdf-bookmark="Reading Microsoft Excel Files"><div class="sect2" id="pandas_excel_files"><h2>Reading Microsoft Excel Files</h2><p>pandas also supports <a data-type="indexterm" data-primary="binary data formats" data-secondary="Microsoft Excel files" id="bd6.2.2"></a><a data-type="indexterm" data-primary="Microsoft Excel files" id="me6.2.2"></a><a data-type="indexterm" data-primary="Excel files (Microsoft)" id="ef6.2.2"></a><a data-type="indexterm" data-primary="reading data" data-secondary="in Microsoft Excel
          files" id="rd6.2.2"></a>reading tabular data stored in Excel 2003 (and higher)
      files using either <a data-type="indexterm" data-primary="ExcelFile class" id="idm140621942321344"></a>the <code>ExcelFile</code> class or
      <code>pandas.read_excel</code> function. <a data-type="indexterm" data-primary="read_excel function" id="idm140621942319488"></a>Internally these tools use the add-on packages
      <code>xlrd</code> and <code>openpyxl</code> to read
      <a data-type="indexterm" data-primary="xlrd package" id="idm140621942317632"></a><a data-type="indexterm" data-primary="openpyxl package" id="idm140621942316768"></a><a data-type="indexterm" data-primary="XLS files" id="idm140621942315936"></a><a data-type="indexterm" data-primary="XLSX files" id="idm140621942315104"></a>XLS and XLSX files, respectively. You may need to install
      these manually with pip or conda.</p><p>To use <code>ExcelFile</code>, create an
      instance by passing a path to an <code>xls</code>
      or <code>xlsx</code> file:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">104</code><code class="p">]:</code> <code class="n">xlsx</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">ExcelFile</code><code class="p">(</code><code class="s1">'examples/ex1.xlsx'</code><code class="p">)</code></pre><p>Data stored in a sheet can then be read into DataFrame <a data-type="indexterm" data-primary="parse method" id="idm140621942308448"></a>with <code>parse</code>:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">105</code><code class="p">]:</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_excel</code><code class="p">(</code><code class="n">xlsx</code><code class="p">,</code> <code class="s1">'Sheet1'</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">105</code><code class="p">]:</code> 
   <code class="n">a</code>   <code class="n">b</code>   <code class="n">c</code>   <code class="n">d</code> <code class="n">message</code>
<code class="mi">0</code>  <code class="mi">1</code>   <code class="mi">2</code>   <code class="mi">3</code>   <code class="mi">4</code>   <code class="n">hello</code>
<code class="mi">1</code>  <code class="mi">5</code>   <code class="mi">6</code>   <code class="mi">7</code>   <code class="mi">8</code>   <code class="n">world</code>
<code class="mi">2</code>  <code class="mi">9</code>  <code class="mi">10</code>  <code class="mi">11</code>  <code class="mi">12</code>     <code class="n">foo</code></pre><p>If you are reading multiple sheets in a file, then it is faster to
      create the <code>ExcelFile</code>, but you can also simply pass
      the filename to <code>pandas.read_excel</code>:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">106</code><code class="p">]:</code> <code class="n">frame</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_excel</code><code class="p">(</code><code class="s1">'examples/ex1.xlsx'</code><code class="p">,</code> <code class="s1">'Sheet1'</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">107</code><code class="p">]:</code> <code class="n">frame</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">107</code><code class="p">]:</code> 
   <code class="n">a</code>   <code class="n">b</code>   <code class="n">c</code>   <code class="n">d</code> <code class="n">message</code>
<code class="mi">0</code>  <code class="mi">1</code>   <code class="mi">2</code>   <code class="mi">3</code>   <code class="mi">4</code>   <code class="n">hello</code>
<code class="mi">1</code>  <code class="mi">5</code>   <code class="mi">6</code>   <code class="mi">7</code>   <code class="mi">8</code>   <code class="n">world</code>
<code class="mi">2</code>  <code class="mi">9</code>  <code class="mi">10</code>  <code class="mi">11</code>  <code class="mi">12</code>     <code class="n">foo</code></pre><p>To write pandas data to Excel format, you must first create an
      <code>ExcelWriter</code>, then write data to it using
      pandas<a data-type="indexterm" data-primary="to_excel method" id="idm140621942130752"></a> objects’ <code>to_excel</code> method:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">108</code><code class="p">]:</code> <code class="n">writer</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">ExcelWriter</code><code class="p">(</code><code class="s1">'examples/ex2.xlsx'</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">109</code><code class="p">]:</code> <code class="n">frame</code><code class="o">.</code><code class="n">to_excel</code><code class="p">(</code><code class="n">writer</code><code class="p">,</code> <code class="s1">'Sheet1'</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">110</code><code class="p">]:</code> <code class="n">writer</code><code class="o">.</code><code class="n">save</code><code class="p">()</code></pre><p>You can also pass a file path to <code>to_excel</code> and
      avoid <a data-type="indexterm" data-primary="" data-startref="fm6.2" id="idm140621942117456"></a><a data-type="indexterm" data-primary="" data-startref="pl6.2" id="idm140621942116416"></a><a data-type="indexterm" data-primary="" data-startref="bd6.2.2" id="idm140621942103200"></a><a data-type="indexterm" data-primary="" data-startref="ef6.2.2" id="idm140621942102096"></a><a data-type="indexterm" data-primary="" data-startref="me6.2.2" id="idm140621942100992"></a><a data-type="indexterm" data-primary="" data-startref="rd6.2.2" id="idm140621942099888"></a><a data-type="indexterm" data-primary="" data-startref="sd6.2" id="idm140621942098784"></a>the <code>ExcelWriter</code>:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">111</code><code class="p">]:</code> <code class="n">frame</code><code class="o">.</code><code class="n">to_excel</code><code class="p">(</code><code class="s1">'examples/ex2.xlsx'</code><code class="p">)</code></pre></div></section></div></section><section data-type="sect1" data-pdf-bookmark="6.3 Interacting with Web APIs"><div class="sect1" id="io_web_apis"><h1>6.3 Interacting with Web APIs</h1><p>Many websites <a data-type="indexterm" data-primary="pandas library" data-secondary="interacting with Web APIs" id="idm140621942233744"></a><a data-type="indexterm" data-primary="Web APIs, pandas interacting with" id="idm140621942232768"></a><a data-type="indexterm" data-primary="APIs, pandas interacting with" id="idm140621942231968"></a>have public APIs providing data feeds via JSON or some other
    format. There are a number of ways to access these APIs from Python; one
    easy-to-use method that I recommend <a data-type="indexterm" data-primary="requests package" id="idm140621942230848"></a>is the <a href="http://docs.python-requests.org/"><code>requests</code>
    package</a>.</p><p>To find the last 30 GitHub issues for pandas on GitHub, we can
    <a data-type="indexterm" data-primary="GET request (HTTP)" id="idm140621942228624"></a><a data-type="indexterm" data-primary="HTTP requests" id="idm140621942222656"></a>make a <code>GET</code> HTTP request
    using the add-on <code>requests</code> library:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">113</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">requests</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">114</code><code class="p">]:</code> <code class="n">url</code> <code class="o">=</code> <code class="s1">'https://api.github.com/repos/pandas-dev/pandas/issues'</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">115</code><code class="p">]:</code> <code class="n">resp</code> <code class="o">=</code> <code class="n">requests</code><code class="o">.</code><code class="n">get</code><code class="p">(</code><code class="n">url</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">116</code><code class="p">]:</code> <code class="n">resp</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">116</code><code class="p">]:</code> <code class="o">&lt;</code><code class="n">Response</code> <code class="p">[</code><code class="mi">200</code><code class="p">]</code><code class="o">&gt;</code></pre><p>The Response object’s <code>json</code> method
    <a data-type="indexterm" data-primary="json method" id="idm140621942054112"></a>will return a dictionary containing JSON parsed into native
    Python objects:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">117</code><code class="p">]:</code> <code class="n">data</code> <code class="o">=</code> <code class="n">resp</code><code class="o">.</code><code class="n">json</code><code class="p">()</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">118</code><code class="p">]:</code> <code class="n">data</code><code class="p">[</code><code class="mi">0</code><code class="p">][</code><code class="s1">'title'</code><code class="p">]</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">118</code><code class="p">]:</code> <code class="s1">'BUG: rank with +-inf, #6945'</code></pre><p>Each element in <code>data</code> is a
    dictionary containing all of the data found on a GitHub issue page (except
    for the comments). We can pass <code>data</code>
    directly to DataFrame and extract fields of interest:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">119</code><code class="p">]:</code> <code class="n">issues</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">data</code><code class="p">,</code> <code class="n">columns</code><code class="o">=</code><code class="p">[</code><code class="s1">'number'</code><code class="p">,</code> <code class="s1">'title'</code><code class="p">,</code>
   <code class="o">.....</code><code class="p">:</code>                                      <code class="s1">'labels'</code><code class="p">,</code> <code class="s1">'state'</code><code class="p">])</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">120</code><code class="p">]:</code> <code class="n">issues</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">120</code><code class="p">]:</code> 
    <code class="n">number</code>                                              <code class="n">title</code>  \
<code class="mi">0</code>    <code class="mi">17903</code>                        <code class="n">BUG</code><code class="p">:</code> <code class="n">rank</code> <code class="k">with</code> <code class="o">+-</code><code class="n">inf</code><code class="p">,</code> <code class="c1">#6945   </code>
<code class="mi">1</code>    <code class="mi">17902</code>  <code class="n">Revert</code> <code class="s2">"ERR: Raise ValueError when setting sca...   </code>
<code class="mi">2</code>    <code class="mi">17901</code>  <code class="n">Wrong</code> <code class="n">orientation</code> <code class="n">of</code> <code class="n">operations</code> <code class="n">between</code> <code class="n">DataFr</code><code class="o">...</code>   
<code class="mi">3</code>    <code class="mi">17900</code>  <code class="n">added</code> <code class="s1">'infer'</code> <code class="n">option</code> <code class="n">to</code> <code class="n">compression</code> <code class="ow">in</code> <code class="n">_get_ha</code><code class="o">...</code>   
<code class="mi">4</code>    <code class="mi">17898</code>     <code class="n">Last</code> <code class="n">day</code> <code class="n">of</code> <code class="n">month</code> <code class="n">should</code> <code class="n">group</code> <code class="k">with</code> <code class="n">that</code> <code class="n">month</code>   
<code class="o">..</code>     <code class="o">...</code>                                                <code class="o">...</code>   
<code class="mi">25</code>   <code class="mi">17854</code>      <code class="n">Adding</code> <code class="n">an</code> <code class="n">integer</code><code class="o">-</code><code class="n">location</code> <code class="n">based</code> <code class="s2">"get"</code> <code class="n">method</code>   
<code class="mi">26</code>   <code class="mi">17853</code>  <code class="n">BUG</code><code class="p">:</code> <code class="n">adds</code> <code class="n">validation</code> <code class="k">for</code> <code class="n">boolean</code> <code class="n">keywords</code> <code class="ow">in</code> <code class="n">D</code><code class="o">...</code>   
<code class="mi">27</code>   <code class="mi">17851</code>  <code class="n">BUG</code><code class="p">:</code> <code class="n">duplicate</code> <code class="n">indexing</code> <code class="k">with</code> <code class="n">embedded</code> <code class="n">non</code><code class="o">-</code><code class="n">orde</code><code class="o">...</code>   
<code class="mi">28</code>   <code class="mi">17850</code>     <code class="ne">ImportError</code><code class="p">:</code> <code class="n">No</code> <code class="n">module</code> <code class="n">named</code> <code class="s1">'pandas.plotting'</code>   
<code class="mi">29</code>   <code class="mi">17846</code>  <code class="n">BUG</code><code class="p">:</code> <code class="n">Ignore</code> <code class="n">division</code> <code class="n">by</code> <code class="mi">0</code> <code class="n">when</code> <code class="n">merging</code> <code class="n">empty</code> <code class="n">d</code><code class="o">...</code>   
                                               <code class="n">labels</code> <code class="n">state</code>  
<code class="mi">0</code>                                                  <code class="p">[]</code>  <code class="nb">open</code>  
<code class="mi">1</code>   <code class="p">[{</code><code class="s1">'id'</code><code class="p">:</code> <code class="mi">35818298</code><code class="p">,</code> <code class="s1">'url'</code><code class="p">:</code> <code class="s1">'https://api.github.c...  open  </code>
<code class="mi">2</code>                                                  <code class="p">[]</code>  <code class="nb">open</code>  
<code class="mi">3</code>                                                  <code class="p">[]</code>  <code class="nb">open</code>  
<code class="mi">4</code>   <code class="p">[{</code><code class="s1">'id'</code><code class="p">:</code> <code class="mi">76811</code><code class="p">,</code> <code class="s1">'url'</code><code class="p">:</code> <code class="s1">'https://api.github.com/...  open  </code>
<code class="o">..</code>                                                <code class="o">...</code>   <code class="o">...</code>  
<code class="mi">25</code>  <code class="p">[{</code><code class="s1">'id'</code><code class="p">:</code> <code class="mi">35818298</code><code class="p">,</code> <code class="s1">'url'</code><code class="p">:</code> <code class="s1">'https://api.github.c...  open  </code>
<code class="mi">26</code>  <code class="p">[{</code><code class="s1">'id'</code><code class="p">:</code> <code class="mi">42670965</code><code class="p">,</code> <code class="s1">'url'</code><code class="p">:</code> <code class="s1">'https://api.github.c...  open  </code>
<code class="mi">27</code>  <code class="p">[{</code><code class="s1">'id'</code><code class="p">:</code> <code class="mi">76811</code><code class="p">,</code> <code class="s1">'url'</code><code class="p">:</code> <code class="s1">'https://api.github.com/...  open  </code>
<code class="mi">28</code>  <code class="p">[{</code><code class="s1">'id'</code><code class="p">:</code> <code class="mi">31932467</code><code class="p">,</code> <code class="s1">'url'</code><code class="p">:</code> <code class="s1">'https://api.github.c...  open  </code>
<code class="mi">29</code>  <code class="p">[{</code><code class="s1">'id'</code><code class="p">:</code> <code class="mi">76865106</code><code class="p">,</code> <code class="s1">'url'</code><code class="p">:</code> <code class="s1">'https://api.github.c...  open  </code>
<code class="p">[</code><code class="mi">30</code> <code class="n">rows</code> <code class="n">x</code> <code class="mi">4</code> <code class="n">columns</code><code class="p">]</code></pre><p>With a bit of elbow grease, you can create some higher-level
    interfaces to common web APIs that return DataFrame objects for easy
    analysis.</p></div></section><section data-type="sect1" data-pdf-bookmark="6.4 Interacting with Databases"><div class="sect1" id="io_databases"><h1>6.4 Interacting with Databases</h1><p>In a business setting, <a data-type="indexterm" data-primary="pandas library" data-secondary="interacting with databases" id="idm140621941866432"></a><a data-type="indexterm" data-primary="databases" data-secondary="pandas interacting with" id="idm140621941865408"></a>most data may not be stored in text or Excel files.
    SQL-based relational databases (such as SQL Server, PostgreSQL, and MySQL)
    are in wide use, and many alternative databases have become quite popular.
    The choice of database is usually dependent on the performance, data
    integrity, and scalability needs of an application.</p><p>Loading data from SQL into a DataFrame is fairly straightforward,
    and pandas has some functions to simplify the process. As an example, I’ll
    create a SQLite database using Python’s <a data-type="indexterm" data-primary="sqlite3 module" id="idm140621941863360"></a>built-in <code>sqlite3</code>
    driver:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">121</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">sqlite3</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">122</code><code class="p">]:</code> <code class="n">query</code> <code class="o">=</code> <code class="s2">"""</code>
<code class="s2">   .....: CREATE TABLE test</code>
<code class="s2">   .....: (a VARCHAR(20), b VARCHAR(20),</code>
<code class="s2">   .....:  c REAL,        d INTEGER</code>
<code class="s2">   .....: );"""</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">123</code><code class="p">]:</code> <code class="n">con</code> <code class="o">=</code> <code class="n">sqlite3</code><code class="o">.</code><code class="n">connect</code><code class="p">(</code><code class="s1">'mydata.sqlite'</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">124</code><code class="p">]:</code> <code class="n">con</code><code class="o">.</code><code class="n">execute</code><code class="p">(</code><code class="n">query</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">124</code><code class="p">]:</code> <code class="o">&lt;</code><code class="n">sqlite3</code><code class="o">.</code><code class="n">Cursor</code> <code class="n">at</code> <code class="mh">0x7fb7361b4b90</code><code class="o">&gt;</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">125</code><code class="p">]:</code> <code class="n">con</code><code class="o">.</code><code class="n">commit</code><code class="p">()</code></pre><p>Then, insert a few rows of data:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">126</code><code class="p">]:</code> <code class="n">data</code> <code class="o">=</code> <code class="p">[(</code><code class="s1">'Atlanta'</code><code class="p">,</code> <code class="s1">'Georgia'</code><code class="p">,</code> <code class="mf">1.25</code><code class="p">,</code> <code class="mi">6</code><code class="p">),</code>
   <code class="o">.....</code><code class="p">:</code>         <code class="p">(</code><code class="s1">'Tallahassee'</code><code class="p">,</code> <code class="s1">'Florida'</code><code class="p">,</code> <code class="mf">2.6</code><code class="p">,</code> <code class="mi">3</code><code class="p">),</code>
   <code class="o">.....</code><code class="p">:</code>         <code class="p">(</code><code class="s1">'Sacramento'</code><code class="p">,</code> <code class="s1">'California'</code><code class="p">,</code> <code class="mf">1.7</code><code class="p">,</code> <code class="mi">5</code><code class="p">)]</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">127</code><code class="p">]:</code> <code class="n">stmt</code> <code class="o">=</code> <code class="s2">"INSERT INTO test VALUES(?, ?, ?, ?)"</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">128</code><code class="p">]:</code> <code class="n">con</code><code class="o">.</code><code class="n">executemany</code><code class="p">(</code><code class="n">stmt</code><code class="p">,</code> <code class="n">data</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">128</code><code class="p">]:</code> <code class="o">&lt;</code><code class="n">sqlite3</code><code class="o">.</code><code class="n">Cursor</code> <code class="n">at</code> <code class="mh">0x7fb7396d25e0</code><code class="o">&gt;</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">129</code><code class="p">]:</code> <code class="n">con</code><code class="o">.</code><code class="n">commit</code><code class="p">()</code></pre><p>Most Python SQL drivers (PyODBC, psycopg2, MySQLdb, pymssql, etc.)
    return a list of tuples when selecting data from a table:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">130</code><code class="p">]:</code> <code class="n">cursor</code> <code class="o">=</code> <code class="n">con</code><code class="o">.</code><code class="n">execute</code><code class="p">(</code><code class="s1">'select * from test'</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">131</code><code class="p">]:</code> <code class="n">rows</code> <code class="o">=</code> <code class="n">cursor</code><code class="o">.</code><code class="n">fetchall</code><code class="p">()</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">132</code><code class="p">]:</code> <code class="n">rows</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">132</code><code class="p">]:</code> 
<code class="p">[(</code><code class="s1">'Atlanta'</code><code class="p">,</code> <code class="s1">'Georgia'</code><code class="p">,</code> <code class="mf">1.25</code><code class="p">,</code> <code class="mi">6</code><code class="p">),</code>
 <code class="p">(</code><code class="s1">'Tallahassee'</code><code class="p">,</code> <code class="s1">'Florida'</code><code class="p">,</code> <code class="mf">2.6</code><code class="p">,</code> <code class="mi">3</code><code class="p">),</code>
 <code class="p">(</code><code class="s1">'Sacramento'</code><code class="p">,</code> <code class="s1">'California'</code><code class="p">,</code> <code class="mf">1.7</code><code class="p">,</code> <code class="mi">5</code><code class="p">)]</code></pre><p>You can pass the list of tuples to the DataFrame constructor, but
    you also need the column names, contained in the cursor’s <code>description</code> attribute:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">133</code><code class="p">]:</code> <code class="n">cursor</code><code class="o">.</code><code class="n">description</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">133</code><code class="p">]:</code> 
<code class="p">((</code><code class="s1">'a'</code><code class="p">,</code> <code class="bp">None</code><code class="p">,</code> <code class="bp">None</code><code class="p">,</code> <code class="bp">None</code><code class="p">,</code> <code class="bp">None</code><code class="p">,</code> <code class="bp">None</code><code class="p">,</code> <code class="bp">None</code><code class="p">),</code>
 <code class="p">(</code><code class="s1">'b'</code><code class="p">,</code> <code class="bp">None</code><code class="p">,</code> <code class="bp">None</code><code class="p">,</code> <code class="bp">None</code><code class="p">,</code> <code class="bp">None</code><code class="p">,</code> <code class="bp">None</code><code class="p">,</code> <code class="bp">None</code><code class="p">),</code>
 <code class="p">(</code><code class="s1">'c'</code><code class="p">,</code> <code class="bp">None</code><code class="p">,</code> <code class="bp">None</code><code class="p">,</code> <code class="bp">None</code><code class="p">,</code> <code class="bp">None</code><code class="p">,</code> <code class="bp">None</code><code class="p">,</code> <code class="bp">None</code><code class="p">),</code>
 <code class="p">(</code><code class="s1">'d'</code><code class="p">,</code> <code class="bp">None</code><code class="p">,</code> <code class="bp">None</code><code class="p">,</code> <code class="bp">None</code><code class="p">,</code> <code class="bp">None</code><code class="p">,</code> <code class="bp">None</code><code class="p">,</code> <code class="bp">None</code><code class="p">))</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">134</code><code class="p">]:</code> <code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">rows</code><code class="p">,</code> <code class="n">columns</code><code class="o">=</code><code class="p">[</code><code class="n">x</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code> <code class="k">for</code> <code class="n">x</code> <code class="ow">in</code> <code class="n">cursor</code><code class="o">.</code><code class="n">description</code><code class="p">])</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">134</code><code class="p">]:</code> 
             <code class="n">a</code>           <code class="n">b</code>     <code class="n">c</code>  <code class="n">d</code>
<code class="mi">0</code>      <code class="n">Atlanta</code>     <code class="n">Georgia</code>  <code class="mf">1.25</code>  <code class="mi">6</code>
<code class="mi">1</code>  <code class="n">Tallahassee</code>     <code class="n">Florida</code>  <code class="mf">2.60</code>  <code class="mi">3</code>
<code class="mi">2</code>   <code class="n">Sacramento</code>  <code class="n">California</code>  <code class="mf">1.70</code>  <code class="mi">5</code></pre><p>This is quite a bit of munging that you’d rather not repeat each
    time you query the database. The <a href="http://www.sqlalchemy.org/">SQLAlchemy project</a> is a popular
    <a data-type="indexterm" data-primary="SQLAlchemy project" id="idm140621941221136"></a>Python SQL toolkit that abstracts away many of the common
    differences between SQL databases. pandas has a <code>read_sql</code> function <a data-type="indexterm" data-primary="read_sql function" id="idm140621941219760"></a>that enables you to read data easily from a general
    SQLAlchemy connection. Here, we’ll connect to the same SQLite database
    with SQLAlchemy and read data from the table created before:</p><pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">135</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">sqlalchemy</code> <code class="kn">as</code> <code class="nn">sqla</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">136</code><code class="p">]:</code> <code class="n">db</code> <code class="o">=</code> <code class="n">sqla</code><code class="o">.</code><code class="n">create_engine</code><code class="p">(</code><code class="s1">'sqlite:///mydata.sqlite'</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">137</code><code class="p">]:</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_sql</code><code class="p">(</code><code class="s1">'select * from test'</code><code class="p">,</code> <code class="n">db</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">137</code><code class="p">]:</code> 
             <code class="n">a</code>           <code class="n">b</code>     <code class="n">c</code>  <code class="n">d</code>
<code class="mi">0</code>      <code class="n">Atlanta</code>     <code class="n">Georgia</code>  <code class="mf">1.25</code>  <code class="mi">6</code>
<code class="mi">1</code>  <code class="n">Tallahassee</code>     <code class="n">Florida</code>  <code class="mf">2.60</code>  <code class="mi">3</code>
<code class="mi">2</code>   <code class="n">Sacramento</code>  <code class="n">California</code>  <code class="mf">1.70</code>  <code class="mi">5</code></pre></div></section><section data-type="sect1" data-pdf-bookmark="6.5 Conclusion"><div class="sect1" id="io_wrapping_up"><h1>6.5 Conclusion</h1><p>Getting access to data is frequently the first step in the data
    analysis process. We have looked at a number of useful tools in this
    chapter that should help you get started. In the upcoming chapters we
    will dig deeper into data wrangling, data visualization, time series
    analysis, and other topics.</p></div></section><div data-type="footnotes"><p data-type="footnote" id="idm140621944082912"><sup><a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#idm140621944082912-marker" class="totri-footnote">1</a></sup> For the full list, see <a href="https://www.fdic.gov/bank/individual/failed/banklist.html"><em class="hyperlink">https://www.fdic.gov/bank/individual/failed/banklist.html</em></a>.</p></div></div></section><div class="annotator-outer annotator-viewer viewer annotator-hide">
  <ul class="annotator-widget annotator-listing"></ul>
</div><div class="annotator-modal-wrapper annotator-editor-modal annotator-editor annotator-hide">
	<div class="annotator-outer editor">
		<h2 class="title">Highlight</h2>
		<form class="annotator-widget">
			<ul class="annotator-listing">
			<li class="annotator-item"><textarea id="annotator-field-0" placeholder="Add a note using markdown (optional)" class="js-editor" maxlength="750"></textarea></li></ul>
			<div class="annotator-controls">
				<a class="link-to-markdown" href="https://daringfireball.net/projects/markdown/basics" target="_blank">?</a>
				<ul>
					<li class="delete annotator-hide"><a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#delete" class="annotator-delete-note button positive">Delete Note</a></li>
					<li class="save"><a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#save" class="annotator-save annotator-focus button positive">Save Note</a></li>
					<li class="cancel"><a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#cancel" class="annotator-cancel button">Cancel</a></li>
				</ul>
			</div>
		</form>
	</div>
</div><div class="annotator-modal-wrapper annotator-delete-confirm-modal" style="display: none;">
  <div class="annotator-outer">
    <h2 class="title">Highlight</h2>
      <a class="js-close-delete-confirm annotator-cancel close" href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#close">Close</a>
      <div class="annotator-widget">
         <div class="delete-confirm">
            Are you sure you want to permanently delete this note?
         </div>
         <div class="annotator-controls">
            <a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#cancel" class="annotator-cancel button js-cancel-delete-confirm">No, I changed my mind</a>
            <a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#delete" class="annotator-delete button positive js-delete-confirm">Yes, delete it</a>
         </div>
       </div>
   </div>
</div><div class="annotator-adder" style="display: none; top: 25248.3px; left: 197.25px; width: 259px;">
	<ul class="adders expandUp">
		
		<li class="copy"><a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#">Copy</a></li>
		
		<li class="add-highlight"><a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#">Add Highlight</a></li>
		<li class="add-note"><a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#">
			Add Note
		</a></li>
		
	</ul>
</div></div></div>



  <div class="t-sbo-prev sbo-prev sbo-nav-bottom">
  
    
      
        <a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch05.html" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">Getting Started with pandas</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-bottom">
  
    
      
        <a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch07.html" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">Data Cleaning and Preparation</div>
        </a>
    
  
  </div>


        
    </section>
  </div>
<section class="sbo-saved-archives"></section>



          
          
  




    
    



        
      </div>
      




  <footer class="pagefoot">
    <a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#" class="icon-up"><div class="visuallyhidden">Back to top</div></a>
    <ul class="js-footer-nav">
      <li class="full-support"><a href="https://www.oreilly.com/online-learning/support/">Support</a></li>
      <li><a href="https://www.oreilly.com/online-learning/apps.html">Get the App</a></li>
      
        <li><a href="https://learning.oreilly.com/accounts/logout/">Sign Out</a></li>
      
    </ul>
    <span class="copyright">© 2019 <a href="https://learning.oreilly.com/" target="_blank">Safari</a>.</span>
    <a href="https://learning.oreilly.com/terms/">Terms of Service</a> /
    <a href="https://learning.oreilly.com/membership-agreement/">Membership Agreement</a> /
    <a href="https://www.oreilly.com/privacy.html">Privacy Policy</a>
  </footer>

<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"agent":"","errorBeacon":"bam.nr-data.net","licenseKey":"510f1a6865","queueTime":0,"beacon":"bam.nr-data.net","transactionName":"YgdaZ0NSW0cEB0RdWltNfkZfUEFdCgofXFBHDVYdR1pQQxZeRl1QQj1aWkU=","applicationID":"3275661,67267027,67267028","applicationTime":215}</script>


    
    <script src="./ep_files/saved_resource" charset="utf-8"></script>
    <script src="./ep_files/saved_resource(1)" charset="utf-8"></script>
  

<div class="annotator-notice"></div><div class="font-flyout" style="top: 135.03px; left: 409px;"><div class="font-controls-panel">
	<div class="nightmodes">
		<ul>
			<li class="day"><a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#" id="day-mode" title="Day Mode">
				<i class="fa fa-sun-o"></i>
				<span>Day Mode</span></a></li>
			<li class="cloudy"><a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#" id="cloudy-mode" title="Cloudy Mode">
				<i class="fa fa-cloud"></i>
				<span>Cloud Mode</span>
			</a></li>
			<li class="night"><a href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#" id="night-mode" title="Night Mode">
				<i class="fa fa-moon-o"></i>
				<span>Night Mode</span>
			</a></li>
		</ul>
	</div>

	<div class="font-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-font left"></i>
			<span class="filler" style="width: 48.0263%;"></span>
			<div id="js-font-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; top: 0px; left: 73px;"></div>
			<i class="fa fa-font right"></i>
		</div>
	</div>

	<div class="column-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-compress left"></i>
			<span class="filler" style="width: 88%;"></span>
			<div id="js-column-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; top: 0px; left: 133.76px;"></div>
			<i class="fa fa-expand right"></i>
		</div>
	</div>

	<a id="reset" class="button" href="https://learning.oreilly.com/library/view/python-for-data/9781491957653/ch06.html#">Reset</a>
</div>
</div><iframe id="blockbyte-bs-sidebar" class="notranslate" data-pos="right" src="./ep_files/saved_resource.html"></iframe><div id="blockbyte-bs-indicator" class="blockbyte-bs-fullHeight" style="width: 20px; height: 100%; top: 0%;"></div><script type="text/javascript" async="" src="./ep_files/1fa16f6ccbee745a0c.js"></script></body></html>